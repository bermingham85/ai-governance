{
  "data": [
    {
      "updatedAt": "2025-11-11T17:29:09Z",
      "createdAt": "2025-11-01T14:40:22.992Z",
      "id": "0ZAEFAnRbEHkgdwH",
      "name": "My workflow 10",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Manual Trigger",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {},
          "id": "8bb6e23d-5534-4cd8-a8cf-30f1ace7e5aa"
        },
        {
          "name": "Get All Historical Transactions",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            220,
            0
          ],
          "parameters": {
            "operation": "getAll",
            "tableId": "historical_transactions"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "a4c188b1-c62c-43a2-86a0-9380909cc5f3"
        },
        {
          "name": "Rule Extraction Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            440,
            0
          ],
          "parameters": {
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"agents\": {\n    \"rule_extraction_agent\": {\n      \"name\": \"Rule Extraction Agent\",\n      \"type\": \"n8n-nodes-base.httpRequest\",\n      \"json_body\": {\n        \"model\": \"claude-3-5-sonnet-20241022\",\n        \"max_tokens\": 800,\n        \"temperature\": 0.3,\n        \"messages\": [\n          {\n            \"role\": \"user\",\n            \"content\": \"You are the Rule Extraction Agent. Analyze transaction data to generate classification rules.\\n\\nTRANSACTION DATA: {{ $json }}\\n\\nEXTRACT PATTERNS FOR:\\n- Merchant name patterns\\n- Amount ranges by category\\n- Description keywords\\n- Category mappings\\n- VAT rates\\n\\nOUTPUT FORMAT:\\n{\\n  \\\"rules\\\": [\\n    {\\n      \\\"rule_id\\\": \\\"R001\\\",\\n      \\\"type\\\": \\\"merchant_exact\\\",\\n      \\\"condition\\\": \\\"Amazon\\\",\\n      \\\"category\\\": \\\"Office expenses\\\",\\n      \\\"vat_rate\\\": \\\"23%\\\",\\n      \\\"confidence\\\": 0.95\\n    }\\n  ]\\n}\\n\\nReturn only valid JSON.\"\n          }\n        ]\n      },\n      \"headers\": [\n        {\"name\": \"Content-Type\", \"value\": \"application/json\"},\n        {\"name\": \"anthropic-version\", \"value\": \"2023-06-01\"}\n      ]\n    },\n",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "5249dd4b-bc34-4eaf-9f81-19d8128bb402"
        },
        {
          "name": "Format Rules for Storage",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            660,
            0
          ],
          "parameters": {
            "jsCode": "// Extract the rules from the Anthropic response\nconst response = $input.all();\nconst anthropicResponse = response[0].json;\nconst rulesContent = anthropicResponse.content[0].text;\n\n// Parse the JSON rules\nconst rulesData = JSON.parse(rulesContent);\n\n// Format each rule for Supabase insertion\nconst formattedRules = rulesData.rules.map(rule => ({\n  json: {\n    rule_id: rule.rule_id,\n    rule_type: rule.type,\n    condition_value: rule.condition,\n    target_category: rule.classification.category,\n    target_vat_rate: rule.classification.vat_rate,\n    confidence_threshold: rule.classification.confidence,\n    created_at: new Date().toISOString()\n  }\n}));\n\nreturn formattedRules;"
          },
          "id": "90786a18-de7c-4658-bb76-0e881c34a040"
        },
        {
          "name": "Save Rules to Database",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            880,
            0
          ],
          "parameters": {
            "tableId": "extracted_rules"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "c31bce62-7987-4c70-929e-e6c88b5f9c7a"
        }
      ],
      "connections": {
        "Manual Trigger": {
          "main": [
            [
              {
                "node": "Get All Historical Transactions",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get All Historical Transactions": {
          "main": [
            [
              {
                "node": "Rule Extraction Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Rule Extraction Agent": {
          "main": [
            [
              {
                "node": "Format Rules for Storage",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Rules for Storage": {
          "main": [
            [
              {
                "node": "Save Rules to Database",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "2ca7c81b-186b-4888-8d25-fcf84784f3fd",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:22.995Z",
          "createdAt": "2025-11-01T14:40:22.995Z",
          "role": "workflow:owner",
          "workflowId": "0ZAEFAnRbEHkgdwH",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:45Z",
      "createdAt": "2025-11-01T14:36:15.19Z",
      "id": "13CqzKDhn4P5FNKL",
      "name": "E-commerce Order Processing Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {},
          "id": "start-node",
          "name": "Start",
          "type": "n8n-nodes-base.start",
          "typeVersion": 1,
          "position": [
            240,
            300
          ]
        },
        {
          "parameters": {
            "resource": "order",
            "operation": "getAll",
            "returnAll": true,
            "options": {
              "status": "any"
            }
          },
          "id": "shopify-orders",
          "name": "Get Shopify Orders",
          "type": "n8n-nodes-base.shopify",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "credentials": {
            "shopifyApi": {
              "id": "shopify-credentials",
              "name": "Shopify API"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.financial_status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-paid-orders",
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            680,
            300
          ]
        },
        {
          "parameters": {
            "resource": "spreadsheet",
            "operation": "appendRow",
            "documentId": {
              "__rl": true,
              "value": "your-google-sheet-id",
              "mode": "list",
              "cachedResultName": "Order Tracking Sheet"
            },
            "sheetName": {
              "__rl": true,
              "value": "Sheet1",
              "mode": "list",
              "cachedResultName": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Order ID": "={{ $json.order_number }}",
                "Customer Email": "={{ $json.email }}",
                "Total Amount": "={{ $json.total_price }}",
                "Status": "={{ $json.financial_status }}",
                "Date": "={{ $json.created_at }}"
              }
            }
          },
          "id": "add-to-sheets",
          "name": "Add to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4,
          "position": [
            900,
            240
          ],
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "google-sheets-credentials",
              "name": "Google Sheets OAuth2"
            }
          }
        },
        {
          "parameters": {
            "resource": "lead",
            "operation": "create",
            "additionalFields": {
              "firstName": "={{ $json.billing_address.first_name }}",
              "lastName": "={{ $json.billing_address.last_name }}",
              "email": "={{ $json.email }}",
              "company": "={{ $json.billing_address.company }}",
              "phone": "={{ $json.billing_address.phone }}"
            }
          },
          "id": "create-salesforce-lead",
          "name": "Create Salesforce Lead",
          "type": "n8n-nodes-base.salesforce",
          "typeVersion": 1,
          "position": [
            900,
            360
          ],
          "credentials": {
            "salesforceOAuth2Api": {
              "id": "salesforce-credentials",
              "name": "Salesforce OAuth2"
            }
          }
        },
        {
          "parameters": {
            "fromEmail": "orders@yourcompany.com",
            "toEmail": "={{ $json.email }}",
            "subject": "Order Confirmation - {{ $json.order_number }}",
            "message": "Thank you for your order! Your order #{{ $json.order_number }} for ${{ $json.total_price }} has been processed successfully.",
            "options": {}
          },
          "id": "send-confirmation-email",
          "name": "Send Confirmation Email",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 1,
          "position": [
            1120,
            300
          ],
          "credentials": {
            "gmailOAuth2": {
              "id": "gmail-credentials",
              "name": "Gmail OAuth2"
            }
          }
        }
      ],
      "connections": {
        "Start": {
          "main": [
            [
              {
                "node": "Get Shopify Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Shopify Orders": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Add to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Salesforce Lead",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add to Google Sheets": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Salesforce Lead": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "fafea3c6-22f6-4e02-b086-4685a5d529d9",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:15.192Z",
          "createdAt": "2025-11-01T14:36:15.192Z",
          "role": "workflow:owner",
          "workflowId": "13CqzKDhn4P5FNKL",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:55Z",
      "createdAt": "2025-11-01T14:36:15.8Z",
      "id": "1DaC1Rxj8ZmHgfAf",
      "name": "E-commerce Test Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "webhook-test",
            "options": {}
          },
          "id": "webhook-trigger",
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "webhookId": "test-webhook"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-paid-orders",
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"order_id\": $json.order_id, \"customer_email\": $json.customer_email, \"amount\": $json.amount, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "log-to-sheets",
          "name": "Log Order (Sheets Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            240
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"lead_data\": { \"name\": $json.customer_name, \"email\": $json.customer_email, \"source\": \"ecommerce_order\" }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "create-lead",
          "name": "Create Lead (Salesforce Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            360
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"email_data\": { \"to\": $json.customer_email, \"subject\": \"Order Confirmation\", \"body\": \"Thank you for your order #\" + $json.order_id }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "send-email",
          "name": "Send Email (Gmail Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ]
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Log Order (Sheets Simulation)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Lead (Salesforce Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Log Order (Sheets Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Lead (Salesforce Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "11925ffe-fea0-46fb-95b8-cadf9bec7f58",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:15.803Z",
          "createdAt": "2025-11-01T14:36:15.803Z",
          "role": "workflow:owner",
          "workflowId": "1DaC1Rxj8ZmHgfAf",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:36:14.569Z",
      "createdAt": "2025-11-01T14:36:14.569Z",
      "id": "2WljmLQpjhuGfB4s",
      "name": "Midjourney Automation Receiver",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-automation",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "webhook-1",
          "name": "Webhook - Midjourney Data",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "webhookId": "midjourney-automation"
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "article_title",
                  "value": "={{ $json.article.title }}"
                },
                {
                  "name": "article_url",
                  "value": "={{ $json.article.url }}"
                },
                {
                  "name": "social_content",
                  "value": "={{ $json.socialPost.content }}"
                },
                {
                  "name": "image_url",
                  "value": "={{ $json.midjourney.imageUrl }}"
                },
                {
                  "name": "prompt",
                  "value": "={{ $json.midjourney.prompt }}"
                },
                {
                  "name": "timestamp",
                  "value": "={{ $json.timestamp }}"
                }
              ]
            },
            "options": {}
          },
          "id": "set-1",
          "name": "Extract Data",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            450,
            300
          ]
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.midjourney.status }}",
                  "operation": "equals",
                  "value2": "completed"
                }
              ]
            }
          },
          "id": "if-1",
          "name": "Check Status",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            650,
            300
          ]
        },
        {
          "parameters": {
            "resource": "sheet",
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": "YOUR_GOOGLE_SHEET_ID"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Timestamp": "={{ $json.timestamp }}",
                "Article Title": "={{ $json.article_title }}",
                "Article URL": "={{ $json.article_url }}",
                "Social Content": "={{ $json.social_content }}",
                "Midjourney Prompt": "={{ $json.prompt }}",
                "Image URL": "={{ $json.image_url }}"
              }
            },
            "options": {}
          },
          "id": "google-sheets-1",
          "name": "Save to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 3,
          "position": [
            850,
            200
          ]
        },
        {
          "parameters": {
            "fromEmail": "michael@rentasling.ie",
            "toEmail": "your-email@example.com",
            "subject": "New Midjourney Image Generated",
            "emailType": "html",
            "message": "=<h2>New Content Generated</h2><p><strong>Article:</strong> {{ $json.article_title }}</p><p><strong>Social Post:</strong><br>{{ $json.social_content }}</p><p><strong>Midjourney Prompt:</strong><br>{{ $json.prompt }}</p><p><strong>Image:</strong><br><img src=\"{{ $json.image_url }}\" style=\"max-width:600px;\"></p><hr><p><a href=\"{{ $json.article_url }}\">View Original Article</a></p>",
            "options": {}
          },
          "id": "email-1",
          "name": "Send Email Notification",
          "type": "n8n-nodes-base.emailSend",
          "typeVersion": 2,
          "position": [
            850,
            400
          ]
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ { \"success\": true, \"message\": \"Data received and processed\", \"timestamp\": $json.timestamp } }}",
            "options": {}
          },
          "id": "respond-1",
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ]
        }
      ],
      "connections": {
        "Webhook - Midjourney Data": {
          "main": [
            [
              {
                "node": "Extract Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Data": {
          "main": [
            [
              {
                "node": "Check Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Status": {
          "main": [
            [
              {
                "node": "Save to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Send Email Notification",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Google Sheets": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Email Notification": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "5ceaa132-2108-405f-98ad-97eaf748d9d6",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:14.574Z",
          "createdAt": "2025-11-01T14:36:14.574Z",
          "role": "workflow:owner",
          "workflowId": "2WljmLQpjhuGfB4s",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-11T18:17:22Z",
      "createdAt": "2025-11-01T14:40:20.153Z",
      "id": "3sFUBYJz0vT3BV16",
      "name": "Extract Invoice Data from Google Drive to Sheets with Mistral OCR and Gemini",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "When clicking ‘Test workflow’",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            380,
            240
          ],
          "parameters": {},
          "id": "0ed252ac-bd9d-441a-9f3b-d305f8367dcf"
        },
        {
          "name": "On new file in Google Drive",
          "type": "n8n-nodes-base.googleDriveTrigger",
          "typeVersion": 1,
          "position": [
            380,
            580
          ],
          "parameters": {
            "pollTimes": {
              "item": [
                {}
              ]
            },
            "triggerOn": "specificFolder",
            "folderToWatch": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "event": "fileCreated",
            "options": {}
          },
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "cISWm5eOll9FnV3g",
              "name": "Google Drive account"
            }
          },
          "id": "7ffbf81e-b1c4-4958-9e57-7d4c8293201d"
        },
        {
          "name": "Load files from Google Drive folder",
          "type": "n8n-nodes-base.googleDrive",
          "typeVersion": 3,
          "position": [
            1160,
            580
          ],
          "parameters": {
            "resource": "fileFolder",
            "queryString": "Receipts and invoices and bills UP",
            "returnAll": true,
            "filter": {
              "folderId": {
                "__rl": true,
                "mode": "list",
                "value": "15Xpvr0Q4cBwYv1e_jNI8JO4LKAQmgYC2",
                "cachedResultUrl": "https://drive.google.com/drive/folders/15Xpvr0Q4cBwYv1e_jNI8JO4LKAQmgYC2",
                "cachedResultName": "Invoices_Inbox"
              }
            },
            "options": {}
          },
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "cISWm5eOll9FnV3g",
              "name": "Google Drive account"
            }
          },
          "executeOnce": true,
          "id": "579ec369-9553-4936-b3bb-fa8a82cff18e"
        },
        {
          "name": "Filter processed files",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 3,
          "position": [
            1640,
            460
          ],
          "parameters": {
            "mode": "combine",
            "fieldsToMatchString": "id",
            "joinMode": "keepNonMatches",
            "outputDataFrom": "input2",
            "options": {}
          },
          "id": "21f0bdc4-3dcd-42f1-808e-c3a12611c8f9"
        },
        {
          "name": "Download file for OCR",
          "type": "n8n-nodes-base.googleDrive",
          "typeVersion": 3,
          "position": [
            1840,
            460
          ],
          "parameters": {
            "operation": "download",
            "fileId": {
              "__rl": true,
              "mode": "id",
              "value": "={{ $json.id }}"
            },
            "options": {}
          },
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "cISWm5eOll9FnV3g",
              "name": "Google Drive account"
            }
          },
          "id": "d7726e00-049d-4be9-b3a7-310e78a3745f"
        },
        {
          "name": "Get already processed rows from Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4.3,
          "position": [
            1440,
            240
          ],
          "parameters": {
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": "1WNXkB6SpJyGtPVcHmj1oaaDFikyACCuq6RY5rEPH4OQ",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WNXkB6SpJyGtPVcHmj1oaaDFikyACCuq6RY5rEPH4OQ/edit?usp=drivesdk",
              "cachedResultName": "n8n_ocr_invoices"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": "gid=0",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WNXkB6SpJyGtPVcHmj1oaaDFikyACCuq6RY5rEPH4OQ/edit#gid=0",
              "cachedResultName": "Sheet1"
            },
            "options": {}
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "executeOnce": true,
          "alwaysOutputData": true,
          "id": "29f72630-a419-40bd-91c1-22c46fca3d90"
        },
        {
          "name": "Mistral Upload",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2340,
            440
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.mistral.ai/v1/files",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendBody": true,
            "contentType": "multipart-form-data",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "purpose",
                  "value": "ocr"
                },
                {
                  "parameterType": "formBinaryData",
                  "name": "file",
                  "inputDataFieldName": "data"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "5d1d42e9-15a7-4f73-9cdf-7e2dcad5fd3b"
        },
        {
          "name": "Mistral Signed URL",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2540,
            440
          ],
          "parameters": {
            "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "expiry",
                  "value": "24"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Accept",
                  "value": "application/json"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "0afa7868-9e67-4882-a8b4-60a88d63f3f9"
        },
        {
          "name": "Mistral DOC OCR",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2740,
            420
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.mistral.ai/v1/ocr",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "28a3fce2-96fd-41be-89ec-550a9ebb6e04"
        },
        {
          "name": "extract schema",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1200,
            240
          ],
          "parameters": {
            "jsCode": "// Grab the keys from the first row\nconst schema = Object.keys($input.all()[0].json);\n\n// Return a single item whose JSON is just that schema array\nreturn [\n  { json: { schema } }\n];"
          },
          "id": "b5ecd3d3-becb-4cb9-86c7-50714958738b"
        },
        {
          "name": "Join OCR Pages and remove id field",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            3120,
            420
          ],
          "parameters": {
            "jsCode": "// Node name: Join Pages\n// 1. Grab all incoming documents\nconst docs = $input.all();\n\n// 2. Pull in your schema once and filter it\nlet schema = $('extract schema').first().json.schema;\nconst toRemove = ['Id', 'row_number'];\nschema = schema.filter(f => !toRemove.includes(f));\n\n// 3. Build one output per document\nconst results = docs.map(doc => {\n  // join only that doc’s pages\n  const fullText = doc.json.pages\n    .map(p => p.markdown)\n    .join('\\n\\n');\n\n  return {\n    json: {\n      ocr_text: fullText,\n      schema,\n    },\n  };\n});\n\nreturn results;"
          },
          "id": "3a1b6e60-c4d5-4662-b031-021a0959aa15"
        },
        {
          "name": "Add google drive Id back",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            3660,
            380
          ],
          "parameters": {
            "jsCode": "// 1. Get the array of processed files (with id & name)\nconst processed = $('Filter processed files').all();\n\n// 2. Take each LLM output in turn, parse it, inject the matching ID, and return\nreturn $input.all().map((item, index) => {\n  // parse the JSON string your chat node returned\n  const data = JSON.parse(item.json.output);\n\n  // look up the corresponding Drive file ID by array index\n  data.Id   = processed[index]?.json.id ?? null;\n\n\n  // emit for your Sheets node\n  return { json: data };\n});"
          },
          "id": "cdb666a3-52bf-4945-b29d-ffa833e95ffc"
        },
        {
          "name": "Google Gemini Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            3340,
            600
          ],
          "parameters": {
            "modelName": "models/gemini-2.5-flash-preview-05-20",
            "options": {}
          },
          "credentials": {
            "googlePalmApi": {
              "id": "sjrvHN6nPlH928JC",
              "name": "Google Gemini(PaLM) Api account"
            }
          },
          "id": "6607eead-c4f2-4215-8d96-b1e8f5dd0de6"
        },
        {
          "name": "Mistral Upload1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2360,
            660
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.mistral.ai/v1/files",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendBody": true,
            "contentType": "multipart-form-data",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "purpose",
                  "value": "ocr"
                },
                {
                  "parameterType": "formBinaryData",
                  "name": "file",
                  "inputDataFieldName": "data"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "aaa6a8ae-984f-4420-9b3c-bf779fdba1b0"
        },
        {
          "name": "Mistral Signed URL1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2540,
            660
          ],
          "parameters": {
            "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "expiry",
                  "value": "24"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Accept",
                  "value": "application/json"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "e2be10c6-0b88-41f9-80ea-15c31aacfa93"
        },
        {
          "name": "Mistral IMAGE OCR",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            2740,
            640
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.mistral.ai/v1/ocr",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "mistralCloudApi",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"image_url\",\n    \"image_url\": \"{{ $json.url }}\"\n  }\n}",
            "options": {}
          },
          "credentials": {
            "mistralCloudApi": {
              "id": "CoYP7Lk6dFWkCcBV",
              "name": "Mistral Cloud account"
            }
          },
          "id": "270ef169-66c2-4640-adfb-30fe9f4fde1d"
        },
        {
          "name": "If",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            2060,
            460
          ],
          "parameters": {
            "conditions": {
              "options": {
                "version": 2,
                "leftValue": "",
                "caseSensitive": true,
                "typeValidation": "strict"
              },
              "combinator": "and",
              "conditions": [
                {
                  "id": "54e4c552-cdf0-4707-8723-65bcf41d8a96",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  },
                  "leftValue": "={{$binary.data.mimeType}}",
                  "rightValue": "image/"
                }
              ]
            },
            "options": {}
          },
          "id": "a4c5f767-00c7-42e6-9a43-da90af20c6fa"
        },
        {
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            880,
            780
          ],
          "parameters": {
            "content": "### Modify Folder source",
            "height": 80,
            "width": 220,
            "color": 4
          },
          "id": "4eeeef09-40df-4558-9718-3fc85480bedb"
        },
        {
          "name": "Sticky Note1",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            3620,
            580
          ],
          "parameters": {
            "content": "### File Ids\nYou can view the files using Id from the first column. replace the <Id> below\nhttps://drive.google.com/file/d/<Id>/view",
            "height": 100,
            "width": 320
          },
          "id": "8318b3be-5343-4dde-89ae-3f05e57a2b92"
        },
        {
          "name": "Field Extractor",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.8,
          "position": [
            3300,
            380
          ],
          "parameters": {
            "promptType": "define",
            "text": "=Extract the following fields from the invoice text:\n\n{{ JSON.stringify($json.schema) }}\n\nImportant: Double-check that all line items are extracted without omission.\n\n- You must respond ONLY with valid raw rendered JSON.\n- Do NOT include the word \"json\".\n- Do NOT include the word \"```json\".\n- Do NOT use triple backticks or markdown formatting.\n- Do NOT wrap the response in any key like \"output\".\n- Do NOT write anything starting at output directly start with valid root-level JSON.\n- Only respond with a valid, root-level JSON object.\n\nText to extract data from: {{ $json.ocr_text }}",
            "options": {
              "systemMessage": "=You are a document parsing assistant designed to extract structured data from invoice PDFs for automated uploading and validation in a financial system."
            }
          },
          "id": "fa4a15db-70ec-4d81-88c2-a2387a74f694"
        },
        {
          "name": "Sticky Note2",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            320,
            800
          ],
          "parameters": {
            "content": "### Set interval for checking drive folder and pull new files",
            "height": 80,
            "width": 220,
            "color": 4
          },
          "id": "267b9caf-f341-4a07-bb9b-dacb7de805ea"
        },
        {
          "name": "Sticky Note3",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            640,
            -60
          ],
          "parameters": {
            "content": "### Select Sheet\n  \nAdd column headers in the sheet to which you save data on row one to specify which fields you are interested in extracting. ",
            "height": 140,
            "width": 300,
            "color": 4
          },
          "id": "af49c136-3142-4099-941c-95bf359e2438"
        },
        {
          "name": "Sticky Note4",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1180,
            140
          ],
          "parameters": {
            "content": "### Select sheet",
            "height": 80,
            "width": 200,
            "color": 4
          },
          "id": "dc7af5c4-e648-43be-a0e5-30836f8c2d3e"
        },
        {
          "name": "Sticky Note5",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            3660,
            280
          ],
          "parameters": {
            "content": "### Select sheet to save data (same as at the start)",
            "height": 80,
            "width": 200,
            "color": 4
          },
          "id": "3a951993-0c1f-47c1-a852-67db2760bc5f"
        },
        {
          "name": "Sticky Note6",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            640,
            100
          ],
          "parameters": {
            "content": ">> ### First column header in cell A1 MUST BE \"Id\". Id tracks the google drive Id and ensures the workflow is not processing previously processed files",
            "height": 120,
            "width": 300,
            "color": 3
          },
          "id": "c60048e3-89b0-4dee-bb4f-c5d9fbad28ec"
        },
        {
          "name": "Sticky Note7",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1600,
            360
          ],
          "parameters": {
            "content": "Uses drive ID - no need to modify",
            "height": 80,
            "width": 160,
            "color": 2
          },
          "id": "d55a9ac4-1325-41a1-a583-890ffa933cee"
        },
        {
          "name": "Sticky Note8",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            2100,
            300
          ],
          "parameters": {
            "content": "Requires Mistral API Key for La Platforme\nhttps://mistral.ai/products/la-plateforme",
            "height": 80,
            "width": 520,
            "color": 2
          },
          "id": "a954e95a-8be5-4df6-a00e-72406b652831"
        },
        {
          "name": "Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4.5,
          "position": [
            3880,
            380
          ],
          "parameters": {
            "operation": "update",
            "documentId": {
              "__rl": true,
              "value": "1UuPiumtZA2EYJ_mocFPHB8WYpQuvrmcZaKFZhP8NjX0",
              "mode": "list",
              "cachedResultName": "Receipts captured by wellybox",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1UuPiumtZA2EYJ_mocFPHB8WYpQuvrmcZaKFZhP8NjX0/edit?usp=drivesdk"
            },
            "sheetName": {
              "__rl": true,
              "value": 122241125,
              "mode": "list",
              "cachedResultName": "Sheet1",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1UuPiumtZA2EYJ_mocFPHB8WYpQuvrmcZaKFZhP8NjX0/edit#gid=122241125"
            },
            "columns": {
              "mappingMode": "autoMapInputData",
              "value": {},
              "matchingColumns": [],
              "schema": [
                {
                  "id": "Received Date",
                  "displayName": "Received Date",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Document Date",
                  "displayName": "Document Date",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Vendor",
                  "displayName": "Vendor",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Vendor Number",
                  "displayName": "Vendor Number",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Total Amount",
                  "displayName": "Total Amount",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Total Tax",
                  "displayName": "Total Tax",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Document Type",
                  "displayName": "Document Type",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Currency",
                  "displayName": "Currency",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Expense Category",
                  "displayName": "Expense Category",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Business",
                  "displayName": "Business",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Doc Number",
                  "displayName": "Doc Number",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source",
                  "displayName": "Source",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Has Star",
                  "displayName": "Has Star",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Link",
                  "displayName": "Link",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Path in ZIP",
                  "displayName": "Path in ZIP",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Comment",
                  "displayName": "Comment",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Status",
                  "displayName": "Status",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Client Email",
                  "displayName": "Client Email",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source Sender",
                  "displayName": "Source Sender",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Content",
                  "displayName": "Content",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Allocation Number",
                  "displayName": "Allocation Number",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Doc UUID",
                  "displayName": "Doc UUID",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source Foreign ID",
                  "displayName": "Source Foreign ID",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source Thread ID",
                  "displayName": "Source Thread ID",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source Foreign ID",
                  "displayName": "Source Foreign ID",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "Source Thread ID",
                  "displayName": "Source Thread ID",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true
                },
                {
                  "id": "row_number",
                  "displayName": "row_number",
                  "required": false,
                  "defaultMatch": false,
                  "display": true,
                  "type": "string",
                  "canBeUsedToMatch": true,
                  "readOnly": true,
                  "removed": true
                }
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "id": "3dda5cce-5b24-41cd-add0-51aff9ad6609"
        },
        {
          "name": "Google Sheets1",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4.5,
          "position": [
            600,
            240
          ],
          "parameters": {
            "documentId": {
              "__rl": true,
              "value": "1r4t4IgUsWC7s6qro28kZOWdocGRxTURq5W7DYN7LaIg",
              "mode": "list",
              "cachedResultName": "Copy of Receipts captured by wellybox",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1r4t4IgUsWC7s6qro28kZOWdocGRxTURq5W7DYN7LaIg/edit?usp=drivesdk"
            },
            "sheetName": {
              "__rl": true,
              "value": 122241125,
              "mode": "list",
              "cachedResultName": "Sheet1",
              "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1r4t4IgUsWC7s6qro28kZOWdocGRxTURq5W7DYN7LaIg/edit#gid=122241125"
            },
            "options": {}
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "id": "5a9bca5b-0851-4040-a4de-0e8d0880cbcd"
        }
      ],
      "connections": {
        "If": {
          "main": [
            [
              {
                "node": "Mistral Upload1",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Mistral Upload",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral Upload": {
          "main": [
            [
              {
                "node": "Mistral Signed URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "extract schema": {
          "main": [
            [
              {
                "node": "Get already processed rows from Sheets",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Field Extractor": {
          "main": [
            [
              {
                "node": "Add google drive Id back",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral DOC OCR": {
          "main": [
            [
              {
                "node": "Join OCR Pages and remove id field",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral Upload1": {
          "main": [
            [
              {
                "node": "Mistral Signed URL1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral IMAGE OCR": {
          "main": [
            [
              {
                "node": "Join OCR Pages and remove id field",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral Signed URL": {
          "main": [
            [
              {
                "node": "Mistral DOC OCR",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Mistral Signed URL1": {
          "main": [
            [
              {
                "node": "Mistral IMAGE OCR",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download file for OCR": {
          "main": [
            [
              {
                "node": "If",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter processed files": {
          "main": [
            [
              {
                "node": "Download file for OCR",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add google drive Id back": {
          "main": [
            [
              {
                "node": "Google Sheets",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Field Extractor",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "On new file in Google Drive": {
          "main": [
            [
              {
                "node": "Load files from Google Drive folder",
                "type": "main",
                "index": 0
              },
              {
                "node": "extract schema",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "When clicking ‘Test workflow’": {
          "main": [
            [
              {
                "node": "Load files from Google Drive folder",
                "type": "main",
                "index": 0
              },
              {
                "node": "Google Sheets1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Join OCR Pages and remove id field": {
          "main": [
            [
              {
                "node": "Field Extractor",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Load files from Google Drive folder": {
          "main": [
            [
              {
                "node": "Filter processed files",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Get already processed rows from Sheets": {
          "main": [
            [
              {
                "node": "Filter processed files",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets1": {
          "main": [
            [
              {
                "node": "extract schema",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "4ef48244-2ebb-4e64-a522-bd7d0a4a0eaf",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:20.155Z",
          "createdAt": "2025-11-01T14:40:20.155Z",
          "role": "workflow:owner",
          "workflowId": "3sFUBYJz0vT3BV16",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:30Z",
      "createdAt": "2025-11-01T14:40:18.836Z",
      "id": "6QiqcpYIqavQDCaD",
      "name": "My workflow 7",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Trigger",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -860,
            -80
          ],
          "parameters": {
            "rule": {
              "interval": [
                {}
              ]
            }
          },
          "id": "1e8e6145-41c0-4c55-a134-b99c0761f101"
        },
        {
          "name": "Get New Products",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            -640,
            -80
          ],
          "parameters": {
            "resource": "database",
            "databaseId": {
              "__rl": true,
              "value": "1c374ec0-3114-808f-8e4b-cfbadfd69718",
              "mode": "list",
              "cachedResultName": "balding_pig_product_cycle_auto",
              "cachedResultUrl": "https://www.notion.so/1c374ec03114808f8e4bcfbadfd69718"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "84e2d11a-7878-41a6-b6b4-bb22c29d98ff"
        },
        {
          "name": "Process Each Product",
          "type": "n8n-nodes-base.splitInBatches",
          "typeVersion": 2,
          "position": [
            -420,
            -80
          ],
          "parameters": {
            "batchSize": 1,
            "options": {}
          },
          "id": "5bce515b-7e64-4679-88ae-4e9b382f9919"
        },
        {
          "name": "Extract Product Data",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -200,
            -80
          ],
          "parameters": {
            "functionCode": "// Extract product data and format it for processing\nconst product = $input.item.json;\nconst productData = {};\n\n// Extract properties from Notion format\ntry {\n  // Handle different property types\n  Object.keys(product.properties).forEach(key => {\n    const prop = product.properties[key];\n    \n    if (prop.type === 'title' && prop.title.length > 0) {\n      productData.product_name = prop.title[0].plain_text;\n    }\n    else if (prop.type === 'rich_text' && prop.rich_text.length > 0) {\n      productData[key] = prop.rich_text[0].plain_text;\n    }\n    else if (prop.type === 'select' && prop.select) {\n      productData[key] = prop.select.name;\n    }\n    else if (prop.type === 'multi_select' && prop.multi_select) {\n      productData[key] = prop.multi_select.map(item => item.name);\n    }\n    else if (prop.type === 'number' && prop.number !== null) {\n      productData[key] = prop.number;\n    }\n  });\n} catch (error) {\n  // Provide fallback if property extraction fails\n  console.log('Error extracting properties:', error);\n  productData.error = error.message;\n}\n\n// Add a unique ID for tracking\nproductData.id = product.id;\n\n// Add an AI prompt for image generation\nproductData.ai_prompt = `${productData.product_name} - ${productData.description}`;\n\nreturn [{ json: productData }];"
          },
          "id": "98ad9e28-d496-4e95-8883-926d4a4d7e05"
        },
        {
          "name": "Generate Social Media Content",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            20,
            -280
          ],
          "parameters": {
            "prompt": "Create social media posts for a product from our baldness-themed brand \"The Balding Pig\". Create one post each for LinkedIn, Instagram, TikTok and Facebook. Each post should be appropriate for the platform, have the right tone and length, and include relevant hashtags.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nTarget Demographics: {{ $json.target_demographics }}\n\nOur brand voice is confident, slightly humorous, and empowering for people experiencing hair loss. We celebrate baldness as a sign of confidence and character rather than something to be ashamed of.\n\nFormat each post clearly with the platform name as a header.",
            "options": {
              "maxTokens": 1000,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "5fb80397-29b6-4e41-a571-af5e0e494dcd"
        },
        {
          "name": "Generate Product Description",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            20,
            -80
          ],
          "parameters": {
            "prompt": "Create a detailed product description for an e-commerce website selling baldness-themed products. This is for our brand \"The Balding Pig\" which celebrates baldness with humor, confidence, and style.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nColors Available: {{ $json.colours }}\nTarget Demographics: {{ $json.target_demographics }}\n\nThe product description should include:\n1. An attention-grabbing headline (max 60 characters)\n2. A 150-200 word main description that emphasizes benefits and features\n3. 3-5 bullet points highlighting key selling points\n4. A short closing statement with a call-to-action\n\nWrite in HTML format with appropriate tags for headings, paragraphs, and bullet points. The tone should be confident, slightly humorous, and empowering for people experiencing hair loss.",
            "options": {
              "maxTokens": 800,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "4be772c5-8a45-485a-a032-12e74af75851"
        },
        {
          "name": "Midjourney Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -860,
            1500
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-product-image",
            "options": {}
          },
          "id": "77092dde-2977-456f-a6df-73e4c5eb8aa2"
        },
        {
          "name": "Discord Imagine",
          "type": "n8n-nodes-base.discord",
          "typeVersion": 2,
          "position": [
            20,
            120
          ],
          "parameters": {
            "authentication": "webhook",
            "content": "=/imagine prompt: {{ $json.ai_prompt }}, high quality product photography, white background, professional lighting, 8K resolution, advertising style",
            "options": {}
          },
          "credentials": {
            "discordWebhookApi": {
              "id": "FxfT1FfYCFxyIXxj",
              "name": "Discord Webhook account"
            }
          },
          "id": "c02918b2-5309-4e99-9ff6-f2e501f57995"
        },
        {
          "name": "Parse Midjourney Response",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -640,
            1500
          ],
          "parameters": {
            "functionCode": "// Parse the Midjourney response to extract necessary data\nconst responseData = $input.item.json;\n\n// Default values in case extraction fails\nlet result = {\n  message_id: '',\n  hash: '',\n  index: 1, // Default to first image\n  content: ''\n};\n\ntry {\n  // Extract message ID\n  if (responseData.id) {\n    result.message_id = responseData.id;\n  }\n  \n  // Extract content for debugging\n  if (responseData.content) {\n    result.content = responseData.content;\n  }\n  \n  // Try to extract hash from components or attachments\n  if (responseData.components && \n      responseData.components.length > 0 && \n      responseData.components[0].components) {\n    \n    // Look for upscale button which contains the hash\n    const components = responseData.components[0].components;\n    for (const component of components) {\n      if (component.custom_id && component.custom_id.includes('::upsample::')) {\n        // Extract hash from custom_id format: MJ::JOB::upsample::1::HASH\n        const parts = component.custom_id.split('::')\n        if (parts.length >= 5) {\n          result.hash = parts[4];\n          break;\n        }\n      }\n    }\n  }\n  \n  // Fallback: try to find hash in other locations if not found above\n  if (!result.hash && responseData.attachments && responseData.attachments.length > 0) {\n    // Sometimes hash might be in the filename or proxy_url\n    const attachment = responseData.attachments[0];\n    if (attachment.filename) {\n      const match = attachment.filename.match(/([a-zA-Z0-9]{8,})/); \n      if (match) result.hash = match[1];\n    }\n  }\n  \n  // If we still don't have a hash but have an ID, we'll use the ID as a fallback\n  if (!result.hash && result.message_id) {\n    result.hash = result.message_id;\n  }\n\n} catch (error) {\n  // Log the error but continue with what we have\n  console.log('Error parsing Midjourney response:', error);\n}\n\nreturn [{ json: result }];"
          },
          "id": "8a236ddb-4d7a-4d8c-9f87-3557b421e95b"
        },
        {
          "name": "Upscale Selected Image",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -420,
            1500
          ],
          "parameters": {
            "method": "POST",
            "url": "https://discord.com/api/v10/interactions",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "httpBearerAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"midjourney\",\n  \"task_type\": \"upscale\",\n  \"input\": {\n    \"task_id\": \"{{ $json.message_id }}\",\n    \"index\": 1\n  },\n  \"webhook_url\": \"{{ $json.content }}\",\n  \"webhook_type\": \"post\"\n}",
            "options": {}
          },
          "credentials": {
            "discordBotApi": {
              "id": "L68NZYxxLnyL9Y6V",
              "name": "Discord Bot account 2"
            },
            "httpBearerAuth": {
              "id": "m8HPo1GS4nCh2fGp",
              "name": "Bearer Auth account 2"
            }
          },
          "id": "8b02fc7c-eb6a-43cd-acb4-733eee5aac60"
        },
        {
          "name": "Upscale Result Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -860,
            2220
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-upscale-result",
            "options": {}
          },
          "id": "618f3cf2-672d-4f29-839b-d1d7e802d1d7"
        },
        {
          "name": "Process Upscale Result",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -640,
            2220
          ],
          "parameters": {
            "functionCode": "// Process the upscale result\nconst responseData = $input.item.json;\n\n// Default response structure\nlet result = {\n  success: false,\n  image_url: '',\n  error: ''\n};\n\ntry {\n  // Check if we have attachments with the upscaled image\n  if (responseData.attachments && responseData.attachments.length > 0) {\n    // Get the first attachment (should be the upscaled image)\n    const attachment = responseData.attachments[0];\n    \n    if (attachment.url) {\n      result.image_url = attachment.url;\n      result.success = true;\n    } else if (attachment.proxy_url) {\n      result.image_url = attachment.proxy_url;\n      result.success = true;\n    }\n  }\n  \n  // If no image URL was found but there's a content field with a URL\n  if (!result.image_url && responseData.content) {\n    // Try to extract URL from content using regex\n    const urlMatch = responseData.content.match(/https?:\\/\\/[^\\s]+/g);\n    if (urlMatch && urlMatch.length > 0) {\n      result.image_url = urlMatch[0];\n      result.success = true;\n    }\n  }\n  \n  // Still no image URL, check if there's an embeds field with an image\n  if (!result.image_url && responseData.embeds && responseData.embeds.length > 0) {\n    const embed = responseData.embeds[0];\n    if (embed.image && embed.image.url) {\n      result.image_url = embed.image.url;\n      result.success = true;\n    }\n  }\n  \n  // If we still don't have an image URL, set an error\n  if (!result.image_url) {\n    result.error = 'Could not find upscaled image URL in response';\n  }\n  \n} catch (error) {\n  result.error = `Error processing upscale result: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "34e9c304-6c3f-4673-b654-88d809541299"
        },
        {
          "name": "Store Image in Cloudinary",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -200,
            2220
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/upload",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file",
                  "value": "={{ $json.image_url }}"
                },
                {
                  "name": "upload_preset",
                  "value": "balding_pig_products"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "BzmOPFRykhF1E4i0",
              "name": "Header Auth account 2"
            }
          },
          "id": "3159a062-563c-4281-acb6-8305dfa2d70f"
        },
        {
          "name": "Update Product in Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            240,
            2220
          ],
          "parameters": {
            "operation": "updatePage"
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "0a2b1e5b-cf81-4cea-a3bb-fb0865a64d72"
        },
        {
          "name": "Save Product Image URL",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            20,
            2220
          ],
          "parameters": {
            "functionCode": "// Store product ID with image URL\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    secure_url: $json.secure_url\n  }\n}];"
          },
          "id": "ef8eb903-9cac-431b-b797-6080bbd0d6eb"
        },
        {
          "name": "Save Social Content",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            240,
            -280
          ],
          "parameters": {
            "functionCode": "// Save social media content for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    social_content: $node[\"Generate Social Media Content\"].json.text\n  }\n}];"
          },
          "id": "2e537667-a39b-427f-863b-7cf4a1e5e2a3"
        },
        {
          "name": "Save Product Description",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            240,
            -80
          ],
          "parameters": {
            "functionCode": "// Save product description for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    product_description: $node[\"Generate Product Description\"].json.text\n  }\n}];"
          },
          "id": "faceb1fa-ddac-450c-a06c-655aaa9992a3"
        },
        {
          "name": "Generate MJ Image",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            20,
            580
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.goapi.ai/api/v1/task",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpBearerAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"midjourney\",\n  \"task_type\": \"imagine\",\n  \"input\": {\n    \"prompt\": \"{{ $json.ai_prompt }}, high quality product photography, white background, professional lighting, 8K resolution, advertising style\"\n  },\n  \"webhook_url\": \"{{ $workflow.staticData.webhookUrl }}\",\n  \"webhook_type\": \"post\"\n}",
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "BzmOPFRykhF1E4i0",
              "name": "Header Auth account 2"
            },
            "httpBearerAuth": {
              "id": "97vA0AovMfVGI7Qy",
              "name": "Bearer Auth account"
            }
          },
          "retryOnFail": true,
          "id": "0918c62d-882a-4624-8d90-644c0574fbc0"
        },
        {
          "name": "MJ Response Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -860,
            2480
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-webhook",
            "options": {}
          },
          "id": "f0bc820c-8541-4cc1-8372-fa5705c240d9"
        },
        {
          "name": "Process MJ Response",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -640,
            2480
          ],
          "parameters": {
            "functionCode": "// Extract task ID and other relevant info\nconst responseData = $input.item.json;\n\n// Default response structure\nlet result = {\n  success: false,\n  task_id: '',\n  status: '',\n  image_urls: [],\n  error: ''\n};\n\ntry {\n  // Extract task ID\n  if (responseData.task_id) {\n    result.task_id = responseData.task_id;\n    result.success = true;\n  } else if (responseData.id) {\n    result.task_id = responseData.id;\n    result.success = true;\n  }\n  \n  // Extract status\n  if (responseData.status) {\n    result.status = responseData.status;\n  }\n  \n  // Extract image URLs if available\n  if (responseData.image_urls && Array.isArray(responseData.image_urls) && responseData.image_urls.length > 0) {\n    result.image_urls = responseData.image_urls;\n  } else if (responseData.images && Array.isArray(responseData.images) && responseData.images.length > 0) {\n    result.image_urls = responseData.images;\n  }\n  \n  // Extract errors if present\n  if (responseData.error) {\n    result.error = responseData.error;\n  }\n  \n  // Store the original product ID for later reference\n  result.product_id = $node[\"Extract Product Data\"].json.id;\n  \n} catch (error) {\n  console.log('Error processing Midjourney response:', error);\n  result.error = error.message;\n}\n\nreturn [{ json: result }];"
          },
          "id": "fab623ee-cb5c-4c5e-b3f8-ab781d9d2d4d"
        },
        {
          "name": "Upscale MJ Image",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -420,
            2480
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.midjourney.com/api/v1/upscale",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "task_id",
                  "value": "={{ $json.task_id }}"
                },
                {
                  "name": "position",
                  "value": "1"
                },
                {
                  "name": "webhook_url",
                  "value": "={{ $workflow.staticData.upscaleWebhookUrl }}"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "2LjDTJRbDDGRsRXI",
              "name": "Header Auth account"
            }
          },
          "id": "955799bc-af24-4ef2-9111-503ad413b2f1"
        },
        {
          "name": "MJ Upscale Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -860,
            2840
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-upscale-result",
            "options": {}
          },
          "id": "7e3f4692-38f9-413b-b838-41f6b8c4678b"
        },
        {
          "name": "Is Upscale Successful?",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            -420,
            2840
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.success }}",
                  "value2": "true"
                }
              ]
            }
          },
          "id": "0074c25c-4393-4fe2-8cba-92f430f6b042"
        },
        {
          "name": "Send Error Email",
          "type": "n8n-nodes-base.emailSend",
          "typeVersion": 1,
          "position": [
            -200,
            2940
          ],
          "parameters": {
            "subject": "Error in Midjourney Image Generation",
            "html": "=<p>There was an error in the Midjourney image generation process for product: <strong>{{ $node[\"Extract Product Data1\"].json.product_name }}</strong></p>\n<p>Error details: {{ $json.error }}</p>\n<p>Please check the workflow and try again.</p>",
            "options": {}
          },
          "id": "ac74063f-3b2a-4572-931d-f71a8f4cedb3"
        },
        {
          "name": "Workflow Notes",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            660,
            -360
          ],
          "parameters": {
            "content": "This workflow demonstrates how to use the Midjourney GO API to generate and upscale product images for a baldness-themed brand called \"The Balding Pig\".\n\n## Before Running\n\n1. Replace `YOUR_CLOUD_NAME` in the \"Store Image in Cloudinary\" node with your actual Cloudinary cloud name.\n\n2. Create a Header Auth credential named \"Midjourney GO API Key\" with your API key.\n\n3. Make sure your Notion database is properly configured with fields like product_name, description, tagline, etc.\n\n4. Once you run the workflow for the first time, you'll get webhook URLs. Copy the URLs and update the workflow's static data with these URLs (see instructions in comments).\n\n## Process Flow\n\n1. Gets products from Notion database\n2. Processes each product one by one\n3. Extracts product data\n4. Generates social media content and product descriptions\n5. Sends product info to Midjourney GO API\n6. Receives generated image grid through webhook\n7. Processes the response and extracts task ID\n8. Upscales the first image (position 1)\n9. Receives upscaled image through webhook\n10. Processes the result and gets the image URL\n11. Stores the image in Cloudinary\n12. Updates the product in Notion with the image URL\n\n## Setup Webhook URLs\n\nAfter the first run:\n1. Go to the \"MJ Response Webhook\" node and copy the webhook URL\n2. Go to the \"MJ Upscale Webhook\" node and copy the webhook URL\n3. Update the workflow static data with these URLs:\n\n```\n{\n  \"webhookUrl\": \"YOUR_MJ_RESPONSE_WEBHOOK_URL\",\n  \"upscaleWebhookUrl\": \"YOUR_MJ_UPSCALE_WEBHOOK_URL\"\n}\n```",
            "height": 420,
            "width": 632
          },
          "id": "f1bf2df9-17f4-40f7-8cd3-406fb3e6eb43"
        },
        {
          "name": "Schedule Trigger1",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -860,
            480
          ],
          "parameters": {
            "rule": {
              "interval": [
                {}
              ]
            }
          },
          "id": "deacb11c-76dc-4e73-89d3-42a8a7d7b490"
        },
        {
          "name": "Get New Products1",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            -640,
            480
          ],
          "parameters": {
            "resource": "database",
            "databaseId": {
              "__rl": true,
              "value": "1c374ec0-3114-808f-8e4b-cfbadfd69718",
              "mode": "list",
              "cachedResultName": "balding_pig_product_cycle_auto",
              "cachedResultUrl": "https://www.notion.so/1c374ec03114808f8e4bcfbadfd69718"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "b660e1b3-09f0-4e09-9fdc-969dda682290"
        },
        {
          "name": "Process Each Product1",
          "type": "n8n-nodes-base.splitInBatches",
          "typeVersion": 2,
          "position": [
            -420,
            480
          ],
          "parameters": {
            "batchSize": 1,
            "options": {}
          },
          "id": "8d21172b-d92c-4f29-a8bf-b0e178ccbd10"
        },
        {
          "name": "Extract Product Data1",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -200,
            480
          ],
          "parameters": {
            "functionCode": "// Extract product data and format it for processing\nconst product = $input.item.json;\nconst productData = {};\n\n// Extract properties from Notion format\ntry {\n  // Handle different property types\n  Object.keys(product.properties).forEach(key => {\n    const prop = product.properties[key];\n    \n    if (prop.type === 'title' && prop.title.length > 0) {\n      productData.product_name = prop.title[0].plain_text;\n    }\n    else if (prop.type === 'rich_text' && prop.rich_text.length > 0) {\n      productData[key] = prop.rich_text[0].plain_text;\n    }\n    else if (prop.type === 'select' && prop.select) {\n      productData[key] = prop.select.name;\n    }\n    else if (prop.type === 'multi_select' && prop.multi_select) {\n      productData[key] = prop.multi_select.map(item => item.name);\n    }\n    else if (prop.type === 'number' && prop.number !== null) {\n      productData[key] = prop.number;\n    }\n  });\n} catch (error) {\n  // Provide fallback if property extraction fails\n  console.log('Error extracting properties:', error);\n  productData.error = error.message;\n}\n\n// Add a unique ID for tracking\nproductData.id = product.id;\n\n// Add an AI prompt for image generation\nif (productData.product_name && productData.description) {\n  productData.ai_prompt = `${productData.product_name} - ${productData.description}`;\n} else if (productData.product_name) {\n  productData.ai_prompt = productData.product_name;\n} else {\n  productData.ai_prompt = \"Balding Pig branded product, professional product photography\";\n}\n\nreturn [{ json: productData }];"
          },
          "id": "813b5458-26d2-473d-9e0f-d7ad754d3675"
        },
        {
          "name": "Generate Social Media Content1",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            460,
            380
          ],
          "parameters": {
            "prompt": "Create social media posts for a product from our baldness-themed brand \"The Balding Pig\". Create one post each for LinkedIn, Instagram, TikTok and Facebook. Each post should be appropriate for the platform, have the right tone and length, and include relevant hashtags.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nTarget Demographics: {{ $json.target_demographics }}\n\nOur brand voice is confident, slightly humorous, and empowering for people experiencing hair loss. We celebrate baldness as a sign of confidence and character rather than something to be ashamed of.\n\nFormat each post clearly with the platform name as a header.",
            "options": {
              "maxTokens": 1000,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "9be83570-2267-4b94-8b8c-8cbecd3cc05b"
        },
        {
          "name": "Generate Product Description1",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            20,
            380
          ],
          "parameters": {
            "prompt": "Create a detailed product description for an e-commerce website selling baldness-themed products. This is for our brand \"The Balding Pig\" which celebrates baldness with humor, confidence, and style.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nColors Available: {{ $json.colours }}\nTarget Demographics: {{ $json.target_demographics }}\n\nThe product description should include:\n1. An attention-grabbing headline (max 60 characters)\n2. A 150-200 word main description that emphasizes benefits and features\n3. 3-5 bullet points highlighting key selling points\n4. A short closing statement with a call-to-action\n\nWrite in HTML format with appropriate tags for headings, paragraphs, and bullet points. The tone should be confident, slightly humorous, and empowering for people experiencing hair loss.",
            "options": {
              "maxTokens": 800,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "7476c0a9-80c6-46b8-bfcf-7a1cef82f5be"
        },
        {
          "name": "Process Upscale Result1",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -640,
            2840
          ],
          "parameters": {
            "functionCode": "// Process the upscale result\nconst responseData = $input.item.json;\n\n// Default response structure\nlet result = {\n  success: false,\n  image_url: '',\n  task_id: '',\n  status: '',\n  error: ''\n};\n\ntry {\n  // Extract task ID\n  if (responseData.task_id) {\n    result.task_id = responseData.task_id;\n  } else if (responseData.id) {\n    result.task_id = responseData.id;\n  }\n  \n  // Extract status\n  if (responseData.status) {\n    result.status = responseData.status;\n  }\n  \n  // Extract the image URL\n  if (responseData.image_url) {\n    result.image_url = responseData.image_url;\n    result.success = true;\n  } else if (responseData.image_urls && Array.isArray(responseData.image_urls) && responseData.image_urls.length > 0) {\n    result.image_url = responseData.image_urls[0];\n    result.success = true;\n  } else if (responseData.images && Array.isArray(responseData.images) && responseData.images.length > 0) {\n    result.image_url = responseData.images[0];\n    result.success = true;\n  }\n  \n  // Extract error if present\n  if (responseData.error) {\n    result.error = responseData.error;\n  }\n  \n  // If we still don't have an image URL, check if there's a custom URL structure\n  if (!result.image_url && responseData.urls && responseData.urls.upscaled) {\n    result.image_url = responseData.urls.upscaled;\n    result.success = true;\n  }\n  \n  // Try to retrieve the product ID from earlier nodes\n  try {\n    result.product_id = $node[\"Process MJ Response\"].json.product_id;\n  } catch (e) {\n    // If we can't get it from there, try to get from Extract Product Data\n    try {\n      result.product_id = $node[\"Extract Product Data\"].json.id;\n    } catch (e2) {\n      console.log('Could not retrieve product ID');\n    }\n  }\n  \n} catch (error) {\n  result.error = `Error processing upscale result: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "73a8e93c-2fa7-44bc-98a5-172ffb0a3dff"
        },
        {
          "name": "Store Image in Cloudinary1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -200,
            2740
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/upload",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file",
                  "value": "={{ $json.image_url }}"
                },
                {
                  "name": "upload_preset",
                  "value": "balding_pig_products"
                }
              ]
            },
            "options": {}
          },
          "id": "6f4712c9-b6b7-45bd-abc9-ecaeaf2141bd"
        },
        {
          "name": "Update Product in Notion1",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            20,
            2740
          ],
          "parameters": {
            "operation": "updatePage"
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "757f131e-7d3f-46b7-9626-ce1efbd567a6"
        },
        {
          "name": "save social description",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            240,
            380
          ],
          "parameters": {
            "jsCode": "// Save product description for the product\nreturn [{\n  json: {\n    product_id: $input.item.json.id,\n    product_description: $input.item.json.text\n  }\n}];"
          },
          "id": "2b3564d1-bc51-4c84-8f53-fe4202143e4b"
        },
        {
          "name": "save social Content",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            680,
            380
          ],
          "parameters": {
            "jsCode": "// Save social media content for the product\nreturn [{\n  json: {\n    product_id: $input.item.json.id,\n    social_content: $input.item.json.text\n  }\n}];"
          },
          "id": "ca609e82-ee66-4b96-87c8-571e7ae03125"
        },
        {
          "name": "Select Best Image",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -200,
            1760
          ],
          "parameters": {
            "functionCode": "// Select the best image from the grid (defaults to first image)\nconst imageUrls = $json.image_urls;\n\nlet result = {\n  success: false,\n  image_url: '',\n  error: '',\n  product_id: $json.product_id\n};\n\ntry {\n  // Check if we have any images\n  if (imageUrls && imageUrls.length > 0) {\n    // Select the first image by default\n    result.image_url = imageUrls[0];\n    result.success = true;\n    \n    // Here you could implement more sophisticated image selection logic\n    // For example, you could analyze image dimensions, content, etc.\n  } else {\n    result.error = 'No images available to select';\n  }\n} catch (error) {\n  result.error = `Error selecting image: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "ffe7012e-8b1f-48de-9833-5af0eb480fe9"
        },
        {
          "name": "Prepare Notion Update",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            240,
            1760
          ],
          "parameters": {
            "functionCode": "// Store product ID with image URL\nreturn [{\n  json: {\n    product_id: $json.product_id || $node[\"Process MJ Response\"].json.product_id,\n    secure_url: $json.secure_url,\n    original_url: $json.image_url || $node[\"Select Best Image\"].json.image_url\n  }\n}];"
          },
          "id": "75d55302-6792-4846-ab7e-734c26f42c35"
        },
        {
          "name": "Is Image Available?",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            -420,
            1860
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.success }}",
                  "value2": "true"
                }
              ]
            }
          },
          "id": "6386d3e0-d847-4e23-9f82-8de31efec7df"
        },
        {
          "name": "Schedule Trigger2",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -860,
            1040
          ],
          "parameters": {
            "rule": {
              "interval": [
                {}
              ]
            }
          },
          "id": "51a0dc5e-9836-450a-8007-4bc06fd064a2"
        },
        {
          "name": "Get New Products2",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            -640,
            1040
          ],
          "parameters": {
            "resource": "database",
            "databaseId": {
              "__rl": true,
              "value": "1c374ec0-3114-808f-8e4b-cfbadfd69718",
              "mode": "list",
              "cachedResultName": "balding_pig_product_cycle_auto",
              "cachedResultUrl": "https://www.notion.so/1c374ec03114808f8e4bcfbadfd69718"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "be3fa321-5e26-43ba-a375-e76a982f4752"
        },
        {
          "name": "Process Each Product2",
          "type": "n8n-nodes-base.splitInBatches",
          "typeVersion": 2,
          "position": [
            -420,
            1040
          ],
          "parameters": {
            "batchSize": 1,
            "options": {}
          },
          "id": "ad002335-ad9f-4d35-9ecc-b7e7ca1bfac3"
        },
        {
          "name": "Extract Product Data2",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -200,
            1040
          ],
          "parameters": {
            "functionCode": "// Extract product data and format it for processing\nconst product = $input.item.json;\nconst productData = {};\n\n// Extract properties from Notion format\ntry {\n  // Handle different property types\n  Object.keys(product.properties).forEach(key => {\n    const prop = product.properties[key];\n    \n    if (prop.type === 'title' && prop.title.length > 0) {\n      productData.product_name = prop.title[0].plain_text;\n    }\n    else if (prop.type === 'rich_text' && prop.rich_text.length > 0) {\n      productData[key] = prop.rich_text[0].plain_text;\n    }\n    else if (prop.type === 'select' && prop.select) {\n      productData[key] = prop.select.name;\n    }\n    else if (prop.type === 'multi_select' && prop.multi_select) {\n      productData[key] = prop.multi_select.map(item => item.name);\n    }\n    else if (prop.type === 'number' && prop.number !== null) {\n      productData[key] = prop.number;\n    }\n  });\n} catch (error) {\n  // Provide fallback if property extraction fails\n  console.log('Error extracting properties:', error);\n  productData.error = error.message;\n}\n\n// Add a unique ID for tracking\nproductData.id = product.id;\n\n// Add an AI prompt for image generation\nif (productData.product_name && productData.description) {\n  productData.ai_prompt = `${productData.product_name} - ${productData.description}`;\n} else if (productData.product_name) {\n  productData.ai_prompt = productData.product_name;\n} else {\n  productData.ai_prompt = \"Balding Pig branded product, professional product photography\";\n}\n\nreturn [{ json: productData }];"
          },
          "id": "7b5a0c3f-3970-4be5-8051-cb512986ed4b"
        },
        {
          "name": "Generate Social Media Content2",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            20,
            840
          ],
          "parameters": {
            "prompt": "Create social media posts for a product from our baldness-themed brand \"The Balding Pig\". Create one post each for LinkedIn, Instagram, TikTok and Facebook. Each post should be appropriate for the platform, have the right tone and length, and include relevant hashtags.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nTarget Demographics: {{ $json.target_demographics }}\n\nOur brand voice is confident, slightly humorous, and empowering for people experiencing hair loss. We celebrate baldness as a sign of confidence and character rather than something to be ashamed of.\n\nFormat each post clearly with the platform name as a header.",
            "options": {
              "maxTokens": 1000,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "059666e9-a158-4752-9cc4-69033aaf2c92"
        },
        {
          "name": "Generate Product Description2",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            20,
            1040
          ],
          "parameters": {
            "prompt": "Create a detailed product description for an e-commerce website selling baldness-themed products. This is for our brand \"The Balding Pig\" which celebrates baldness with humor, confidence, and style.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nColors Available: {{ $json.colours }}\nTarget Demographics: {{ $json.target_demographics }}\n\nThe product description should include:\n1. An attention-grabbing headline (max 60 characters)\n2. A 150-200 word main description that emphasizes benefits and features\n3. 3-5 bullet points highlighting key selling points\n4. A short closing statement with a call-to-action\n\nWrite in HTML format with appropriate tags for headings, paragraphs, and bullet points. The tone should be confident, slightly humorous, and empowering for people experiencing hair loss.",
            "options": {
              "maxTokens": 800,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "bc9bc532-7170-45b6-bc51-a94004090549"
        },
        {
          "name": "Generate MJ Image1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            20,
            1240
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.goapi.ai/api/v1/task",
            "authentication": "genericCredentialType",
            "genericAuthType": "bearerAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"model\": \"midjourney\",\n  \"task_type\": \"imagine\",\n  \"input\": {\n    \"prompt\": \"{{ $json.ai_prompt }}, high quality product photography, white background, professional lighting, 8K resolution, advertising style\",\n    \"aspect_ratio\": \"1:1\"\n  },\n  \"webhook_url\": \"{{ $workflow.staticData.webhookUrl }}\",\n  \"webhook_type\": \"post\"\n}",
            "options": {
              "redirect": {
                "redirect": {}
              },
              "timeout": 120000
            }
          },
          "credentials": {
            "bearerAuth": {
              "id": "2LjDTJRbDDGRsRXI",
              "name": "Header Auth account"
            }
          },
          "id": "cd064e8e-78d6-4966-ae0a-5d52ebaa2301"
        },
        {
          "name": "MJ Response Webhook1",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -860,
            1860
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-webhook",
            "options": {}
          },
          "id": "69f765ec-82d9-4943-9864-7138ee7908c0"
        },
        {
          "name": "Process MJ Response1",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -640,
            1860
          ],
          "parameters": {
            "functionCode": "// Process the MJ response\nconst responseData = $input.item.json;\n\nlet result = {\n  success: false,\n  image_urls: [],\n  task_id: '',\n  error: ''\n};\n\ntry {\n  // Extract task ID\n  if (responseData.task_id) {\n    result.task_id = responseData.task_id;\n  } else if (responseData.id) {\n    result.task_id = responseData.id;\n  }\n  \n  // Extract image URLs\n  if (responseData.image_urls && Array.isArray(responseData.image_urls)) {\n    result.image_urls = responseData.image_urls;\n    result.success = true;\n  } else if (responseData.images && Array.isArray(responseData.images)) {\n    result.image_urls = responseData.images;\n    result.success = true;\n  } else if (responseData.image_url) {\n    // Single image URL\n    result.image_urls = [responseData.image_url];\n    result.success = true;\n  }\n  \n  // Try to get product ID from earlier nodes\n  try {\n    // Look for product ID in static data or previous node output\n    const productId = $workflow.staticData.currentProductId || $node[\"Extract Product Data\"].json.id;\n    result.product_id = productId;\n  } catch (e) {\n    console.log('Could not retrieve product ID from workflow data');\n  }\n  \n  // Check if we have any images\n  if (result.image_urls.length === 0) {\n    if (responseData.status === 'pending' || responseData.status === 'processing') {\n      result.error = 'Image generation is still in progress. Results will be delivered via webhook.';\n    } else {\n      result.error = 'No images were found in the response.';\n    }\n  }\n  \n} catch (error) {\n  result.error = `Error processing Midjourney response: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "59731d0e-5a1d-4318-b039-8c9d3d58cb3a"
        },
        {
          "name": "Store Image in Cloudinary2",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            20,
            1760
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/upload",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file",
                  "value": "={{ $json.image_url }}"
                },
                {
                  "name": "upload_preset",
                  "value": "balding_pig_products"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "2LjDTJRbDDGRsRXI",
              "name": "Header Auth account"
            }
          },
          "id": "ea112f06-f3a4-4327-9b52-11f1d567af0b"
        },
        {
          "name": "Update Product in Notion2",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            460,
            1760
          ],
          "parameters": {
            "operation": "updatePage"
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "e81c0a96-206d-41cc-b5b7-b5ad102b7d4e"
        },
        {
          "name": "Save Social Content1",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            240,
            840
          ],
          "parameters": {
            "functionCode": "// Save social media content for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    social_content: $json.text\n  }\n}];"
          },
          "id": "c71ae3af-07d3-4ef5-ba35-62dd62061669"
        },
        {
          "name": "Save Product Description1",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            240,
            1040
          ],
          "parameters": {
            "functionCode": "// Save product description for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    product_description: $json.text\n  }\n}];"
          },
          "id": "206a9469-8bdb-4a5b-bd7c-6366e3d8b4d9"
        },
        {
          "name": "Send Error Email1",
          "type": "n8n-nodes-base.emailSend",
          "typeVersion": 1,
          "position": [
            -200,
            1960
          ],
          "parameters": {
            "fromEmail": "michael@rentasling.ie",
            "toEmail": "michael@rentasling.ie",
            "ccEmail": "bermingham1985@gmail.com",
            "subject": "Error in Midjourney Image Generation",
            "text": "problem with midjourney image generation",
            "html": "=<p>There was an error in the Midjourney image generation process for product: <strong>{{ $node[\"Extract Product Data2\"].json.product_name }}</strong></p>\n<p>Error details: {{ $json.error }}</p>\n<p>Please check the workflow and try again.</p>",
            "options": {}
          },
          "credentials": {
            "smtp": {
              "id": "iumI0fkYY1HcljyG",
              "name": "SMTP account"
            }
          },
          "id": "1709737b-7508-47b8-85db-b632243f3d4b"
        },
        {
          "name": "Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2.2,
          "position": [
            -420,
            2220
          ],
          "parameters": {
            "resource": "databasePage",
            "operation": "update",
            "pageId": {
              "__rl": true,
              "mode": "id",
              "value": "",
              "__regex": "^([0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12})"
            },
            "propertiesUi": {
              "propertyValues": [
                {}
              ]
            },
            "options": {}
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "e7a61ccc-6667-4902-a989-5e69aa1bc7b7"
        }
      ],
      "connections": {
        "Schedule Trigger": {
          "main": [
            [
              {
                "node": "Get New Products",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get New Products": {
          "main": [
            [
              {
                "node": "Process Each Product",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Each Product": {
          "main": [
            [
              {
                "node": "Extract Product Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Product Data": {
          "main": [
            [
              {
                "node": "Generate Social Media Content",
                "type": "main",
                "index": 0
              },
              {
                "node": "Generate Product Description",
                "type": "main",
                "index": 0
              },
              {
                "node": "Discord Imagine",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Social Media Content": {
          "main": [
            [
              {
                "node": "Save Social Content",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Product Description": {
          "main": [
            [
              {
                "node": "Save Product Description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Midjourney Webhook": {
          "main": [
            [
              {
                "node": "Parse Midjourney Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse Midjourney Response": {
          "main": [
            [
              {
                "node": "Upscale Selected Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upscale Result Webhook": {
          "main": [
            [
              {
                "node": "Process Upscale Result",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Upscale Result": {
          "main": [
            [
              {
                "node": "Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Store Image in Cloudinary": {
          "main": [
            [
              {
                "node": "Save Product Image URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Product Image URL": {
          "main": [
            [
              {
                "node": "Update Product in Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "MJ Response Webhook": {
          "main": [
            [
              {
                "node": "Process MJ Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process MJ Response": {
          "main": [
            [
              {
                "node": "Upscale MJ Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "MJ Upscale Webhook": {
          "main": [
            [
              {
                "node": "Process Upscale Result1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Is Upscale Successful?": {
          "main": [
            [
              {
                "node": "Store Image in Cloudinary1",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Send Error Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Trigger1": {
          "main": [
            [
              {
                "node": "Get New Products1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get New Products1": {
          "main": [
            [
              {
                "node": "Process Each Product1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Each Product1": {
          "main": [
            [
              {
                "node": "Extract Product Data1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Product Data1": {
          "main": [
            [
              {
                "node": "Generate Product Description1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Generate MJ Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Social Media Content1": {
          "main": [
            [
              {
                "node": "save social Content",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Product Description1": {
          "main": [
            [
              {
                "node": "save social description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Upscale Result1": {
          "main": [
            [
              {
                "node": "Is Upscale Successful?",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Store Image in Cloudinary1": {
          "main": [
            [
              {
                "node": "Update Product in Notion1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "save social description": {
          "main": [
            [
              {
                "node": "Generate Social Media Content1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Select Best Image": {
          "main": [
            [
              {
                "node": "Store Image in Cloudinary2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare Notion Update": {
          "main": [
            [
              {
                "node": "Update Product in Notion2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Is Image Available?": {
          "main": [
            [
              {
                "node": "Select Best Image",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Send Error Email1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Trigger2": {
          "main": [
            [
              {
                "node": "Get New Products2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get New Products2": {
          "main": [
            [
              {
                "node": "Process Each Product2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Each Product2": {
          "main": [
            [
              {
                "node": "Extract Product Data2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Product Data2": {
          "main": [
            [
              {
                "node": "Generate Social Media Content2",
                "type": "main",
                "index": 0
              },
              {
                "node": "Generate Product Description2",
                "type": "main",
                "index": 0
              },
              {
                "node": "Generate MJ Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Social Media Content2": {
          "main": [
            [
              {
                "node": "Save Social Content1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Product Description2": {
          "main": [
            [
              {
                "node": "Save Product Description1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "MJ Response Webhook1": {
          "main": [
            [
              {
                "node": "Process MJ Response1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process MJ Response1": {
          "main": [
            [
              {
                "node": "Is Image Available?",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Store Image in Cloudinary2": {
          "main": [
            [
              {
                "node": "Prepare Notion Update",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Notion": {
          "main": [
            [
              {
                "node": "Store Image in Cloudinary",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger": {
          "recurrenceRules": []
        },
        "node:Schedule Trigger1": {
          "recurrenceRules": []
        },
        "node:Schedule Trigger2": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "c55eee8f-0714-4ce9-b65c-d52957dda547",
      "triggerCount": 8,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:18.839Z",
          "createdAt": "2025-11-01T14:40:18.839Z",
          "role": "workflow:owner",
          "workflowId": "6QiqcpYIqavQDCaD",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:19Z",
      "createdAt": "2025-11-01T14:40:17.849Z",
      "id": "6f8ohas0Tx43Xotr",
      "name": "orchestrator-demo",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {
            "path": "demo",
            "responseMode": "lastNode",
            "options": {}
          },
          "id": "134e2221-b9e9-4fda-a099-957e5b51c0c2"
        },
        {
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "ok",
                  "value": "true"
                }
              ]
            },
            "options": {}
          },
          "id": "ea6dd6cc-4bac-4233-8b5a-f2344af57c16"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Set",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "5aa86903-61b3-4bd7-8840-81182b6aeb75",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:17.851Z",
          "createdAt": "2025-11-01T14:40:17.851Z",
          "role": "workflow:owner",
          "workflowId": "6f8ohas0Tx43Xotr",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:30.322Z",
      "createdAt": "2025-11-01T14:40:30.322Z",
      "id": "7FjJVzpaNAe6RDTW",
      "name": "Tool Registry Refresh (04:00) (imported 20251101_144030)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Trigger - 04:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 4 * * *"
                }
              ]
            }
          },
          "id": "7de20367-19cd-409e-9950-99fa61e1ad6f"
        },
        {
          "name": "Get All Tools",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            450,
            300
          ],
          "parameters": {
            "operation": "getAll",
            "base": "={{$env.NOTION_DATABASE_ID_TOOL_REGISTRY}}",
            "returnAll": true
          },
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "a12d418c-2283-4144-9f71-da3699fb0baa"
        },
        {
          "name": "Check Tool Health",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "parameters": {
            "functionCode": "// Check tool status and update reliability\nconst tool = $input.item.json;\nconst now = new Date();\n\n// Mock health check (replace with actual API calls)\nconst isHealthy = Math.random() > 0.1; // 90% uptime simulation\n\nconst updatedTool = {\n  id: tool.id,\n  reliability_score: isHealthy ? Math.min(tool.ReliabilityScore + 1, 100) : Math.max(tool.ReliabilityScore - 5, 0),\n  status: isHealthy ? 'Active' : 'Degraded',\n  last_checked: now.toISOString()\n};\n\nreturn [{ json: updatedTool }];"
          },
          "id": "5063d9ea-ba0c-4737-aa91-4052f767a9ff"
        },
        {
          "name": "Update Tool Registry",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.id}}",
            "properties": {
              "ReliabilityScore": "={{$json.reliability_score}}",
              "Status": "={{$json.status}}"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "a89b7827-76f1-4b21-a311-279a21f11688"
        }
      ],
      "connections": {
        "Schedule Trigger - 04:00": {
          "main": [
            [
              {
                "node": "Get All Tools",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get All Tools": {
          "main": [
            [
              {
                "node": "Check Tool Health",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Tool Health": {
          "main": [
            [
              {
                "node": "Update Tool Registry",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "f2aa02f5-5caa-4825-8880-d7895166d3f0",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:30.324Z",
          "createdAt": "2025-11-01T14:40:30.324Z",
          "role": "workflow:owner",
          "workflowId": "7FjJVzpaNAe6RDTW",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:01Z",
      "createdAt": "2025-11-01T14:40:32.047Z",
      "id": "7w8T2flZDRuXx08o",
      "name": "E-commerce Order Processing Workflow (imported 20251101_144032)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Start",
          "type": "n8n-nodes-base.start",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {},
          "id": "58153b9e-4fe7-4e44-b2e6-e331b3f5345c"
        },
        {
          "name": "Get Shopify Orders",
          "type": "n8n-nodes-base.shopify",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "resource": "order",
            "operation": "getAll",
            "returnAll": true,
            "options": {
              "status": "any"
            }
          },
          "credentials": {
            "shopifyApi": {
              "id": "shopify-credentials",
              "name": "Shopify API"
            }
          },
          "id": "8cd1b2ff-d5f1-4607-b792-467eafc0b179"
        },
        {
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            680,
            300
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.financial_status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "e1a90b22-5d03-4d1a-8ea1-76a6ec6a8fd2"
        },
        {
          "name": "Add to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4,
          "position": [
            900,
            240
          ],
          "parameters": {
            "resource": "spreadsheet",
            "operation": "appendRow",
            "documentId": {
              "__rl": true,
              "value": "your-google-sheet-id",
              "mode": "list",
              "cachedResultName": "Order Tracking Sheet"
            },
            "sheetName": {
              "__rl": true,
              "value": "Sheet1",
              "mode": "list",
              "cachedResultName": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Order ID": "={{ $json.order_number }}",
                "Customer Email": "={{ $json.email }}",
                "Total Amount": "={{ $json.total_price }}",
                "Status": "={{ $json.financial_status }}",
                "Date": "={{ $json.created_at }}"
              }
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "google-sheets-credentials",
              "name": "Google Sheets OAuth2"
            }
          },
          "id": "2f4e6975-702e-4b24-9fdd-7e63159abb0a"
        },
        {
          "name": "Create Salesforce Lead",
          "type": "n8n-nodes-base.salesforce",
          "typeVersion": 1,
          "position": [
            900,
            360
          ],
          "parameters": {
            "resource": "lead",
            "operation": "create",
            "additionalFields": {
              "firstName": "={{ $json.billing_address.first_name }}",
              "lastName": "={{ $json.billing_address.last_name }}",
              "email": "={{ $json.email }}",
              "company": "={{ $json.billing_address.company }}",
              "phone": "={{ $json.billing_address.phone }}"
            }
          },
          "credentials": {
            "salesforceOAuth2Api": {
              "id": "salesforce-credentials",
              "name": "Salesforce OAuth2"
            }
          },
          "id": "bab564a9-3e88-4032-af5c-54c56c87588c"
        },
        {
          "name": "Send Confirmation Email",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 1,
          "position": [
            1120,
            300
          ],
          "parameters": {
            "fromEmail": "orders@yourcompany.com",
            "toEmail": "={{ $json.email }}",
            "subject": "Order Confirmation - {{ $json.order_number }}",
            "message": "Thank you for your order! Your order #{{ $json.order_number }} for ${{ $json.total_price }} has been processed successfully.",
            "options": {}
          },
          "credentials": {
            "gmailOAuth2": {
              "id": "gmail-credentials",
              "name": "Gmail OAuth2"
            }
          },
          "id": "6b9d7ee9-67bd-467d-99b8-c975e6b9c5b6"
        }
      ],
      "connections": {
        "Start": {
          "main": [
            [
              {
                "node": "Get Shopify Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Shopify Orders": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Add to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Salesforce Lead",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add to Google Sheets": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Salesforce Lead": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "61373239-3a5b-4413-898c-c3e1c5229ea8",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:32.049Z",
          "createdAt": "2025-11-01T14:40:32.049Z",
          "role": "workflow:owner",
          "workflowId": "7w8T2flZDRuXx08o",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:17Z",
      "createdAt": "2025-11-01T14:40:21.04Z",
      "id": "87hnU262j6DcroiU",
      "name": "orchestrator-demo",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {
            "path": "demo",
            "responseMode": "lastNode",
            "options": {}
          },
          "id": "75cc41ab-4d88-40f3-a88d-bdb05503122a"
        },
        {
          "name": "Set",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "ok",
                  "value": "true"
                }
              ]
            },
            "options": {}
          },
          "id": "729a5084-f1c4-4807-92e7-2ed6a8dd9a89"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Set",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "d2c3103e-4599-49b8-8e97-11646c00a3f8",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:21.043Z",
          "createdAt": "2025-11-01T14:40:21.043Z",
          "role": "workflow:owner",
          "workflowId": "87hnU262j6DcroiU",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-31T05:04:28Z",
      "createdAt": "2025-10-31T03:45:41.716Z",
      "id": "9O2i2ijiUuJHemVQ",
      "name": "Evening Autopilot (17:00)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 17 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 17:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "4ff91b4d-ed70-4c2c-8e26-3cf2a97ff458"
        }
      ],
      "connections": {},
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 17:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "7cbad8db-a6ae-4427-ab8b-0274316625b6",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-31T03:45:41.719Z",
          "createdAt": "2025-10-31T03:45:41.719Z",
          "role": "workflow:owner",
          "workflowId": "9O2i2ijiUuJHemVQ",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:07Z",
      "createdAt": "2025-11-02T02:38:59.322Z",
      "id": "CAYyAji0oH9AZ60P",
      "name": "Automate product generator the balding pig",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "AI Product Generator Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1,
          "position": [
            -1780,
            520
          ],
          "parameters": {
            "text": "={\n  \"ai_agent_system_message\": \"You are an expert e-commerce product designer specializing in TheBaldingPig brand - a bold, quirky brand that celebrates baldness with confidence and humor. Your task is to generate exactly 5 unique, commercially viable product ideas that embrace bald pride. Always respond with valid JSON array format. Focus on humor, empowerment, and current market trends.\",\n  \n  \"ai_agent_input_prompt\": \"Generate 5 unique e-commerce product ideas for TheBaldingPig brand based on: \\\"{{USER_PROMPT}}\\\"\\n\\nBrand Context: TheBaldingPig celebrates baldness with confidence and humor through quirky, empowering products.\\n\\nIMPORTANT: Respond with a JSON array containing exactly 5 products. Each product must have these exact fields:\\n\\n{\\n  \\\"name\\\": \\\"Product name (clever, bald-related)\\\",\\n  \\\"description\\\": \\\"2-3 sentence product description incorporating bald pride/humor\\\",\\n  \\\"tagline\\\": \\\"Catchy marketing tagline\\\",\\n  \\\"design_style\\\": \\\"Visual design style (e.g., minimalist, vintage, modern)\\\",\\n  \\\"colours\\\": \\\"Color scheme description\\\",\\n  \\\"keywords\\\": \\\"SEO keywords separated by commas\\\",\\n  \\\"ai_prompt\\\": \\\"Detailed AI image generation prompt\\\",\\n  \\\"target_audience\\\": \\\"Target demographic description\\\",\\n  \\\"estimated_price\\\": 25.99\\n}\\n\\nMake each product unique, commercially viable, and aligned with the bald-positive brand identity.\",\n  \n  \"expected_ai_response_format\": [\n    {\n      \"name\": \"string - creative product name with bald theme\",\n      \"description\": \"string - 2-3 sentences describing the product with humor and confidence\",\n      \"tagline\": \"string - catchy one-liner that embodies the product\",\n      \"design_style\": \"string - design aesthetic (Modern, Vintage, Minimalist, Bold, etc.)\",\n      \"colours\": \"string - specific color scheme description\",\n      \"keywords\": \"string - comma-separated SEO keywords\",\n      \"ai_prompt\": \"string - detailed prompt for Midjourney/DALL-E image generation\",\n      \"target_audience\": \"string - specific demographic and psychographic description\",\n      \"estimated_price\": \"number - price in dollars (e.g., 24.99)\"\n    }\n  ],\n  \n  \"example_ai_response\": [\n    {\n      \"name\": \"Chrome Dome Champion Hoodie\",\n      \"description\": \"Embrace the shine with this ultra-soft hoodie featuring bold graphics celebrating your polished crown. Made from premium cotton blend, it's perfect for those who wear their baldness like a badge of honor.\",\n      \"tagline\": \"Shine Bright, Live Bold!\",\n      \"design_style\": \"Urban Streetwear\",\n      \"colours\": \"Charcoal grey with metallic silver accents\",\n      \"keywords\": \"bald hoodie, chrome dome apparel, bald pride clothing, confidence wear, streetwear, bald positive\",\n      \"ai_prompt\": \"Charcoal grey hoodie with metallic silver graphic of a shining bald head with crown, urban streetwear style, premium cotton blend, professional product photography on white background\",\n      \"target_audience\": \"Fashion-forward bald individuals aged 25-45 who embrace streetwear culture\",\n      \"estimated_price\": 44.99\n    },\n    {\n      \"name\": \"Solar Panel Power Bank\",\n      \"description\": \"Turn your 'solar panel' into an actual power source! This novelty power bank shaped like a bald head charges your devices while celebrating your eco-friendly dome.\",\n      \"tagline\": \"Powered by Natural Light - Just Like You!\",\n      \"design_style\": \"Tech Accessory Humor\",\n      \"colours\": \"Glossy white with solar panel texture\",\n      \"keywords\": \"bald tech accessories, funny power bank, solar panel joke, bald humor gift, eco friendly, chrome dome\",\n      \"ai_prompt\": \"White glossy power bank shaped like a bald head with solar panel texture on top, USB ports hidden discretely, product photography showing charging capability\",\n      \"target_audience\": \"Tech-savvy professionals with a sense of humor about their baldness\",\n      \"estimated_price\": 34.99\n    },\n    {\n      \"name\": \"Aerodynamic Advantage Running Cap\",\n      \"description\": \"Scientifically designed for the streamlined athlete! This moisture-wicking cap features aerodynamic jokes and UV protection for your brilliant dome during workouts.\",\n      \"tagline\": \"Less Drag, More Speed!\",\n      \"design_style\": \"Athletic Performance\",\n      \"colours\": \"Electric blue with reflective silver trim\",\n      \"keywords\": \"bald running gear, athletic cap, UV protection, aerodynamic humor, sports accessories, fitness\",\n      \"ai_prompt\": \"Electric blue athletic cap with reflective silver trim, aerodynamic arrow graphics, moisture-wicking fabric, shown on athletic model in action\",\n      \"target_audience\": \"Active bald individuals who enjoy running and outdoor sports\",\n      \"estimated_price\": 22.99\n    },\n    {\n      \"name\": \"Bald & Beautiful Affirmation Cards\",\n      \"description\": \"Daily confidence boosters designed specifically for the follicly-free! This deck of 52 cards features empowering messages and bald-positive affirmations to start your day right.\",\n      \"tagline\": \"52 Weeks of Shine!\",\n      \"design_style\": \"Minimalist Inspiration\",\n      \"colours\": \"Rose gold foil on cream cardstock\",\n      \"keywords\": \"affirmation cards, bald positive, self care, confidence building, motivational gift, daily inspiration\",\n      \"ai_prompt\": \"Elegant affirmation card deck with rose gold foil lettering on cream cardstock, minimalist design, showing sample cards with bald-positive messages\",\n      \"target_audience\": \"Mindfulness enthusiasts and those on a self-love journey\",\n      \"estimated_price\": 19.99\n    },\n    {\n      \"name\": \"The Head Polish Grooming Kit\",\n      \"description\": \"A premium 5-piece grooming set for the distinguished dome. Includes specialized head moisturizer, polish cloth, SPF protection, and more in a sleek travel case.\",\n      \"tagline\": \"Executive Shine, Every Time!\",\n      \"design_style\": \"Luxury Grooming\",\n      \"colours\": \"Matte black case with gold accents\",\n      \"keywords\": \"bald head care, grooming kit, head polish, scalp care, luxury grooming, executive gift\",\n      \"ai_prompt\": \"Matte black grooming case with gold accents, opened to show 5 premium grooming products for bald head care, luxury product photography\",\n      \"target_audience\": \"Professional men who take pride in their appearance and grooming\",\n      \"estimated_price\": 49.99\n    }\n  ],\n  \n  \"data_flow_after_parsing\": {\n    \"description\": \"After the AI generates products and they're parsed, each product gets these additional fields:\",\n    \"additional_fields\": {\n      \"product_index\": \"number - 1 through 5\",\n      \"generated_at\": \"ISO timestamp\",\n      \"source_prompt\": \"original user prompt\",\n      \"generation_method\": \"AI Agent + OpenAI Chat Model\",\n      \"webhook_config\": {\n        \"discord_webhook_url\": \"from original webhook\",\n        \"printify_shop_id\": \"from original webhook\",\n        \"printify_blueprint_id\": \"from original webhook\",\n        \"printify_provider_id\": \"from original webhook\"\n      }\n    }\n  },\n  \n  \"complete_data_structure_per_product\": {\n    \"name\": \"Product name from AI\",\n    \"description\": \"Product description from AI\",\n    \"tagline\": \"Product tagline from AI\",\n    \"design_style\": \"Design style from AI\",\n    \"colours\": \"Color scheme from AI\",\n    \"keywords\": \"SEO keywords from AI\",\n    \"ai_prompt\": \"Image generation prompt from AI\",\n    \"target_audience\": \"Target audience from AI\",\n    \"estimated_price\": \"Price from AI\",\n    \"product_index\": \"1-5 (added by parser)\",\n    \"generated_at\": \"2025-01-16T12:00:00.000Z (added by parser)\",\n    \"source_prompt\": \"Original user prompt (added by parser)\",\n    \"generation_method\": \"AI Agent + OpenAI Chat Model (added by parser)\",\n    \"webhook_config\": {\n      \"discord_webhook_url\": \"https://discord.com/api/webhooks/...\",\n      \"printify_shop_id\": \"shop_123456\",\n      \"printify_blueprint_id\": 384,\n      \"printify_provider_id\": 1\n    }\n  }\n}",
            "options": {}
          },
          "notes": "Connect OpenAI Chat Model to the 'ai_chatModel' input",
          "id": "f724eef5-8aee-4b05-b547-83d334f5e7bc"
        },
        {
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1,
          "position": [
            -1692,
            740
          ],
          "parameters": {
            "model": "gpt-4",
            "options": {
              "maxTokens": 2500,
              "responseFormat": "=",
              "temperature": 0.8
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "notes": "Add your OpenAI API key in credentials",
          "id": "b62931a4-94ff-49ef-803f-90bdf7c9d96b"
        },
        {
          "name": "Webhook Trigger1",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -2220,
            520
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "product-generator",
            "responseMode": "lastNode",
            "options": {}
          },
          "notes": "Receives POST requests with: {\"prompt\": \"your product idea\", \"discord_webhook_url\": \"your_discord_url\", \"printify_shop_id\": \"your_shop_id\", \"printify_blueprint_id\": 384, \"printify_provider_id\": 1}",
          "id": "8f086abc-baf7-4412-87cc-1ef268585691"
        },
        {
          "name": "Prepare AI Input1",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -1920,
            520
          ],
          "parameters": {
            "jsCode": "const promptData = $input.all()[0]?.json;\n\nconst mugData = {\n  title: \"Funny Bald-Themed Coffee Mug\",\n  description:\n    \"Enjoy your morning coffee with a touch of humor! This mug features a funny bald-themed design that's sure to bring a smile to your face.\",\n  print_provider_id: promptData.printify_provider_id,\n  blueprint_id: promptData.printify_blueprint_id,\n  print_areas: [\n    {\n      id: 1,\n      design_url: \"https://example.com/bald-design.jpg\",\n    },\n  ],\n};\n\nconst discordWebhookData = {\n  content: `New product created: Funny Bald-Themed Coffee Mug. Check it out in your Printify shop: https://printify.com/app/shops/${promptData.printify_shop_id}/products`,\n};\n\nreturn { mugData, discordWebhookData };\n"
          },
          "id": "50c8148e-81be-4924-9875-2538eb543f0d"
        },
        {
          "name": "Parse AI Response1",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -1400,
            520
          ],
          "parameters": {
            "jsCode": "// Enhanced parsing for AI Agent response\nconst items = $input.all();\n\ntry {\n  console.log('AI Agent Response:', JSON.stringify(items, null, 2));\n  \n  // Get the AI response - could be in different formats\n  let aiResponse;\n  const firstItem = items[0].json;\n  \n  // Check various possible response structures from AI Agent\n  if (firstItem.output) {\n    aiResponse = firstItem.output;\n  } else if (firstItem.text) {\n    aiResponse = firstItem.text;\n  } else if (firstItem.response) {\n    aiResponse = firstItem.response;\n  } else if (firstItem.content) {\n    aiResponse = firstItem.content;\n  } else {\n    // Fallback: stringify and parse\n    aiResponse = JSON.stringify(firstItem);\n  }\n  \n  console.log('AI Response Content:', aiResponse);\n  \n  // Parse the JSON array directly since it's already valid JSON\n  let products;\n  if (typeof aiResponse === 'string') {\n    products = JSON.parse(aiResponse);\n  } else if (Array.isArray(aiResponse)) {\n    products = aiResponse;\n  } else {\n    // If it's an object with products array\n    products = aiResponse.products || [aiResponse];\n  }\n  \n  console.log('Parsed Products:', products);\n  \n  // Simplified version - just add basic fields without referencing other nodes\n  const result = products.map((product, index) => ({\n    json: {\n      ...product,\n      product_index: index + 1,\n      generated_at: new Date().toISOString(),\n      source_prompt: 'Product generation request',\n      generation_method: 'AI Agent + OpenAI Chat Model',\n      webhook_config: {\n        discord_webhook_url: '',\n        printify_shop_id: '',\n        printify_blueprint_id: 384,\n        printify_provider_id: 1\n      }\n    }\n  }));\n  \n  console.log('Final Result:', result);\n  return result;\n  \n} catch (error) {\n  console.error('Error parsing AI response:', error);\n  \n  // Return error for debugging\n  return [{\n    json: {\n      error: true,\n      message: error.message,\n      raw_response: JSON.stringify(items[0].json)\n    }\n  }];\n}"
          },
          "id": "a91acdf9-537c-4990-81b5-12c66b9d0fd0"
        },
        {
          "name": "Send to Discord/Midjourney1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -744,
            420
          ],
          "parameters": {
            "url": "={{ $json.webhook_config.discord_webhook_url || 'https://discord.com/api/webhooks/YOUR_WEBHOOK_URL' }}",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"content\": \"/imagine prompt: {{ $json.ai_prompt }} --ar 1:1 --v 6 --style raw\",\n  \"username\": \"TheBaldingPig AI Agent\",\n  \"embeds\": [\n    {\n      \"title\": \"🤖 AI Agent Generated Product #{{ $json.product_index }}\",\n      \"description\": \"**{{ $json.name }}**\\n\\n{{ $json.description }}\",\n      \"color\": 3447003,\n      \"fields\": [\n        {\n          \"name\": \"🎨 Style\",\n          \"value\": \"{{ $json.design_style }}\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"🌈 Colors\",\n          \"value\": \"{{ $json.colours }}\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"💰 Price\",\n          \"value\": \"${{ $json.estimated_price }}\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"🎯 Target\",\n          \"value\": \"{{ $json.target_audience }}\",\n          \"inline\": false\n        },\n        {\n          \"name\": \"🏷️ Keywords\",\n          \"value\": \"{{ $json.keywords }}\",\n          \"inline\": false\n        },\n        {\n          \"name\": \"💡 Tagline\",\n          \"value\": \"{{ $json.tagline }}\",\n          \"inline\": false\n        }\n      ],\n      \"footer\": {\n        \"text\": \"Generated by TheBaldingPig AI Agent | {{ $json.generated_at }}\"\n      },\n      \"timestamp\": \"{{ $json.generated_at }}\"\n    }\n  ]\n}",
            "options": {
              "timeout": 15000
            }
          },
          "continueOnFail": true,
          "id": "e5537cf7-256f-433e-983a-489437d87dd7"
        },
        {
          "name": "Create Printify Product1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -744,
            620
          ],
          "parameters": {
            "url": "https://api.printify.com/v1/shops/{{ $json.webhook_config.printify_shop_id || 'YOUR_SHOP_ID' }}/products.json",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendQuery": true,
            "specifyQuery": "json",
            "jsonQuery": "={{ $json.name }}\n\n",
            "sendHeaders": true,
            "specifyHeaders": "json",
            "jsonHeaders": "={{ $json.name }}\n\n",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"title\": \"{{ $json.name }}\",\n  \"description\": \"{{ $json.description }}\\n\\n✨ {{ $json.tagline }}\\n\\n🎨 Style: {{ $json.design_style }}\\n🌈 Colors: {{ $json.colours }}\\n🎯 Perfect for: {{ $json.target_audience }}\",\n  \"blueprint_id\": {{ $json.webhook_config.printify_blueprint_id || 384 }},\n  \"print_provider_id\": {{ $json.webhook_config.printify_provider_id || 1 }},\n  \"variants\": [\n    {\n      \"id\": 1,\n      \"price\": {{ ($json.estimated_price * 100) | round }},\n      \"is_enabled\": true\n    }\n  ],\n  \"tags\": {{ $json.keywords.split(',').map(k => k.trim()).slice(0, 10) }}\n}",
            "options": {
              "timeout": 30000
            }
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "ArNWrcsTWDaTHbVw",
              "name": "Printify API"
            }
          },
          "notes": "Add Printify API token in HTTP Header Auth credentials",
          "continueOnFail": true,
          "id": "276f36c1-6a02-4ae5-9f3e-3d2c8244aeaa"
        },
        {
          "name": "Check Workflow Success1",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2,
          "position": [
            -524,
            520
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict"
              },
              "conditions": [
                {
                  "id": "success-condition",
                  "leftValue": "={{ $json.name }}",
                  "rightValue": "",
                  "operator": {
                    "type": "string",
                    "operation": "isNotEmpty"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "id": "ad0d422b-108a-47c4-99f8-7255c931b11c"
        },
        {
          "name": "Success Response1",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            -304,
            420
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "{\n  \"success\": true,\n  \"message\": \"AI Agent product generation completed successfully! 🚀\",\n  \"generation_method\": \"AI Agent + OpenAI Chat Model\",\n  \"products_created\": {{ $('Parse AI Response').all().length }},\n  \"notion_pages_created\": {{ $('Create Notion Page').all().length }},\n  \"discord_notifications_sent\": {{ $('Send to Discord/Midjourney').all().length }},\n  \"printify_products_created\": {{ $('Create Printify Product').all().length }},\n  \"timestamp\": \"{{ $now }}\",\n  \"webhook_url\": \"{{ $('Webhook Trigger').item.json.headers.host }}{{ $('Webhook Trigger').item.json.webhookUrl }}\",\n  \"ai_model_used\": \"gpt-4o-mini\",\n  \"source_prompt\": \"{{ $('Webhook Trigger').item.json.body.prompt }}\",\n  \"products\": {{ JSON.stringify($('Parse AI Response').all().map(item => ({ name: item.json.name, tagline: item.json.tagline, price: item.json.estimated_price }))) }}\n}",
            "options": {}
          },
          "id": "e736912f-f087-4e33-bfe3-ac0ec4f32239"
        },
        {
          "name": "Error Response1",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            -304,
            620
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "{\n  \"success\": false,\n  \"message\": \"Error in AI Agent product generation workflow\",\n  \"error\": \"{{ $json.error || 'Unknown error occurred' }}\",\n  \"step_failed\": \"{{ $json.step || 'Unknown step' }}\",\n  \"timestamp\": \"{{ $now }}\",\n  \"generation_method\": \"AI Agent + OpenAI Chat Model\",\n  \"debug_info\": {\n    \"webhook_received\": {{ $('Webhook Trigger').all().length > 0 }},\n    \"ai_agent_completed\": {{ $('AI Product Generator Agent').all().length > 0 }},\n    \"products_parsed\": {{ $('Parse AI Response').all().length }},\n    \"notion_attempts\": {{ $('Create Notion Page').all().length }}\n  }\n}",
            "options": {}
          },
          "id": "4b55e976-3b0f-4c00-84dc-739bed6bf92a"
        },
        {
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.2,
          "position": [
            -2040,
            760
          ],
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "id": "704615a3-9873-44f3-b502-c55cfb0c07cf"
        },
        {
          "name": "Edit Fields",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            -2060,
            300
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "c216a030-c68d-4081-bc37-8ea1103a2735",
                  "name": "midjourney_prompt",
                  "value": "=/imagine prompt: {{$json[\"prompt\"]}} --v 5.2\n",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "b52518ab-5d6f-4eae-9539-b953fb056814"
        },
        {
          "name": "OpenAI",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            -1180,
            520
          ],
          "parameters": {
            "resource": "image",
            "prompt": "=Generate a high-resolution, photorealistic product image suitable for Printify and e-commerce platforms.\n\nProduct Information:\n- Product Name: {{ $json[\"name\"] }}\n- Description: {{ $json[\"description\"] }}\n- Tagline: {{ $json[\"tagline\"] }}\n- Design Style: {{ $json[\"design_style\"] }}\n- Colors: {{ $json[\"colours\"] }}\n- Keywords: {{ $json[\"keywords\"] }}\n- Target Audience: {{ $json[\"target_audience\"] }}\n\nInstructions:\n- Show a single {{ $json[\"colours\"] }} coffee mug on a plain white background.\n- The mug should clearly display the text 'Bald & Bold' in a modern, bold font.\n- Ensure lighting, shadows, and reflections appear realistic and consistent with professional product photography.\n- Do not include any additional props, logos, or background elements.\n- Frame the image to leave clear margins around the mug for cropping.\n- Make sure the style and colors match the description.\n- The final image must be clean, clear, and ready to upload to Printify as a product mockup.\n",
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "d206896e-81a9-4de8-8db5-d6f028e51411"
        }
      ],
      "connections": {
        "AI Product Generator Agent": {
          "main": [
            [
              {
                "node": "Parse AI Response1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook Trigger1": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              },
              {
                "node": "Edit Fields",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Product Generator Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Prepare AI Input1": {
          "main": [
            [
              {
                "node": "AI Product Generator Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse AI Response1": {
          "main": [
            [
              {
                "node": "Create Printify Product1",
                "type": "main",
                "index": 0
              },
              {
                "node": "OpenAI",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send to Discord/Midjourney1": {
          "main": [
            [
              {
                "node": "Check Workflow Success1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Printify Product1": {
          "main": [
            [
              {
                "node": "Check Workflow Success1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Workflow Success1": {
          "main": [
            [
              {
                "node": "Success Response1",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Error Response1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Edit Fields": {
          "main": [
            [
              {
                "node": "Prepare AI Input1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI": {
          "main": [
            [
              {
                "node": "Send to Discord/Midjourney1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "a287b3ac-5d0e-4f07-96e3-6dbf3362bf2c",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:38:59.324Z",
          "createdAt": "2025-11-02T02:38:59.324Z",
          "role": "workflow:owner",
          "workflowId": "CAYyAji0oH9AZ60P",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:36:56.633Z",
      "createdAt": "2025-11-01T14:36:56.633Z",
      "id": "DICRRY9ikXX44Vql",
      "name": "USSDM - Universal Smart Subscription & Dispute Manager",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "path": "ussdm-webhook",
            "options": {}
          },
          "name": "Main Webhook Trigger",
          "id": "webhook_main",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            120,
            300
          ]
        },
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "hours",
                  "value": 24
                }
              ]
            }
          },
          "name": "Daily Sync Schedule",
          "id": "schedule_daily",
          "type": "n8n-nodes-base.schedule",
          "typeVersion": 1,
          "position": [
            120,
            500
          ]
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "operation",
                  "value": "sync_emails"
                },
                {
                  "name": "module",
                  "value": "email_aggregation"
                }
              ]
            },
            "options": {}
          },
          "name": "Set Sync Operation",
          "id": "set_operation",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            340,
            400
          ]
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.operation}}",
                  "operation": "equal",
                  "value2": "sync_emails"
                }
              ]
            }
          },
          "name": "Route by Operation",
          "id": "route_operation",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            540,
            400
          ]
        },
        {
          "parameters": {
            "authentication": "oAuth2Api",
            "simple": false,
            "format": "simple",
            "userId": "me",
            "q": "from:*@* subject:(subscription OR billing OR payment OR subscribe OR unsubscribe OR invoice)",
            "maxResults": 50
          },
          "name": "Gmail - Fetch Subscription Emails",
          "id": "gmail_fetch",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2,
          "position": [
            760,
            300
          ],
          "credentials": {
            "gmailOAuth2Api": {
              "id": "USSDM Gmail",
              "name": "Gmail OAuth2 API"
            }
          }
        },
        {
          "parameters": {
            "mode": "combine",
            "combinationMode": "mergeByPosition"
          },
          "name": "Merge Email Data",
          "id": "merge_emails",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2,
          "position": [
            980,
            400
          ]
        },
        {
          "parameters": {
            "jsCode": "// Process each email for subscription detection\nlet subscriptionEmails = [];\n\nfor (const item of $input.all()) {\n  const email = item.json;\n  \n  // Extract relevant email content\n  const emailData = {\n    id: email.id,\n    subject: email.payload?.headers?.find(h => h.name === 'Subject')?.value || '',\n    from: email.payload?.headers?.find(h => h.name === 'From')?.value || '',\n    date: email.payload?.headers?.find(h => h.name === 'Date')?.value || '',\n    snippet: email.snippet || '',\n    body: email.payload?.parts?.[0]?.body?.data || email.payload?.body?.data || ''\n  };\n  \n  // Extract keywords that indicate subscriptions\n  const subscriptionKeywords = [\n    'subscription', 'billing', 'payment', 'invoice', 'auto-renew',\n    'monthly charge', 'annual subscription', 'premium', 'upgrade',\n    'cancel subscription', 'unsubscribe', 'trial ending'\n  ];\n  \n  const hasSubscriptionKeywords = subscriptionKeywords.some(keyword => \n    emailData.subject.toLowerCase().includes(keyword) ||\n    emailData.snippet.toLowerCase().includes(keyword)\n  );\n  \n  if (hasSubscriptionKeywords) {\n    subscriptionEmails.push({\n      ...emailData,\n      classification: 'potential_subscription',\n      processing_status: 'pending_ai_analysis'\n    });\n  }\n}\n\nreturn subscriptionEmails.map(email => ({ json: email }));"
          },
          "name": "Pre-Process Emails",
          "id": "preprocess_emails",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1200,
            400
          ]
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "prompt",
                  "value": "Analyze the following email content for subscription-related information. Extract:\n1. Service/Company name\n2. Subscription type (monthly/annual/trial)\n3. Amount charged\n4. Currency\n5. Next billing date\n6. Subscription status (active/cancelled/trial)\n7. Cancellation method if available\n\nEmail Content:\nSubject: {{$json.subject}}\nFrom: {{$json.from}}\nSnippet: {{$json.snippet}}\n\nRespond in JSON format with the extracted information."
                }
              ]
            }
          },
          "name": "Prepare AI Prompt",
          "id": "prepare_ai_prompt",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            1420,
            400
          ]
        },
        {
          "parameters": {
            "model": "claude-3-7-sonnet-20250219",
            "options": {},
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.prompt}}"
                }
              ]
            }
          },
          "name": "Claude - Subscription Analysis",
          "id": "claude_analysis",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            1640,
            400
          ],
          "credentials": {
            "anthropicClaudeApi": {
              "id": "USSDM Claude",
              "name": "Claude API"
            }
          }
        },
        {
          "parameters": {
            "model": "gpt-4",
            "options": {
              "temperature": 0.1
            },
            "messages": {
              "values": [
                {
                  "role": "system",
                  "content": "You are an expert at parsing emails for subscription information. Extract structured data from subscription-related emails."
                },
                {
                  "role": "user",
                  "content": "={{$json.prompt}}"
                }
              ]
            }
          },
          "name": "OpenAI - Fallback Parser",
          "id": "openai_fallback",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            1640,
            600
          ],
          "credentials": {
            "openAiApi": {
              "id": "USSDM OpenAI",
              "name": "OpenAI API"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Parse and structure AI response\nconst items = $input.all();\nlet processedSubscriptions = [];\n\nfor (const item of items) {\n  try {\n    let analysisResult;\n    \n    // Try to parse Claude's response\n    if (item.json.content) {\n      analysisResult = JSON.parse(item.json.content);\n    } else if (item.json.message?.content) {\n      analysisResult = JSON.parse(item.json.message.content);\n    } else {\n      throw new Error('No valid content found');\n    }\n    \n    // Structure the subscription data\n    const subscription = {\n      id: item.json.id || 'unknown',\n      service_name: analysisResult.service_name || 'Unknown Service',\n      subscription_type: analysisResult.subscription_type || 'unknown',\n      amount: analysisResult.amount || 0,\n      currency: analysisResult.currency || 'USD',\n      next_billing_date: analysisResult.next_billing_date || null,\n      status: analysisResult.subscription_status || 'unknown',\n      cancellation_method: analysisResult.cancellation_method || null,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString(),\n      processing_source: item.json.content ? 'claude' : 'openai'\n    };\n    \n    processedSubscriptions.push(subscription);\n    \n  } catch (error) {\n    // Log error and create fallback entry\n    processedSubscriptions.push({\n      id: item.json.id || 'unknown',\n      service_name: 'Parse Error',\n      status: 'error',\n      error_message: error.message,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn processedSubscriptions.map(sub => ({ json: sub }));"
          },
          "name": "Parse AI Response",
          "id": "parse_ai_response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1860,
            500
          ]
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.status}}",
                  "operation": "notEqual",
                  "value2": "error"
                }
              ]
            }
          },
          "name": "Check Processing Success",
          "id": "check_success",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            2080,
            500
          ]
        },
        {
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "subscriptions",
            "documentData": {
              "id": "={{$json.id}}",
              "service_name": "={{$json.service_name}}",
              "subscription_type": "={{$json.subscription_type}}",
              "amount": "={{$json.amount}}",
              "currency": "={{$json.currency}}",
              "next_billing_date": "={{$json.next_billing_date}}",
              "status": "={{$json.status}}",
              "cancellation_method": "={{$json.cancellation_method}}",
              "original_email": "={{$json.original_email}}",
              "processed_at": "={{$json.processed_at}}",
              "processing_source": "={{$json.processing_source}}"
            }
          },
          "name": "Save to Firebase",
          "id": "save_firebase",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            2300,
            400
          ],
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          }
        },
        {
          "parameters": {
            "operation": "create",
            "notionId": "your-notion-database-id",
            "properties": {
              "values": [
                {
                  "key": "Service Name",
                  "textValue": "={{$json.service_name}}"
                },
                {
                  "key": "Subscription Type",
                  "selectValue": "={{$json.subscription_type}}"
                },
                {
                  "key": "Amount",
                  "numberValue": "={{$json.amount}}"
                },
                {
                  "key": "Currency",
                  "textValue": "={{$json.currency}}"
                },
                {
                  "key": "Status",
                  "selectValue": "={{$json.status}}"
                },
                {
                  "key": "Next Billing",
                  "dateValue": "={{$json.next_billing_date}}"
                }
              ]
            }
          },
          "name": "Save to Notion",
          "id": "save_notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            2300,
            600
          ],
          "credentials": {
            "notionApi": {
              "id": "USSDM Notion",
              "name": "Notion API"
            }
          }
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "dispute_prompt",
                  "value": "Based on the following subscription information, determine if this subscription is eligible for a dispute or refund request under EU, US, or UK consumer protection laws:\n\nService: {{$json.service_name}}\nStatus: {{$json.status}}\nSubscription Type: {{$json.subscription_type}}\nAmount: {{$json.amount}} {{$json.currency}}\nNext Billing: {{$json.next_billing_date}}\n\nProvide:\n1. Dispute eligibility (YES/NO)\n2. Legal basis (if applicable)\n3. Recommended action\n4. Draft dispute email template"
                }
              ]
            }
          },
          "name": "Prepare Dispute Analysis",
          "id": "prepare_dispute",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            2520,
            500
          ]
        },
        {
          "parameters": {
            "model": "claude-3-7-sonnet-20250219",
            "options": {},
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.dispute_prompt}}"
                }
              ]
            }
          },
          "name": "Claude - Dispute Analysis",
          "id": "claude_dispute",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            2740,
            500
          ],
          "credentials": {
            "anthropicClaudeApi": {
              "id": "USSDM Claude",
              "name": "Claude API"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Parse dispute analysis and create actionable recommendations\nconst items = $input.all();\nlet disputeAnalysis = [];\n\nfor (const item of items) {\n  try {\n    const analysis = item.json.content || item.json.message?.content || '';\n    \n    // Extract key information from Claude's response\n    const eligibilityMatch = analysis.match(/Dispute eligibility:\\s*(YES|NO)/i);\n    const legalBasisMatch = analysis.match(/Legal basis:\\s*([^\\n]+)/i);\n    const actionMatch = analysis.match(/Recommended action:\\s*([^\\n]+)/i);\n    \n    const dispute = {\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: eligibilityMatch ? eligibilityMatch[1].toUpperCase() === 'YES' : false,\n      legal_basis: legalBasisMatch ? legalBasisMatch[1] : null,\n      recommended_action: actionMatch ? actionMatch[1] : null,\n      full_analysis: analysis,\n      created_at: new Date().toISOString()\n    };\n    \n    disputeAnalysis.push(dispute);\n    \n  } catch (error) {\n    disputeAnalysis.push({\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: false,\n      error: error.message,\n      created_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn disputeAnalysis.map(analysis => ({ json: analysis }));"
          },
          "name": "Process Dispute Analysis",
          "id": "process_dispute",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            2960,
            500
          ]
        },
        {
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json.dispute_eligible}}"
                }
              ]
            }
          },
          "name": "Check Dispute Eligible",
          "id": "check_dispute",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            3180,
            500
          ]
        },
        {
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "dispute_recommendations",
            "documentData": {
              "subscription_id": "={{$json.subscription_id}}",
              "service_name": "={{$json.service_name}}",
              "dispute_eligible": "={{$json.dispute_eligible}}",
              "legal_basis": "={{$json.legal_basis}}",
              "recommended_action": "={{$json.recommended_action}}",
              "full_analysis": "={{$json.full_analysis}}",
              "created_at": "={{$json.created_at}}",
              "status": "pending_user_action"
            }
          },
          "name": "Save Dispute Analysis",
          "id": "save_dispute",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            3400,
            400
          ],
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          }
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "ussdm-error",
            "responseData": "allEntries",
            "options": {}
          },
          "name": "Error Webhook Handler",
          "id": "error_webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            1640,
            800
          ]
        },
        {
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "system_logs",
            "documentData": {
              "level": "error",
              "message": "={{$json.error_message}}",
              "stack_trace": "={{$json.stack_trace}}",
              "node_id": "={{$json.node_id}}",
              "workflow_id": "={{$json.workflow_id}}",
              "timestamp": "={{$now}}"
            }
          },
          "name": "Log Error to Firebase",
          "id": "log_error",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            1860,
            800
          ],
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          }
        },
        {
          "parameters": {
            "path": "ussdm-status",
            "responseData": "allEntries",
            "options": {}
          },
          "name": "Status Check Webhook",
          "id": "status_webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            120,
            700
          ]
        },
        {
          "parameters": {
            "jsCode": "// Generate system status report\nconst systemStatus = {\n  status: 'healthy',\n  last_sync: new Date().toISOString(),\n  version: '1.0.0',\n  modules: {\n    email_aggregation: 'active',\n    subscription_detection: 'active',\n    dispute_analysis: 'active',\n    storage: 'active'\n  },\n  health_checks: {\n    api_connectivity: 'ok',\n    storage_accessible: 'ok',\n    ai_services: 'ok'\n  }\n};\n\nreturn [{ json: systemStatus }];"
          },
          "name": "Generate Status Report",
          "id": "status_report",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            340,
            700
          ]
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseData": "={{$json}}"
          },
          "name": "Return Status",
          "id": "return_status",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            560,
            700
          ]
        }
      ],
      "connections": {
        "Main Webhook Trigger": {
          "main": [
            [
              {
                "node": "Set Sync Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Daily Sync Schedule": {
          "main": [
            [
              {
                "node": "Set Sync Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Sync Operation": {
          "main": [
            [
              {
                "node": "Route by Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route by Operation": {
          "main": [
            [
              {
                "node": "Gmail - Fetch Subscription Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gmail - Fetch Subscription Emails": {
          "main": [
            [
              {
                "node": "Merge Email Data",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge Email Data": {
          "main": [
            [
              {
                "node": "Pre-Process Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Pre-Process Emails": {
          "main": [
            [
              {
                "node": "Prepare AI Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare AI Prompt": {
          "main": [
            [
              {
                "node": "Claude - Subscription Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude - Subscription Analysis": {
          "main": [
            [
              {
                "node": "Parse AI Response",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "OpenAI - Fallback Parser",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI - Fallback Parser": {
          "main": [
            [
              {
                "node": "Parse AI Response",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse AI Response": {
          "main": [
            [
              {
                "node": "Check Processing Success",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Processing Success": {
          "main": [
            [
              {
                "node": "Save to Firebase",
                "type": "main",
                "index": 0
              },
              {
                "node": "Save to Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Firebase": {
          "main": [
            [
              {
                "node": "Prepare Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Notion": {
          "main": [
            [
              {
                "node": "Prepare Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare Dispute Analysis": {
          "main": [
            [
              {
                "node": "Claude - Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude - Dispute Analysis": {
          "main": [
            [
              {
                "node": "Process Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Dispute Analysis": {
          "main": [
            [
              {
                "node": "Check Dispute Eligible",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Dispute Eligible": {
          "main": [
            [
              {
                "node": "Save Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Error Webhook Handler": {
          "main": [
            [
              {
                "node": "Log Error to Firebase",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Status Check Webhook": {
          "main": [
            [
              {
                "node": "Generate Status Report",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Status Report": {
          "main": [
            [
              {
                "node": "Return Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "8f51d687-fa3b-4d4e-8aff-e282271e81d2",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:56.636Z",
          "createdAt": "2025-11-01T14:36:56.636Z",
          "role": "workflow:owner",
          "workflowId": "DICRRY9ikXX44Vql",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:11Z",
      "createdAt": "2025-11-01T14:40:23.544Z",
      "id": "DTy4S30lwIe6t4oa",
      "name": "orchestrator-demo",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {
            "path": "demo",
            "responseMode": "lastNode",
            "options": {}
          },
          "id": "fe805abd-c8d9-4ce1-aa1d-e8fed8df556d"
        },
        {
          "name": "Set",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "ok",
                  "value": "true"
                }
              ]
            },
            "options": {}
          },
          "id": "f34d8977-ad5e-4d8a-a8d0-a1fdd84cd8d8"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Set",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "5e073cfb-535b-4d31-a8b0-501d9679d6c3",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:23.546Z",
          "createdAt": "2025-11-01T14:40:23.546Z",
          "role": "workflow:owner",
          "workflowId": "DTy4S30lwIe6t4oa",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-11T17:29:05Z",
      "createdAt": "2025-11-01T14:40:21.824Z",
      "id": "DefjL1Nd7ykTSjuu",
      "name": "My workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "url": "https://rss.app/feeds/v1.1/_457R0dF6WskCgWEX.json",
            "jsonParameters": true,
            "options": {}
          },
          "name": "RSS Feed",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "position": [
            -880,
            608
          ],
          "notesInFlow": true,
          "executeOnce": true,
          "retryOnFail": true,
          "alwaysOutputData": true,
          "id": "27f75131-42d0-4d50-9f5e-380e024c8656"
        },
        {
          "parameters": {
            "options": {},
            "requestOptions": {}
          },
          "name": "LinkedIn Post Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -656,
            400
          ],
          "id": "1312c4a2-8708-4ea6-a2e4-8925c5910d5b",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "options": {},
            "requestOptions": {}
          },
          "name": "Blog Post Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -656,
            800
          ],
          "id": "f481a47d-0894-406b-96a6-73f845235ed3",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "options": {},
            "requestOptions": {}
          },
          "name": "Instagram Caption Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -656,
            608
          ],
          "id": "971176c1-359e-4076-a576-415aa5de1d93",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {},
          "name": "When clicking ‘Test workflow’",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            -1104,
            608
          ],
          "id": "5d0d06f7-1568-4c34-9448-957cec3be80d"
        },
        {
          "parameters": {
            "modelId": {
              "__rl": true,
              "value": "gpt-3.5-turbo",
              "mode": "list",
              "cachedResultName": "GPT-3.5-TURBO"
            },
            "messages": {
              "values": [
                {
                  "content": "=",
                  "role": "=user"
                },
                {
                  "content": "=describe image prompt {{ $json.text }}",
                  "role": "system"
                }
              ]
            },
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            -448,
            400
          ],
          "id": "9c58eed2-c3e4-49ee-ad76-51c777cde6d5",
          "name": "Message a model",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "resource": "image",
            "prompt": "=create an image {{ $json.message.content }}",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            -96,
            400
          ],
          "id": "2fb9bb34-f76e-4287-956c-9a64eeb5b88d",
          "name": "Generate an image",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        }
      ],
      "connections": {
        "RSS Feed": {
          "main": [
            [
              {
                "node": "LinkedIn Post Generator",
                "type": "main",
                "index": 0
              },
              {
                "node": "Blog Post Generator",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram Caption Generator",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LinkedIn Post Generator": {
          "main": [
            [
              {
                "node": "Message a model",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "When clicking ‘Test workflow’": {
          "main": [
            [
              {
                "node": "RSS Feed",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Message a model": {
          "main": [
            [
              {
                "node": "Generate an image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {},
      "versionId": "3f5afb41-fd18-4fa2-aae3-1d779305634e",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:21.826Z",
          "createdAt": "2025-11-01T14:40:21.826Z",
          "role": "workflow:owner",
          "workflowId": "DefjL1Nd7ykTSjuu",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:14Z",
      "createdAt": "2025-11-02T02:39:01.071Z",
      "id": "DjuOtKjEmwxCzzdo",
      "name": "Printify mock up creation",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Set Product Data",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.2,
          "position": [
            -1680,
            840
          ],
          "parameters": {
            "options": {}
          },
          "id": "75c991a3-a4e3-48e2-b8f7-62a2280dbb91"
        },
        {
          "name": "Check Design Type",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2,
          "position": [
            -1460,
            840
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.design_type }}",
                  "operation": "equal",
                  "value2": "text_only"
                }
              ]
            },
            "options": {}
          },
          "id": "2e3e3bdb-ddb0-43e4-97ac-9c55862178bd"
        },
        {
          "name": "Create Text Design - Bannerbear",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -1240,
            740
          ],
          "parameters": {
            "url": "https://api.bannerbear.com/v2/images",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "bannerbearApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer bb_pr_e216c66b51eaf20b66f15b4068b40d"
                }
              ]
            },
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "template",
                  "value": "=YOUR_TEMPLATE_ID"
                },
                {
                  "name": "modifications",
                  "value": "=[{\"name\": \"text\", \"text\": \"{{ $json.tagline }}\"}]"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "bannerbearApi": {
              "id": "i6xheiuPlb0lFWDo",
              "name": "Bannerbear account"
            }
          },
          "id": "0eaafdf5-c6b2-454c-81fd-cab3d925a27b"
        },
        {
          "name": "Extract Text Design URL",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.2,
          "position": [
            -1020,
            740
          ],
          "parameters": {
            "options": {}
          },
          "id": "4c4d8f6e-dd8b-4825-af79-8bd57114b0fd"
        },
        {
          "name": "Generate Image - OpenAI",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1,
          "position": [
            -1240,
            940
          ],
          "parameters": {
            "modelId": {
              "__rl": true,
              "value": "gpt-4",
              "mode": "list",
              "cachedResultName": "GPT-4"
            },
            "messages": {
              "values": [
                {
                  "content": "=Create a high-resolution design image suitable for printing on a product, with a transparent background.\n\nProduct Details:\n- Name: {{ $json[\"name\"] }}\n- Description: {{ $json[\"description\"] }}\n- Tagline or Main Text: {{ $json[\"tagline\"] }}\n- Design Style: {{ $json[\"design_style\"] }}\n- Target Audience: {{ $json[\"target_audience\"] }}\n\nInstructions:\n- The image must NOT show any product or object, only the design artwork itself.\n- Center the design and ensure it is properly aligned for printing.\n- Use a transparent background.\n- Ensure the design is clear, clean, and suitable for use on print-on-demand products like t-shirts or mugs.\n- Style should be consistent with {{ $json[\"design_style\"] }} and appeal to {{ $json[\"target_audience\"] }}.\n- Emphasize legibility of any text if included.\n"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "49e10627-fcd6-494b-8a0c-e3b91936891b"
        },
        {
          "name": "Download Generated Image",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -1020,
            940
          ],
          "parameters": {
            "url": "={{ $json.data[0].url }}",
            "options": {
              "response": {
                "response": {
                  "neverError": true,
                  "responseFormat": "file"
                }
              }
            }
          },
          "id": "f0989c89-04df-412a-89f0-677a63434a4a"
        },
        {
          "name": "Remove Background",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -800,
            940
          ],
          "parameters": {
            "url": "https://api.remove.bg/v1.0/removebg",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "X-Api-Key",
                  "value": "YOUR_REMOVEBG_API_KEY"
                }
              ]
            },
            "sendBody": true,
            "contentType": "multipart-form-data",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "image_file",
                  "value": "={{ $binary.data }}"
                },
                {
                  "name": "size",
                  "value": "auto"
                }
              ]
            },
            "options": {
              "response": {
                "response": {
                  "neverError": true,
                  "responseFormat": "file"
                }
              }
            }
          },
          "id": "d5568744-5ca1-4bcd-a7b4-bb08fd3adaeb"
        },
        {
          "name": "Upload to Cloudinary",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -580,
            940
          ],
          "parameters": {
            "url": "https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/image/upload",
            "sendBody": true,
            "contentType": "multipart-form-data",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file",
                  "value": "={{ $binary.data }}"
                },
                {
                  "name": "upload_preset",
                  "value": "YOUR_UPLOAD_PRESET"
                },
                {
                  "name": "api_key",
                  "value": "YOUR_CLOUDINARY_API_KEY"
                }
              ]
            },
            "options": {}
          },
          "id": "fa3be8ed-c21a-4f8c-9b1f-08bdc22600a2"
        },
        {
          "name": "Extract Image Design URL",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.2,
          "position": [
            -360,
            940
          ],
          "parameters": {
            "options": {}
          },
          "id": "dfca61c5-f28c-445a-b067-068a380fa460"
        },
        {
          "name": "Merge Design Paths",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2.1,
          "position": [
            -800,
            840
          ],
          "parameters": {
            "mode": "mergeByPosition",
            "options": {}
          },
          "id": "055d8451-6955-4d92-818f-dc0b001acf00"
        },
        {
          "name": "Create Printify Product",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -580,
            840
          ],
          "parameters": {
            "url": "https://api.printify.com/v1/shops/YOUR_SHOP_ID/products.json",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "printifyApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer YOUR_PRINTIFY_API_KEY"
                },
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "title",
                  "value": "={{ $('Set Product Data').item.json.name }}"
                },
                {
                  "name": "description",
                  "value": "={{ $('Set Product Data').item.json.description }}"
                },
                {
                  "name": "blueprint_id",
                  "value": "384"
                },
                {
                  "name": "print_provider_id",
                  "value": "1"
                },
                {
                  "name": "variants",
                  "value": "=[{\"id\": 45740, \"price\": 1599, \"is_enabled\": true}]"
                },
                {
                  "name": "print_areas",
                  "value": "=[{\"variant_ids\": [45740], \"placeholders\": [{\"position\": {\"area_width\": 1800, \"area_height\": 1800, \"top\": 300, \"left\": 300}, \"images\": [{\"id\": \"front\", \"x\": 0.5, \"y\": 0.5, \"scale\": 1, \"angle\": 0}]}]}]"
                }
              ]
            },
            "options": {}
          },
          "id": "3f2e9827-b6ca-430b-8680-225532b6cfae"
        },
        {
          "name": "Upload Design to Printify",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            -800,
            740
          ],
          "parameters": {
            "url": "https://api.printify.com/v1/uploads/images.json",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "printifyApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer YOUR_PRINTIFY_API_KEY"
                },
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file_name",
                  "value": "design.png"
                },
                {
                  "name": "url",
                  "value": "={{ $json.design_image_url }}"
                }
              ]
            },
            "options": {}
          },
          "id": "657bbbc1-ed30-4ab4-9c2a-3af7ca21dedf"
        },
        {
          "name": "Design Type Check",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2,
          "position": [
            -220,
            120
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict"
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.design_type }}",
                  "rightValue": "text_only",
                  "operator": {
                    "type": "string",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "id": "64065352-3a67-4cda-b5cc-adbd5d80d195"
        },
        {
          "name": "Create Text Design",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "url": "https://api.bannerbear.com/v2/images",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "template",
                  "value": "YOUR_BANNERBEAR_TEMPLATE_ID"
                },
                {
                  "name": "modifications",
                  "value": "=[{\"name\": \"text\", \"text\": \"{{ $json.tagline }}\"}]"
                }
              ]
            },
            "options": {}
          },
          "id": "ff26b2ec-3936-4154-821c-cbaa3e2f3c78"
        },
        {
          "name": "Generate Image Design",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.1,
          "position": [
            0,
            240
          ],
          "parameters": {
            "resource": "image",
            "prompt": "={{ $json.design_prompt }}",
            "options": {}
          },
          "id": "319f3b24-f887-4ad9-bbce-eeaf4491eb2f"
        },
        {
          "name": "Set Product Data1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            -440,
            120
          ],
          "parameters": {
            "options": {}
          },
          "id": "42ef1703-d8ee-46f1-a5fe-a11cc071c031"
        },
        {
          "name": "Extract Text Design URL1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            220,
            0
          ],
          "parameters": {
            "options": {}
          },
          "id": "94e5c11e-00c3-41cd-b27b-2c69c60388ef"
        },
        {
          "name": "Download Generated Image1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            220,
            240
          ],
          "parameters": {
            "url": "={{ $json.data[0].url }}",
            "options": {
              "response": {
                "response": {
                  "responseFormat": "file"
                }
              }
            }
          },
          "id": "b60b5432-509b-4e5b-8262-21ea534820e7"
        },
        {
          "name": "Remove Background1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            440,
            240
          ],
          "parameters": {
            "url": "https://api.remove.bg/v1.0/removebg",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "image_file_b64",
                  "value": "={{ $binary.data.data }}"
                },
                {
                  "name": "size",
                  "value": "auto"
                }
              ]
            },
            "options": {
              "response": {
                "response": {
                  "responseFormat": "file"
                }
              }
            }
          },
          "id": "7e89dc9b-8af9-4460-a291-f7a78d065e9c"
        },
        {
          "name": "Upload to Cloudinary1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            660,
            240
          ],
          "parameters": {
            "url": "https://api.cloudinary.com/v1_1/YOUR_CLOUD_NAME/image/upload",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "file",
                  "value": "data:image/png;base64,{{ $binary.data.data }}"
                },
                {
                  "name": "upload_preset",
                  "value": "YOUR_UPLOAD_PRESET"
                }
              ]
            },
            "options": {}
          },
          "id": "45ed2883-d8ff-4651-b2f0-043672cf3da2"
        },
        {
          "name": "Extract Image Design URL1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            880,
            240
          ],
          "parameters": {
            "options": {}
          },
          "id": "80fa74b4-853a-45a4-8365-a09020b44ecc"
        },
        {
          "name": "Merge Design Paths1",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2.1,
          "position": [
            1100,
            120
          ],
          "parameters": {
            "mode": "combine",
            "combinationMode": "mergeByPosition",
            "options": {}
          },
          "id": "a173adfe-cec5-42cd-a8ee-e726f066f9d0"
        },
        {
          "name": "Create Printify Product1",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            1320,
            120
          ],
          "parameters": {
            "url": "https://api.printify.com/v1/shops/YOUR_SHOP_ID/products.json",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "title",
                  "value": "={{ $('Set Product Data1').first().json.name }}"
                },
                {
                  "name": "description",
                  "value": "={{ $('Set Product Data1').first().json.description }}"
                },
                {
                  "name": "blueprint_id",
                  "value": "384"
                },
                {
                  "name": "print_provider_id",
                  "value": "1"
                },
                {
                  "name": "variants",
                  "value": "=[{\"id\": 17887, \"price\": 1500, \"is_enabled\": true}]"
                },
                {
                  "name": "print_areas",
                  "value": "=[{\"variant_ids\": [17887], \"placeholders\": [{\"position\": \"front\", \"images\": [{\"id\": \"{{ $json.design_url }}\", \"x\": 0.5, \"y\": 0.5, \"scale\": 1, \"angle\": 0}]}]}]"
                }
              ]
            },
            "options": {}
          },
          "id": "5f902d55-488b-48b8-8f2f-a5bda9c72232"
        },
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2,
          "position": [
            80,
            80
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "generate-design-image-printify-mockup",
            "options": {}
          },
          "id": "278fe588-f27d-4b4a-879c-4216764bb005"
        }
      ],
      "connections": {
        "Set Product Data": {
          "main": [
            [
              {
                "node": "Check Design Type",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Design Type": {
          "main": [
            [
              {
                "node": "Create Text Design - Bannerbear",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Generate Image - OpenAI",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Text Design - Bannerbear": {
          "main": [
            [
              {
                "node": "Extract Text Design URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Text Design URL": {
          "main": [
            [
              {
                "node": "Upload Design to Printify",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Image - OpenAI": {
          "main": [
            [
              {
                "node": "Download Generated Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Generated Image": {
          "main": [
            [
              {
                "node": "Remove Background",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Remove Background": {
          "main": [
            [
              {
                "node": "Upload to Cloudinary",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upload to Cloudinary": {
          "main": [
            [
              {
                "node": "Extract Image Design URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Image Design URL": {
          "main": [
            [
              {
                "node": "Merge Design Paths",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Upload Design to Printify": {
          "main": [
            [
              {
                "node": "Merge Design Paths",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge Design Paths": {
          "main": [
            [
              {
                "node": "Create Printify Product",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Design Type Check": {
          "main": [
            [
              {
                "node": "Create Text Design",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Generate Image Design",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Text Design": {
          "main": [
            [
              {
                "node": "Extract Text Design URL1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Image Design": {
          "main": [
            [
              {
                "node": "Download Generated Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Product Data1": {
          "main": [
            [
              {
                "node": "Design Type Check",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Text Design URL1": {
          "main": [
            [
              {
                "node": "Merge Design Paths1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Generated Image1": {
          "main": [
            [
              {
                "node": "Remove Background1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Remove Background1": {
          "main": [
            [
              {
                "node": "Upload to Cloudinary1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upload to Cloudinary1": {
          "main": [
            [
              {
                "node": "Extract Image Design URL1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Image Design URL1": {
          "main": [
            [
              {
                "node": "Merge Design Paths1",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Merge Design Paths1": {
          "main": [
            [
              {
                "node": "Create Printify Product1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "6b33c8cf-5f7a-4448-b36b-28d43738c760",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:39:01.074Z",
          "createdAt": "2025-11-02T02:39:01.074Z",
          "role": "workflow:owner",
          "workflowId": "DjuOtKjEmwxCzzdo",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:05Z",
      "createdAt": "2025-11-01T14:40:31.019Z",
      "id": "Eju4MN9Ku6awRXqI",
      "name": "Morning Autopilot (09:00) (imported 20251101_144031)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Trigger - 09:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 9 * * *"
                }
              ]
            }
          },
          "id": "4e162c91-bba7-49d5-b1e4-39e248f9f8ac"
        },
        {
          "name": "Fetch Notes",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            450,
            300
          ],
          "parameters": {
            "functionCode": "// Fetch OneNote/Notion notes from last 12 hours\nconst notes = [\n  {\n    content: \"TODO: Complete API integration for payment gateway. PRIORITY: High\",\n    timestamp: new Date().toISOString()\n  }\n];\n\nreturn notes.map(note => ({\n  json: note\n}));"
          },
          "id": "b34ecbbb-5484-4483-828b-a37d11ee26a9"
        },
        {
          "name": "Extract Tasks",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "parameters": {
            "functionCode": "// Extract tasks using regex patterns\nconst content = $input.item.json.content;\nconst todoPattern = /TODO:\\s*(.+?)(?=\\.|$)/gi;\nconst priorityPattern = /PRIORITY:\\s*(High|Medium|Low|P[0-3])/i;\n\nconst tasks = [];\nlet match;\n\nwhile ((match = todoPattern.exec(content)) !== null) {\n  const taskText = match[1].trim();\n  const priorityMatch = content.match(priorityPattern);\n  const priority = priorityMatch ? (priorityMatch[1] === 'High' ? 'P0' : priorityMatch[1] === 'Medium' ? 'P1' : 'P2') : 'P2';\n  \n  // Classify type\n  let type = 'message/clarify';\n  if (/(write|create|build|implement|code|develop)/i.test(taskText)) type = 'code';\n  else if (/(research|investigate|explore|find|search)/i.test(taskText)) type = 'info-gather';\n  else if (/(design|plan|architect|blueprint)/i.test(taskText)) type = 'blueprint';\n  else if (/(review|analyze|evaluate)/i.test(taskText)) type = 'review';\n  \n  tasks.push({\n    name: taskText,\n    priority: priority,\n    type: type,\n    uuid: require('crypto').randomUUID(),\n    status: 'New',\n    extracted_at: new Date().toISOString()\n  });\n}\n\nreturn tasks.map(task => ({ json: task }));"
          },
          "id": "36196d75-5e13-4886-ae1c-c1b58a03d5a6"
        },
        {
          "name": "Create Notion Task",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "parameters": {
            "operation": "create",
            "base": "{{$env.NOTION_DATABASE_ID_TASKS}}",
            "properties": {
              "Name": "={{$json.name}}",
              "Priority": "={{$json.priority}}",
              "Type": "={{$json.type}}",
              "Status": "New",
              "UUID": "={{$json.uuid}}"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "7b118436-3e70-4edf-af42-9109839d47e5"
        },
        {
          "name": "Route to LLM",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ],
          "parameters": {
            "functionCode": "// Route to appropriate LLM based on task type\nconst task = $input.item.json;\nlet provider = 'ms_todo';\n\nswitch(task.type) {\n  case 'code':\n    provider = 'openai';\n    break;\n  case 'blueprint':\n  case 'reasoning':\n  case 'review':\n    provider = 'claude';\n    break;\n  case 'info-gather':\n    provider = 'perplexity';\n    break;\n  default:\n    provider = 'ms_todo';\n}\n\nreturn [{\n  json: {\n    ...task,\n    target_platform: provider\n  }\n}];"
          },
          "id": "da27f8db-4a4d-4606-b1b8-79370d86d0cb"
        },
        {
          "name": "If OpenAI",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            200
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "openai"
                }
              ]
            }
          },
          "id": "bd7b180b-b312-4d0a-96c8-a93005317a3b"
        },
        {
          "name": "If Claude",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            400
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "claude"
                }
              ]
            }
          },
          "id": "137dbf8c-ca62-40fb-967c-e4240677e130"
        },
        {
          "name": "OpenAI GPT-4o",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1,
          "position": [
            1450,
            150
          ],
          "parameters": {
            "model": "gpt-4o",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "2",
              "name": "OpenAI"
            }
          },
          "id": "ffae685f-535d-4dcf-b581-75e310e4ecae"
        },
        {
          "name": "Claude Sonnet",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1,
          "position": [
            1450,
            400
          ],
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "credentials": {
            "anthropicApi": {
              "id": "3",
              "name": "Anthropic"
            }
          },
          "id": "ba4a5a6d-c5b2-4fb0-86c2-ca622d8bab55"
        }
      ],
      "connections": {
        "Schedule Trigger - 09:00": {
          "main": [
            [
              {
                "node": "Fetch Notes",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Fetch Notes": {
          "main": [
            [
              {
                "node": "Extract Tasks",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Tasks": {
          "main": [
            [
              {
                "node": "Create Notion Task",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Notion Task": {
          "main": [
            [
              {
                "node": "Route to LLM",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route to LLM": {
          "main": [
            [
              {
                "node": "If OpenAI",
                "type": "main",
                "index": 0
              },
              {
                "node": "If Claude",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If OpenAI": {
          "main": [
            [
              {
                "node": "OpenAI GPT-4o",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If Claude": {
          "main": [
            [
              {
                "node": "Claude Sonnet",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 09:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "60395aea-ff59-4dfd-825a-de3ec8e0369f",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:31.021Z",
          "createdAt": "2025-11-01T14:40:31.021Z",
          "role": "workflow:owner",
          "workflowId": "Eju4MN9Ku6awRXqI",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-26T06:35:29Z",
      "createdAt": "2025-10-26T02:59:44.603Z",
      "id": "FhWaYiQ9YWOSL9CU",
      "name": "Story Development Pipeline v2",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "story-request",
            "responseMode": "responseNode",
            "options": {}
          },
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1.1,
          "position": [
            240,
            304
          ],
          "webhookId": "story-development",
          "id": "dc52e4d8-c9de-464f-8279-182fe1f38a67"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "=https://api.notion.com/v1/databases/{{ $env.NOTION_CHARACTERS_DB }}/query",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "notionApi",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"filter\": {\n    \"property\": \"Series\",\n    \"select\": {\n      \"equals\": \"{{ $json.seriesId }}\"\n    }\n  }\n}",
            "options": {}
          },
          "name": "Get Characters",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            464,
            304
          ],
          "id": "233d6903-ab6c-4b24-aeef-987529eb9c51",
          "credentials": {
            "notionApi": {
              "id": "f5tTT8IA2z8CgeZk",
              "name": "Novel Studio Notion"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.openai.com/v1/chat/completions",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "openAiApi",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"gpt-4-turbo-preview\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are the Story Development Agent for {{ $json.seriesName || 'this novel series' }}. Generate engaging narrative content that maintains character voices and series consistency.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Task: {{ $json.taskDescription }}\\n\\nContext:\\nCharacters: {{ JSON.stringify($json.characters) }}\\nSeries: {{ $json.seriesId }}\\n\\nGenerate the story continuation.\"\n    }\n  ],\n  \"temperature\": 0.7\n}",
            "options": {}
          },
          "name": "Generate Story (OpenAI)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            688,
            304
          ],
          "id": "126266bf-846f-4b13-9676-3e38c2f93eeb",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 4096,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Review and enhance this story segment for consistency, humor style, and character voice. Return only the improved story text.\\n\\nOriginal:\\n{{ $json.choices[0].message.content }}\"\n    }\n  ]\n}",
            "options": {}
          },
          "name": "Polish Story (Claude)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            912,
            304
          ],
          "id": "dce14101-d981-4e85-a7a9-aee2f915f646",
          "credentials": {
            "anthropicApi": {
              "id": "axbkvdbs5MYrzHjE",
              "name": "Novel Studio Claude"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Extract the polished story content\nconst polishedContent = $input.item.json.content[0].text;\nconst originalRequest = $input.first().json;\n\nreturn {\n  json: {\n    seriesId: originalRequest.seriesId,\n    chapterId: originalRequest.chapterId || 'new',\n    taskDescription: originalRequest.taskDescription,\n    generatedStory: polishedContent,\n    timestamp: new Date().toISOString(),\n    wordCount: polishedContent.split(/\\s+/).length\n  }\n};"
          },
          "name": "Format Response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1120,
            304
          ],
          "id": "83d3a138-03a6-41ae-a287-aebfc2b0d8eb"
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ $json }}",
            "options": {}
          },
          "name": "Respond",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1344,
            304
          ],
          "id": "82c92138-afa1-426c-9189-1ac6d99b21f9"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Get Characters",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Characters": {
          "main": [
            [
              {
                "node": "Generate Story (OpenAI)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Story (OpenAI)": {
          "main": [
            [
              {
                "node": "Polish Story (Claude)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Polish Story (Claude)": {
          "main": [
            [
              {
                "node": "Format Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Response": {
          "main": [
            [
              {
                "node": "Respond",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": {},
      "versionId": "5ea4f225-2289-4c16-a11d-8424639ded44",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-26T02:59:44.607Z",
          "createdAt": "2025-10-26T02:59:44.607Z",
          "role": "workflow:owner",
          "workflowId": "FhWaYiQ9YWOSL9CU",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:29.078Z",
      "createdAt": "2025-11-01T14:40:29.078Z",
      "id": "GxuxnN62Sm2mPzwr",
      "name": "Workshop Technical Agent",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Workshop Technical Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -160,
            -140
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Workshop Technical Agent, providing expert support for workshop equipment, crafting techniques, safety protocols, and tool maintenance. You ensure our artisans have the knowledge and resources needed to create exceptional handcrafted gadgets.\n\n## Tools Available\n\n### GitHub Technique Library\n- Access technique guides\n- Review crafting methods\n- Track safety protocols\n- Manage tool documentation\n\n### Equipment Monitoring\n- Tool status checks\n- Maintenance schedules\n- Calibration tracking\n- Performance monitoring\n\n### Documentation Generator\n- Create technique guides\n- Generate safety cards\n- Build training materials\n- Update SOPs\n\n### Jira Maintenance Tickets\n- Track equipment issues\n- Schedule repairs\n- Tool replacement requests\n- Safety incident reports\n\n### Slack Workshop Channel\n- Real-time technical support\n- Safety alerts\n- Technique discussions\n\n## Technical Capabilities\n\n### Core Workshop Areas\n- Metalworking Station\n- Leathercraft Bench\n- Electronics Lab\n- Finishing Room\n- Assembly Area\n\n### Equipment & Tools\n- Laser Engraver\n- CNC Router\n- 3D Printer (for prototypes)\n- Soldering Stations\n- Patina Equipment\n\n### Crafting Techniques\n- Metal Forming & Shaping\n- Brass Aging Processes\n- Leather Wrapping Methods\n- Gear Assembly Techniques\n- LED Integration\n\n### Safety Protocols\n- Chemical Handling (patinas)\n- Tool Operation Guidelines\n- Personal Protective Equipment\n- Emergency Procedures\n\n## Support Areas\n\n### Equipment Maintenance\n- Preventive maintenance schedules\n- Troubleshooting guides\n- Calibration procedures\n- Replacement part sourcing\n\n### Technique Training\n- New artisan onboarding\n- Advanced technique workshops\n- Quality standards training\n- Safety certification\n\n### Process Optimization\n- Workflow improvements\n- Tool selection guidance\n- Efficiency recommendations\n- Quality control methods\n\n### Documentation\n- Standard Operating Procedures\n- Safety Data Sheets\n- Technique video guides\n- Troubleshooting manuals\n\nAlways prioritize safety and craftsmanship quality in all technical guidance.\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "7dbf5ba2-a72e-40f5-9b4e-6fa53d0bc7c8"
        },
        {
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            -360,
            80
          ],
          "parameters": {
            "model": "gpt-4o",
            "options": {}
          },
          "id": "bdb9c244-55a4-472f-8a21-29b64d319c0e"
        },
        {
          "name": "Equipment Status Check",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -240,
            80
          ],
          "parameters": {
            "toolDescription": "Check equipment status and diagnostics",
            "method": "={{ $fromAI(\"httpMethod\", \"GET\") }}",
            "url": "https://api.retrofuturegadgetry.com/v2/workshop/{{ $fromAI(\"endpoint\") }}",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": "={{ $fromAI(\"sendBody\", false) }}",
            "specifyBody": "json",
            "parametersBody": {
              "values": [
                {}
              ]
            },
            "jsonBody": "={{ $fromAI(\"requestBody\", {}) }}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "endpoint",
                  "description": "Equipment endpoint path",
                  "type": "string"
                },
                {
                  "name": "equipmentId",
                  "description": "Specific equipment ID",
                  "type": "string"
                },
                {
                  "name": "checkType",
                  "description": "Type of diagnostic check",
                  "type": "string"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "08a16667-6a03-41ce-900e-ad8527020415"
        },
        {
          "name": "Create Maintenance Ticket",
          "type": "n8n-nodes-base.jiraTool",
          "typeVersion": 1.1,
          "position": [
            -580,
            460
          ],
          "parameters": {},
          "credentials": {},
          "id": "33a40790-5950-4db0-80d5-9a732b8d55f2"
        },
        {
          "name": "Store Technique Guide",
          "type": "n8n-nodes-base.mongoDbTool",
          "typeVersion": 1.1,
          "position": [
            -120,
            80
          ],
          "parameters": {
            "operation": "create",
            "collection": "workshop-docs"
          },
          "id": "f54c103b-1cc6-4288-83af-92ecc2973b01"
        },
        {
          "name": "Generate Safety Protocol",
          "type": "@n8n/n8n-nodes-langchain.toolCode",
          "typeVersion": 1,
          "position": [
            0,
            80
          ],
          "parameters": {},
          "id": "6201455d-3c8e-45cb-9d7e-9d6029952d74"
        },
        {
          "name": "Workshop Support Channel",
          "type": "n8n-nodes-base.slackTool",
          "typeVersion": 1.4,
          "position": [
            -580,
            700
          ],
          "parameters": {},
          "credentials": {},
          "id": "029a820b-783c-4903-b550-eaf565fb6916"
        },
        {
          "name": "Send Technical Guide",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            120,
            80
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"artisanEmail\") }}",
            "subject": "RetroFuture Workshop Technical Guide",
            "message": "={{ $fromAI(\"technicalGuideContent\") }}",
            "options": {}
          },
          "id": "f9857680-3637-472f-a74b-c6730c066608"
        },
        {
          "name": "Log Maintenance",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            240,
            80
          ],
          "parameters": {
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "69ee5e14-64cd-47fd-b97d-8c268229fe5d"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            440,
            -240
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "cd0f2f21-65b0-4c91-b99d-858ad5f49965"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            440,
            -40
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process workshop technical request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "7421f32e-e78d-4571-a1d6-39bb7a687a9d"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -580,
            -140
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "b4a7aa2a-ba38-4d6b-bf6d-c4ffa84c2f02"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Equipment Status Check": {
          "ai_tool": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Store Technique Guide": {
          "ai_tool": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Generate Safety Protocol": {
          "ai_tool": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Technical Guide": {
          "ai_tool": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Log Maintenance": {
          "ai_tool": [
            [
              {
                "node": "Workshop Technical Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Workshop Technical Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "f040a036-294c-4886-b846-6854417d3d00",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:29.08Z",
          "createdAt": "2025-11-01T14:40:29.08Z",
          "role": "workflow:owner",
          "workflowId": "GxuxnN62Sm2mPzwr",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-24T20:59:46Z",
      "createdAt": "2025-11-01T14:40:27.517Z",
      "id": "HiyrH71t7gBi2d0W",
      "name": "Master Assistant Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Master Assistant, coordinating all operational activities for a creative workshop that handcrafts limited-edition retro-futuristic gadgets. Your role is to intelligently route queries to the appropriate specialized agent based on the request type.\n\n## Available Agents\n\n### artisanProductionAgent\nUse for:\n- Production scheduling and planning\n- Artisan assignments\n- Workshop coordination\n- Quality control processes\n- Crafting technique queries\n\n### customerExperienceAgent\nUse for:\n- Customer inquiries and support\n- Order status updates\n- Customization consultations\n- Product care instructions\n- Return and warranty issues\n\n### customOrdersAgent\nUse for:\n- New custom order creation\n- Personalization options\n- Design specifications\n- Order modifications\n- Pricing and quotes\n\n### supplyChainAgent\nUse for:\n- Component availability\n- Supplier information\n- Inventory levels\n- Material sourcing\n- Rare part procurement\n\n### workshopTechnicalAgent\nUse for:\n- Equipment maintenance\n- Tool specifications\n- Technique documentation\n- Safety protocols\n- Workshop setup\n\n### salesDesignAgent\nUse for:\n- New design launches\n- Limited edition drops\n- Customer inquiries\n- Partnership opportunities\n- Wholesale requests\n\n### orderAnalyticsAgent\nUse for:\n- Production metrics\n- Sales reporting\n- Customer analytics\n- Inventory analysis\n- Performance dashboards\n\n## Routing Rules\n1. Analyze the query to identify the primary business function\n2. For complex queries spanning multiple areas, break down into sub-tasks\n3. Route to the most appropriate agent(s)\n4. Consolidate responses for the user\n\n## Company Context\nRetroFuture Gadgetry specializes in handcrafted, limited-edition retro-futuristic gadgets with themes spanning steampunk, dieselpunk, atompunk, and art deco aesthetics. Each piece is made-to-order or in small batches with extensive customization options.\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "name": "RetroFuture Master Assistant",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            1200,
            -176
          ],
          "id": "38958c28-592d-4759-bffd-4b9c0cb2f6d4"
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "value": "=gpt-4o",
              "mode": ""
            },
            "options": {}
          },
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            640,
            48
          ],
          "id": "60d438e3-6872-417c-8c86-b737aed4e5ad",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "=",
            "contextWindowLength": 10
          },
          "name": "Conversation Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            800,
            48
          ],
          "id": "609a14a8-9809-4d95-9d50-eb1efa5257d0"
        },
        {
          "parameters": {
            "name": "artisanProductionAgent",
            "description": "Handles all gadget production scheduling, artisan assignments, and workshop operations",
            "workflowId": {
              "__rl": true,
              "value": "artisan-production-workflow-id",
              "mode": "list",
              "cachedResultName": "🔨 Artisan Production Agent"
            }
          },
          "name": "Artisan Production Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            944,
            48
          ],
          "id": "5b13f8a0-0738-47cf-95b9-87ddee3beb53"
        },
        {
          "parameters": {
            "name": "customerExperienceAgent",
            "description": "Manages customer relationships, order updates, and product support",
            "workflowId": {
              "__rl": true,
              "value": "customer-experience-workflow-id",
              "mode": "list",
              "cachedResultName": "💫 Customer Experience Agent"
            }
          },
          "name": "Customer Experience Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1104,
            48
          ],
          "id": "661ed441-f931-4680-a8e1-17c20f8fc13a"
        },
        {
          "parameters": {
            "name": "customOrdersAgent",
            "description": "Creates and manages custom gadget orders with personalization options",
            "workflowId": {
              "__rl": true,
              "value": "custom-orders-workflow-id",
              "mode": "list",
              "cachedResultName": "⚙️ Custom Orders Agent"
            }
          },
          "name": "Custom Orders Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1232,
            48
          ],
          "id": "e6b9bc25-5b5d-4a70-8974-9ddc4a04fff5"
        },
        {
          "parameters": {
            "name": "supplyChainAgent",
            "description": "Manages component inventory, supplier relationships, and material sourcing",
            "workflowId": {
              "__rl": true,
              "value": "supply-chain-workflow-id",
              "mode": "list",
              "cachedResultName": "📦 Supply Chain Agent"
            }
          },
          "name": "Supply Chain Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1344,
            48
          ],
          "id": "2d0efa0c-3d04-4fb6-9eb8-9c15ac8725e6"
        },
        {
          "parameters": {
            "name": "workshopTechnicalAgent",
            "description": "Handles workshop equipment, tools, techniques, and safety protocols",
            "workflowId": {
              "__rl": true,
              "value": "workshop-technical-workflow-id",
              "mode": "list",
              "cachedResultName": "🔧 Workshop Technical Agent"
            }
          },
          "name": "Workshop Technical Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1504,
            48
          ],
          "id": "85f0ad91-b8de-4e9d-908b-911cda16367f"
        },
        {
          "parameters": {
            "name": "salesDesignAgent",
            "description": "Manages new design launches, limited editions, and sales opportunities",
            "workflowId": {
              "__rl": true,
              "value": "sales-design-workflow-id",
              "mode": "list",
              "cachedResultName": "🎨 Sales & Design Agent"
            }
          },
          "name": "Sales Design Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1664,
            48
          ],
          "id": "b42e1480-687a-425a-804e-9395598c15c4"
        },
        {
          "parameters": {
            "name": "orderAnalyticsAgent",
            "description": "Provides detailed analytics on orders, production, and business metrics",
            "workflowId": {
              "__rl": true,
              "value": "order-analytics-workflow-id",
              "mode": "list",
              "cachedResultName": "📊 Order Analytics Agent"
            }
          },
          "name": "Order Analytics Agent",
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2,
          "position": [
            1840,
            48
          ],
          "id": "98f3ca6f-d189-45cb-862d-8508a53f73f4"
        }
      ],
      "connections": {
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Conversation Memory": {
          "ai_memory": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Artisan Production Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Customer Experience Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Custom Orders Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Supply Chain Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Workshop Technical Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Sales Design Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Order Analytics Agent": {
          "ai_tool": [
            [
              {
                "node": "RetroFuture Master Assistant",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {},
      "versionId": "b8cc9568-a567-47b1-8e49-1c5d594f5dee",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:27.519Z",
          "createdAt": "2025-11-01T14:40:27.519Z",
          "role": "workflow:owner",
          "workflowId": "HiyrH71t7gBi2d0W",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:57:26Z",
      "createdAt": "2025-11-01T14:40:32.405Z",
      "id": "ILpiMxhDoYquv9ti",
      "name": "E-commerce Test Workflow (imported 20251101_144032)",
      "active": false,
      "isArchived": true,
      "nodes": [
        {
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "webhook-test",
            "options": {}
          },
          "id": "a7460ccf-1df5-4fcc-b402-4f9152e97564"
        },
        {
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "42437c48-f8d8-4d19-a9aa-52d9447aa26a"
        },
        {
          "name": "Log Order (Sheets Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            240
          ],
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"order_id\": $json.order_id, \"customer_email\": $json.customer_email, \"amount\": $json.amount, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "eb9d1d1f-422c-416b-9ef4-3e84d97b10a3"
        },
        {
          "name": "Create Lead (Salesforce Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            360
          ],
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"lead_data\": { \"name\": $json.customer_name, \"email\": $json.customer_email, \"source\": \"ecommerce_order\" }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "ffb979a8-215a-4b14-b12a-3dd9019c8288"
        },
        {
          "name": "Send Email (Gmail Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ],
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"email_data\": { \"to\": $json.customer_email, \"subject\": \"Order Confirmation\", \"body\": \"Thank you for your order #\" + $json.order_id }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "a62e1742-65e2-4c86-b575-5229e257c1e1"
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Log Order (Sheets Simulation)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Lead (Salesforce Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Log Order (Sheets Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Lead (Salesforce Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "df4cb2a6-cfdb-4897-b516-2299c9bbb16f",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:32.407Z",
          "createdAt": "2025-11-01T14:40:32.407Z",
          "role": "workflow:owner",
          "workflowId": "ILpiMxhDoYquv9ti",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:13Z",
      "createdAt": "2025-11-01T14:40:16.59Z",
      "id": "IkPhR4K61sStrjwK",
      "name": "Balding Pig Content Generator - Enhanced",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Every 6 Hours",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            -1320,
            300
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "hours",
                  "value": 6
                }
              ]
            }
          },
          "id": "020c9bf7-6e7b-46d4-a1d6-d6e92bd156f8"
        },
        {
          "name": "RSS Feed",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            -1120,
            300
          ],
          "parameters": {
            "url": "https://feeds.feedburner.com/entrepreneur/latest",
            "limit": 3,
            "options": {}
          },
          "id": "60d91c60-ca20-4f05-b07e-ee2afec9b4d1"
        },
        {
          "name": "LinkedIn Post Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -920,
            300
          ],
          "parameters": {
            "resource": "chat",
            "operation": "message",
            "model": "gpt-3.5-turbo",
            "messages": {
              "values": [
                {
                  "role": "system",
                  "content": "You are TheBaldingPig content creator. Create engaging LinkedIn posts about hair loss positivity, self-acceptance, and confidence. Focus on turning challenges into strengths."
                },
                {
                  "role": "user",
                  "content": "Create a LinkedIn post based on this article: {{ $json.items[0].title }} - {{ $json.items[0].description }}. Make it about balding/hair loss positivity and include relevant hashtags."
                }
              ]
            },
            "options": {
              "temperature": 0.7,
              "maxTokens": 400
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "b77a8f1e-67d3-4803-84c1-4a5d956bdc78"
        },
        {
          "name": "Midjourney Prompt Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -720,
            300
          ],
          "parameters": {
            "resource": "chat",
            "operation": "message",
            "model": "gpt-3.5-turbo",
            "messages": {
              "values": [
                {
                  "role": "system",
                  "content": "Create detailed Midjourney prompts for positive, uplifting images about balding and hair loss acceptance."
                },
                {
                  "role": "user",
                  "content": "Create a Midjourney prompt based on this LinkedIn post: {{ $('LinkedIn Post Generator').item.json.choices[0].message.content }}. Format: [Subject] [Action] [Setting], professional lighting, realistic style, inspirational mood, 8K quality"
                }
              ]
            },
            "options": {
              "temperature": 0.6,
              "maxTokens": 200
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "bd6e1e58-869e-45c9-ad59-05e7a97aaade"
        },
        {
          "name": "Log to Content Calendar",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4,
          "position": [
            -520,
            200
          ],
          "parameters": {
            "authentication": "oAuth2",
            "operation": "appendOrUpdate",
            "documentId": "1BjHYzT_CONTENT_CALENDAR_ID",
            "sheetName": "Content Calendar",
            "valueInputOption": "USER_ENTERED",
            "values": {
              "A": "={{ formatDateTime(now, 'yyyy-MM-dd HH:mm') }}",
              "B": "={{ $('RSS Feed').item.json.items[0].title }}",
              "C": "={{ $('LinkedIn Post Generator').item.json.choices[0].message.content }}",
              "D": "={{ $('Midjourney Prompt Generator').item.json.choices[0].message.content }}",
              "E": "Generated",
              "F": "={{ $('RSS Feed').item.json.items[0].link }}"
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "Y3FPNtcn83osRFUx",
              "name": "Google Docs account"
            }
          },
          "id": "f204bd62-0b43-46bd-bd06-665304232799"
        },
        {
          "name": "Store in Supabase",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            -520,
            400
          ],
          "parameters": {
            "url": "https://gzrvzdrmmupqkjosrfnd.supabase.co/rest/v1/content_ideas",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "apikey",
                  "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6cnZ6ZHJtbXVwcWtqb3NyZm5kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ3MDYwMzYsImV4cCI6MjA1MDI4MjAzNn0.Pi8A2Sx7zeRhlX3h4jv6lQudcYqwgSNgac_Bvp445ho"
                },
                {
                  "name": "Authorization",
                  "value": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6cnZ6ZHJtbXVwcWtqb3NyZm5kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ3MDYwMzYsImV4cCI6MjA1MDI4MjAzNn0.Pi8A2Sx7zeRhlX3h4jv6lQudcYqwgSNgac_Bvp445ho"
                },
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "bodyContentType": "json",
            "jsonBody": "{\n  \"source_title\": \"{{ $('RSS Feed').item.json.items[0].title }}\",\n  \"source_url\": \"{{ $('RSS Feed').item.json.items[0].link }}\", \n  \"linkedin_post\": \"{{ $('LinkedIn Post Generator').item.json.choices[0].message.content }}\",\n  \"midjourney_prompt\": \"{{ $('Midjourney Prompt Generator').item.json.choices[0].message.content }}\",\n  \"created_at\": \"{{ formatDateTime(now, 'yyyy-MM-dd HH:mm:ss') }}\",\n  \"status\": \"generated\"\n}"
          },
          "id": "15480555-b5f3-4a4d-8bd5-b6a6c112e56d"
        }
      ],
      "connections": {
        "Schedule Every 6 Hours": {
          "main": [
            [
              {
                "node": "RSS Feed",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "RSS Feed": {
          "main": [
            [
              {
                "node": "LinkedIn Post Generator",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LinkedIn Post Generator": {
          "main": [
            [
              {
                "node": "Midjourney Prompt Generator",
                "type": "main",
                "index": 0
              },
              {
                "node": "Log to Content Calendar",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Midjourney Prompt Generator": {
          "main": [
            [
              {
                "node": "Store in Supabase",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Log to Content Calendar": {
          "main": [
            [
              {
                "node": "Store in Supabase",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Every 6 Hours": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "fd30b81f-c238-4e1d-a613-8210d2073c29",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:16.592Z",
          "createdAt": "2025-11-01T14:40:16.592Z",
          "role": "workflow:owner",
          "workflowId": "IkPhR4K61sStrjwK",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:48:07Z",
      "createdAt": "2025-11-01T14:40:25.331Z",
      "id": "JPidV93aXIdb6VyS",
      "name": "multiflow decision process",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -400,
            112
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "ai-analysis",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "dad60ac8-0ae1-4149-9b8a-13da98216584"
        },
        {
          "name": "Set Variables",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3,
          "position": [
            -208,
            112
          ],
          "parameters": {
            "mode": "raw",
            "options": {}
          },
          "id": "ecffb774-d925-48d1-b72c-c67ea7a4a520"
        },
        {
          "name": "Claude Analysis",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            0
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                },
                {
                  "name": "content-type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 4000,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"{{ $('Set Variables').item.json.systemPrompt }}\\n\\nData to analyze:\\n{{ $('Set Variables').item.json.rawData }}\\n\\nUser request:\\n{{ $('Set Variables').item.json.userPrompt }}\"\n    }\n  ]\n}",
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "ArNWrcsTWDaTHbVw",
              "name": "Printify API"
            },
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "df4a85b0-b43a-4892-8b34-d6b32bd254ef"
        },
        {
          "name": "OpenAI Analysis",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            160
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.openai.com/v1/chat/completions",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "openAiApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "content-type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"model\": \"gpt-4-turbo-preview\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"{{ $node['Set Variables'].json.systemPrompt }}\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Data to analyze:\\n{{ $node['Set Variables'].json.rawData }}\\n\\nUser request:\\n{{ $node['Set Variables'].json.userPrompt }}\"\n    }\n  ],\n  \"max_tokens\": 4000,\n  \"temperature\": 0.3\n}",
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "ArNWrcsTWDaTHbVw",
              "name": "Printify API"
            },
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "8269b3ab-f291-47e0-b5a8-034c23ce770a"
        },
        {
          "name": "Gemini Analysis",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            304
          ],
          "parameters": {
            "method": "POST",
            "url": "https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash-latest:generateContent",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "googlePalmApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "content-type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"text\": \"{{ $('Set Variables').item.json.systemPrompt }}\\n\\nData to analyze:\\n{{ $('Set Variables').item.json.rawData }}\\n\\nUser request:\\n{{ $('Set Variables').item.json.userPrompt }}\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.2,\n    \"topP\": 0.9,\n    \"maxOutputTokens\": 2048\n  }\n}\n",
            "options": {}
          },
          "credentials": {
            "googlePalmApi": {
              "id": "FSV0HuM1PUYjB2DN",
              "name": "Google Gemini(PaLM) Api account 2"
            }
          },
          "id": "5c88d154-bdc0-464e-a26b-71bd136506bf"
        },
        {
          "name": "Perplexity Analysis",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            464
          ],
          "parameters": {
            "url": "https://api.perplexity.ai/chat/completions",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "perplexityApi",
            "sendQuery": true,
            "specifyQuery": "=json",
            "queryParameters": {
              "parameters": [
                {}
              ]
            },
            "sendHeaders": true,
            "specifyHeaders": "=json",
            "headerParameters": {
              "parameters": [
                {}
              ]
            },
            "sendBody": true,
            "contentType": "=json",
            "bodyParameters": {
              "parameters": [
                {
                  "name": "="
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "ArNWrcsTWDaTHbVw",
              "name": "Printify API"
            },
            "perplexityApi": {
              "id": "Lm09sOl8QLzWaahj",
              "name": "Perplexity account"
            }
          },
          "id": "fdf04eb4-a9fa-48d8-b08c-fb8fea9b18d0"
        },
        {
          "name": "Orchestrator Agent",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            208,
            208
          ],
          "parameters": {
            "jsCode": "// Check if we have responses from all AI nodes\nlet claudeResponse = \"\";\nlet openaiResponse = \"\";\nlet geminiResponse = \"\";\nlet perplexityResponse = \"\";\n\n// Safely get Claude response\ntry {\n  if ($input.item.json && $input.item.json.content) {\n    claudeResponse = $input.item.json.content[0].text;\n  }\n} catch(e) {\n  claudeResponse = \"Claude analysis pending or failed\";\n}\n\n// For now, set placeholders for other AIs (we'll fix them next)\nopenaiResponse = \"OpenAI not yet configured\";\ngeminiResponse = \"Gemini not yet configured\";\nperplexityResponse = \"Perplexity not yet configured\";\n\n// Create consolidated report\nconst finalReport = {\n  timestamp: new Date().toISOString(),\n  analysis: {\n    claude: claudeResponse,\n    openai: openaiResponse,\n    gemini: geminiResponse,\n    perplexity: perplexityResponse\n  },\n  summary: {\n    status: \"Initial test - Claude connected\",\n    recommendation: claudeResponse.substring(0, 200) + \"...\"\n  }\n};\n\nreturn {\n  json: finalReport\n};"
          },
          "id": "e165fd3b-9ab3-4bed-9788-c1aa417b34d6"
        },
        {
          "name": "Final Synthesis",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            400,
            208
          ],
          "parameters": {
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendQuery": true,
            "specifyQuery": "=keypair",
            "queryParameters": {
              "parameters": [
                {}
              ]
            },
            "sendHeaders": true,
            "specifyHeaders": "=keypair",
            "headerParameters": {
              "parameters": [
                {}
              ]
            },
            "sendBody": true,
            "contentType": "=json",
            "bodyParameters": {
              "parameters": [
                {}
              ]
            },
            "options": {}
          },
          "credentials": {
            "httpHeaderAuth": {
              "id": "ArNWrcsTWDaTHbVw",
              "name": "Printify API"
            },
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "c883beb4-5a20-4b89-b593-6cff0f837067"
        },
        {
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            608,
            208
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ JSON.stringify({\n  finalReport: $node['Final Synthesis'].json.content[0].text,\n  orchestratorAnalysis: $node['Orchestrator Agent'].json,\n  timestamp: new Date().toISOString(),\n  status: 'success'\n}) }}",
            "options": {}
          },
          "id": "8f5c2a26-26fb-450b-bca0-3d1d7d4511aa"
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Set Variables",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Variables": {
          "main": [
            [
              {
                "node": "Claude Analysis",
                "type": "main",
                "index": 0
              },
              {
                "node": "OpenAI Analysis",
                "type": "main",
                "index": 0
              },
              {
                "node": "Gemini Analysis",
                "type": "main",
                "index": 0
              },
              {
                "node": "Perplexity Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude Analysis": {
          "main": [
            [
              {
                "node": "Orchestrator Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Analysis": {
          "main": [
            [
              {
                "node": "Orchestrator Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gemini Analysis": {
          "main": [
            [
              {
                "node": "Orchestrator Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Perplexity Analysis": {
          "main": [
            [
              {
                "node": "Orchestrator Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Orchestrator Agent": {
          "main": [
            [
              {
                "node": "Final Synthesis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Final Synthesis": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "3b1fc623-ae44-4295-8f95-726e5fbab1a7",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:25.333Z",
          "createdAt": "2025-11-01T14:40:25.333Z",
          "role": "workflow:owner",
          "workflowId": "JPidV93aXIdb6VyS",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-12-20T02:01:53Z",
      "createdAt": "2025-11-01T14:37:00.701Z",
      "id": "K2aTUQz1ZWGQRMY9",
      "name": "GitHub Integration Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "github-webhook",
            "options": {}
          },
          "id": "github-webhook",
          "name": "GitHub Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ]
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.headers['x-github-event'] }}",
                  "rightValue": "push",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-push-events",
          "name": "Filter Push Events",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ]
        },
        {
          "parameters": {
            "resource": "repository",
            "operation": "getIssues",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}"
          },
          "id": "get-repo-issues",
          "name": "Get Repository Issues",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            240
          ],
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          }
        },
        {
          "parameters": {
            "resource": "file",
            "operation": "get",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}",
            "filePath": "workflows/"
          },
          "id": "sync-workflows",
          "name": "Sync Workflows",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            360
          ],
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "http://localhost:5678/rest/workflows/import",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ $json }}"
            }
          },
          "id": "import-workflows",
          "name": "Import Workflows to n8n",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ]
        }
      ],
      "connections": {
        "GitHub Webhook": {
          "main": [
            [
              {
                "node": "Filter Push Events",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Push Events": {
          "main": [
            [
              {
                "node": "Get Repository Issues",
                "type": "main",
                "index": 0
              },
              {
                "node": "Sync Workflows",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Repository Issues": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Sync Workflows": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "528cc0ff-840b-488a-a18c-80e92e30f4e0",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:37:00.702Z",
          "createdAt": "2025-11-01T14:37:00.702Z",
          "role": "workflow:owner",
          "workflowId": "K2aTUQz1ZWGQRMY9",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:43Z",
      "createdAt": "2025-11-01T14:40:22.621Z",
      "id": "KAkZdNbe8oL5DPvc",
      "name": "My workflow 16",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 3,
          "position": [
            -200,
            100
          ],
          "parameters": {},
          "id": "485314b2-da78-4d26-bb04-f076a330d4f7"
        },
        {
          "name": "Query PromptControl Database",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            0
          ],
          "parameters": {
            "url": "https://api.airtable.com/v0/{{$credentials.baseId}}/PromptControl",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "airtableApi",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "filterByFormula",
                  "value": "=SEARCH(LOWER(\"{{ $json.description }}\"), LOWER({Description}))"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "airtableApi": {
              "id": "2mQyPvaQmm0hvdXP",
              "name": "Airtable account"
            }
          },
          "id": "b0701341-366b-4609-86b7-345cd87380e9"
        },
        {
          "name": "Query DocumentControl Database",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            0,
            200
          ],
          "parameters": {
            "url": "https://api.airtable.com/v0/{{$credentials.baseId}}/DocumentControl",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "airtableApi",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "filterByFormula",
                  "value": "=SEARCH(LOWER(\"{{ $json.description }}\"), LOWER({Description}))"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "airtableApi": {
              "id": "2mQyPvaQmm0hvdXP",
              "name": "Airtable account"
            }
          },
          "id": "7ecccc02-910d-41d5-8284-52e4929fc386"
        },
        {
          "name": "Merge Query Results",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2,
          "position": [
            200,
            100
          ],
          "parameters": {
            "mode": "combine",
            "combinationMode": "multiplex",
            "options": {}
          },
          "id": "28362db8-13d9-4d2e-b67e-3263165b8901"
        },
        {
          "name": "Check for Existing Matches",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            400,
            100
          ],
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{ $json.promptMatches.records.length > 0 || $json.workflowMatches.records.length > 0 }}",
                  "value2": true
                }
              ]
            }
          },
          "id": "07d4321a-92aa-45c2-8004-406e3bd49b12"
        },
        {
          "name": "Prepare Reuse Options",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            600,
            0
          ],
          "parameters": {
            "jsCode": "const promptMatches = $input.all()[0].json.records || [];\nconst workflowMatches = $input.all()[1].json.records || [];\nreturn {\n  options: {\n    message: \"Existing matches found\",\n    prompts: promptMatches,\n    workflows: workflowMatches,\n    actions: [\"reuse_existing\", \"clone_and_modify\", \"generate_new\"]\n  }\n};"
          },
          "id": "82b3c767-0f9e-469d-942a-112c84a39564"
        },
        {
          "name": "Generate Agent Definition",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            600,
            200
          ],
          "parameters": {
            "model": "gpt-4",
            "options": {
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "84fba0ff-5dd4-4460-8a2c-c697d03025b2"
        },
        {
          "name": "Store Prompt Metadata",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            800,
            200
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.airtable.com/v0/{{$credentials.baseId}}/PromptControl",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "airtableApi",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "records[0].fields.agent_name",
                  "value": "={{ $json.agent_name }}"
                },
                {
                  "name": "records[0].fields.prompt_text",
                  "value": "={{ $json.n8n_workflow_prompt }}"
                },
                {
                  "name": "records[0].fields.version",
                  "value": "1"
                },
                {
                  "name": "records[0].fields.created_at",
                  "value": "={{ new Date().toISOString() }}"
                }
              ]
            },
            "options": {}
          },
          "id": "13073716-7c35-4824-bb2b-847ea97b5326"
        },
        {
          "name": "Generate Workflow Blueprint",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            1000,
            200
          ],
          "parameters": {
            "model": "claude-3-opus-20240229",
            "options": {},
            "requestOptions": {}
          },
          "id": "1014c493-fb72-473c-8a51-be1491d6161c"
        },
        {
          "name": "Store Workflow Metadata",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            1200,
            200
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.airtable.com/v0/{{$credentials.baseId}}/DocumentControl",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "airtableApi",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "records[0].fields.agent_name",
                  "value": "={{ $('generate-agent-definition').item.json.agent_name }}"
                },
                {
                  "name": "records[0].fields.workflow_json",
                  "value": "={{ JSON.stringify($json) }}"
                },
                {
                  "name": "records[0].fields.version",
                  "value": "1"
                },
                {
                  "name": "records[0].fields.created_at",
                  "value": "={{ new Date().toISOString() }}"
                }
              ]
            },
            "options": {}
          },
          "id": "e43716b6-b039-4020-82c2-c669a8043c9a"
        },
        {
          "name": "Prepare Final Response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1400,
            100
          ],
          "parameters": {
            "jsCode": "const isNewGeneration = $('check-existing-matches').item.json === false;\nconst response = {};\n\nif (isNewGeneration) {\n  response.status = \"new_agent_created\";\n  response.agent_definition = $('generate-agent-definition').item.json;\n  response.workflow_blueprint = $('generate-workflow-blueprint').item.json;\n  response.prompt_record_id = $('store-prompt-metadata').item.json.records[0].id;\n  response.workflow_record_id = $('store-workflow-metadata').item.json.records[0].id;\n} else {\n  response.status = \"existing_matches_found\";\n  response.options = $('prepare-options').item.json;\n}\n\nresponse.next_steps = [\n  \"Deploy workflow to n8n instance\",\n  \"Test with sample data\",\n  \"Configure credentials\",\n  \"Monitor execution\"\n];\n\nreturn response;"
          },
          "id": "555b3c92-8fec-43dd-bfe5-c233e0a96253"
        },
        {
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1600,
            100
          ],
          "parameters": {
            "options": {}
          },
          "id": "c65324b8-a334-4789-959d-69d033b64935"
        }
      ],
      "connections": {},
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "322f19e8-07cd-4a3d-92e8-9ced09a7836b",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:22.623Z",
          "createdAt": "2025-11-01T14:40:22.623Z",
          "role": "workflow:owner",
          "workflowId": "KAkZdNbe8oL5DPvc",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:48:00Z",
      "createdAt": "2025-11-01T14:40:17.436Z",
      "id": "NNvQleVrsPVU8JEh",
      "name": "My workflow 11",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2,
          "position": [
            0,
            0
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "booke-transactions",
            "options": {}
          },
          "id": "fa313447-f748-4866-ae76-4b8d2dbc8074"
        },
        {
          "name": "Code",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            220,
            0
          ],
          "parameters": {
            "jsCode": "// Smart Transaction Categorizer - FIXED VERSION\nconst transactions = $input.all();\n\nreturn transactions.map(transaction => {\n  // Access the actual transaction data from webhook body\n  const data = transaction.json.body || transaction.json;\n  let category = data.category || '';\n  let taxRate = data.taxRate || '';\n  const amount = parseFloat(data.amount) || 0;\n  const payee = (data.payee || '').toLowerCase();\n  const description = (data.description || '').toLowerCase();\n  \n  // Microsoft subscriptions - consistent rules\n  if (payee.includes('microsoft') || description.includes('msft')) {\n    if (amount === 14.39 || amount === 17.22) {\n      category = 'Dues and subscriptions';\n      taxRate = amount === 17.22 ? '9%: Second Reduced - R' : '13.5%: Reduced';\n    }\n  }\n  \n  // Electric Ireland - always utilities with 9% tax\n  if (payee.includes('electric ireland')) {\n    category = 'Utilities';  \n    taxRate = '9%: Second Reduced';\n  }\n  \n  // Large personal payments need categorization\n  if (payee.includes('joseph bermingham') && amount >= 1000) {\n    category = 'Rent or lease payments';\n  }\n  \n  return {\n    json: {\n      ...data,\n      category: category,\n      taxRate: taxRate,\n      processed: true,\n      processingRules: 'Applied smart categorization'\n    }\n  };\n});"
          },
          "id": "ded5ea73-eae6-407d-ad03-5923298f779f"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Code",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "65e27770-5656-4fe8-b897-0bc28bf4481b",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:17.439Z",
          "createdAt": "2025-11-01T14:40:17.439Z",
          "role": "workflow:owner",
          "workflowId": "NNvQleVrsPVU8JEh",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:36:16.384Z",
      "createdAt": "2025-11-01T14:36:16.384Z",
      "id": "NUsDwarrurEdCoMf",
      "name": "GitHub Integration Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "github-webhook",
            "options": {}
          },
          "id": "github-webhook",
          "name": "GitHub Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ]
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.headers['x-github-event'] }}",
                  "rightValue": "push",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-push-events",
          "name": "Filter Push Events",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ]
        },
        {
          "parameters": {
            "resource": "repository",
            "operation": "getIssues",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}"
          },
          "id": "get-repo-issues",
          "name": "Get Repository Issues",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            240
          ],
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          }
        },
        {
          "parameters": {
            "resource": "file",
            "operation": "get",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}",
            "filePath": "workflows/"
          },
          "id": "sync-workflows",
          "name": "Sync Workflows",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            360
          ],
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "http://localhost:5678/rest/workflows/import",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ $json }}"
            }
          },
          "id": "import-workflows",
          "name": "Import Workflows to n8n",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ]
        }
      ],
      "connections": {
        "GitHub Webhook": {
          "main": [
            [
              {
                "node": "Filter Push Events",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Push Events": {
          "main": [
            [
              {
                "node": "Get Repository Issues",
                "type": "main",
                "index": 0
              },
              {
                "node": "Sync Workflows",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Repository Issues": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Sync Workflows": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "a7c40c1d-be20-45d1-ae2e-a8f44411e5ce",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:16.388Z",
          "createdAt": "2025-11-01T14:36:16.388Z",
          "role": "workflow:owner",
          "workflowId": "NUsDwarrurEdCoMf",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:49Z",
      "createdAt": "2025-11-01T14:40:21.446Z",
      "id": "NuQVn4k4L5WsM0pk",
      "name": "My workflow 13",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "When clicking ‘Test workflow’",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {},
          "id": "ccdd92af-2612-4712-a4cc-62fa26af3389"
        },
        {
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            220,
            0
          ],
          "parameters": {
            "method": "POST",
            "url": "https://bermech.app.n8n.cloud/webhook-test/product-generator",
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {
                  "name": "prompt",
                  "value": "Create funny bald-themed coffee mugs"
                },
                {
                  "name": "discord_webhook_url",
                  "value": "https://discord.com/api/webhooks/YOUR_WEBHOOK"
                },
                {
                  "name": "printify_shop_id",
                  "value": "YOUR_SHOP_ID"
                },
                {
                  "name": "printify_blueprint_id",
                  "value": "384"
                },
                {
                  "name": "printify_provider_id",
                  "value": "1"
                }
              ]
            },
            "options": {}
          },
          "id": "fd01885a-4ec0-4286-8d97-d21b2d09980a"
        }
      ],
      "connections": {
        "When clicking ‘Test workflow’": {
          "main": [
            [
              {
                "node": "HTTP Request",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "a4cef070-70f0-45f2-a5fc-83a9e00c43ea",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:21.448Z",
          "createdAt": "2025-11-01T14:40:21.448Z",
          "role": "workflow:owner",
          "workflowId": "NuQVn4k4L5WsM0pk",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:29.948Z",
      "createdAt": "2025-11-01T14:40:29.948Z",
      "id": "OTe3UHEaw0GLEBtw",
      "name": "USSDM - Universal Smart Subscription & Dispute Manager (imported 20251101_144030)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Main Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            120,
            300
          ],
          "parameters": {
            "path": "ussdm-webhook",
            "options": {}
          },
          "id": "9cfe0d0a-72ab-49bc-b2ac-d1a4ce5234c1"
        },
        {
          "name": "Daily Sync Schedule",
          "type": "n8n-nodes-base.schedule",
          "typeVersion": 1,
          "position": [
            120,
            500
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "hours",
                  "value": 24
                }
              ]
            }
          },
          "id": "ecc34f71-126e-4ba6-bfce-01af5b8bc6a3"
        },
        {
          "name": "Set Sync Operation",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            340,
            400
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "operation",
                  "value": "sync_emails"
                },
                {
                  "name": "module",
                  "value": "email_aggregation"
                }
              ]
            },
            "options": {}
          },
          "id": "98e9a45a-29bd-4bf2-a824-f7e5ff1f8288"
        },
        {
          "name": "Route by Operation",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            540,
            400
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.operation}}",
                  "operation": "equal",
                  "value2": "sync_emails"
                }
              ]
            }
          },
          "id": "5bdfce99-277c-4586-bde2-32cae2fde34b"
        },
        {
          "name": "Gmail - Fetch Subscription Emails",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2,
          "position": [
            760,
            300
          ],
          "parameters": {
            "authentication": "oAuth2Api",
            "simple": false,
            "format": "simple",
            "userId": "me",
            "q": "from:*@* subject:(subscription OR billing OR payment OR subscribe OR unsubscribe OR invoice)",
            "maxResults": 50
          },
          "credentials": {
            "gmailOAuth2Api": {
              "id": "USSDM Gmail",
              "name": "Gmail OAuth2 API"
            }
          },
          "id": "e47d69e9-ff53-4b07-8577-52372bc97217"
        },
        {
          "name": "Merge Email Data",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2,
          "position": [
            980,
            400
          ],
          "parameters": {
            "mode": "combine",
            "combinationMode": "mergeByPosition"
          },
          "id": "161ea01b-71d1-45d1-be86-7e36fc979cf2"
        },
        {
          "name": "Pre-Process Emails",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1200,
            400
          ],
          "parameters": {
            "jsCode": "// Process each email for subscription detection\nlet subscriptionEmails = [];\n\nfor (const item of $input.all()) {\n  const email = item.json;\n  \n  // Extract relevant email content\n  const emailData = {\n    id: email.id,\n    subject: email.payload?.headers?.find(h => h.name === 'Subject')?.value || '',\n    from: email.payload?.headers?.find(h => h.name === 'From')?.value || '',\n    date: email.payload?.headers?.find(h => h.name === 'Date')?.value || '',\n    snippet: email.snippet || '',\n    body: email.payload?.parts?.[0]?.body?.data || email.payload?.body?.data || ''\n  };\n  \n  // Extract keywords that indicate subscriptions\n  const subscriptionKeywords = [\n    'subscription', 'billing', 'payment', 'invoice', 'auto-renew',\n    'monthly charge', 'annual subscription', 'premium', 'upgrade',\n    'cancel subscription', 'unsubscribe', 'trial ending'\n  ];\n  \n  const hasSubscriptionKeywords = subscriptionKeywords.some(keyword => \n    emailData.subject.toLowerCase().includes(keyword) ||\n    emailData.snippet.toLowerCase().includes(keyword)\n  );\n  \n  if (hasSubscriptionKeywords) {\n    subscriptionEmails.push({\n      ...emailData,\n      classification: 'potential_subscription',\n      processing_status: 'pending_ai_analysis'\n    });\n  }\n}\n\nreturn subscriptionEmails.map(email => ({ json: email }));"
          },
          "id": "92b5c259-cf39-4044-b6de-397adb3f4950"
        },
        {
          "name": "Prepare AI Prompt",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            1420,
            400
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "prompt",
                  "value": "Analyze the following email content for subscription-related information. Extract:\n1. Service/Company name\n2. Subscription type (monthly/annual/trial)\n3. Amount charged\n4. Currency\n5. Next billing date\n6. Subscription status (active/cancelled/trial)\n7. Cancellation method if available\n\nEmail Content:\nSubject: {{$json.subject}}\nFrom: {{$json.from}}\nSnippet: {{$json.snippet}}\n\nRespond in JSON format with the extracted information."
                }
              ]
            }
          },
          "id": "a97ead07-580f-4a85-8788-a60c51f3b4e2"
        },
        {
          "name": "Claude - Subscription Analysis",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            1640,
            400
          ],
          "parameters": {
            "model": "claude-3-7-sonnet-20250219",
            "options": {},
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.prompt}}"
                }
              ]
            }
          },
          "credentials": {
            "anthropicClaudeApi": {
              "id": "USSDM Claude",
              "name": "Claude API"
            }
          },
          "id": "c1577148-06a9-442a-923a-96d049a52be7"
        },
        {
          "name": "OpenAI - Fallback Parser",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            1640,
            600
          ],
          "parameters": {
            "model": "gpt-4",
            "options": {
              "temperature": 0.1
            },
            "messages": {
              "values": [
                {
                  "role": "system",
                  "content": "You are an expert at parsing emails for subscription information. Extract structured data from subscription-related emails."
                },
                {
                  "role": "user",
                  "content": "={{$json.prompt}}"
                }
              ]
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "USSDM OpenAI",
              "name": "OpenAI API"
            }
          },
          "id": "2a7d6f63-87bb-4e2e-944e-16a886d6c63c"
        },
        {
          "name": "Parse AI Response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1860,
            500
          ],
          "parameters": {
            "jsCode": "// Parse and structure AI response\nconst items = $input.all();\nlet processedSubscriptions = [];\n\nfor (const item of items) {\n  try {\n    let analysisResult;\n    \n    // Try to parse Claude's response\n    if (item.json.content) {\n      analysisResult = JSON.parse(item.json.content);\n    } else if (item.json.message?.content) {\n      analysisResult = JSON.parse(item.json.message.content);\n    } else {\n      throw new Error('No valid content found');\n    }\n    \n    // Structure the subscription data\n    const subscription = {\n      id: item.json.id || 'unknown',\n      service_name: analysisResult.service_name || 'Unknown Service',\n      subscription_type: analysisResult.subscription_type || 'unknown',\n      amount: analysisResult.amount || 0,\n      currency: analysisResult.currency || 'USD',\n      next_billing_date: analysisResult.next_billing_date || null,\n      status: analysisResult.subscription_status || 'unknown',\n      cancellation_method: analysisResult.cancellation_method || null,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString(),\n      processing_source: item.json.content ? 'claude' : 'openai'\n    };\n    \n    processedSubscriptions.push(subscription);\n    \n  } catch (error) {\n    // Log error and create fallback entry\n    processedSubscriptions.push({\n      id: item.json.id || 'unknown',\n      service_name: 'Parse Error',\n      status: 'error',\n      error_message: error.message,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn processedSubscriptions.map(sub => ({ json: sub }));"
          },
          "id": "552b797c-ca25-4ea8-83d8-c6cf78cb6c06"
        },
        {
          "name": "Check Processing Success",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            2080,
            500
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.status}}",
                  "operation": "notEqual",
                  "value2": "error"
                }
              ]
            }
          },
          "id": "a1941f57-306e-4d40-bd2f-b9f50791104e"
        },
        {
          "name": "Save to Firebase",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            2300,
            400
          ],
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "subscriptions",
            "documentData": {
              "id": "={{$json.id}}",
              "service_name": "={{$json.service_name}}",
              "subscription_type": "={{$json.subscription_type}}",
              "amount": "={{$json.amount}}",
              "currency": "={{$json.currency}}",
              "next_billing_date": "={{$json.next_billing_date}}",
              "status": "={{$json.status}}",
              "cancellation_method": "={{$json.cancellation_method}}",
              "original_email": "={{$json.original_email}}",
              "processed_at": "={{$json.processed_at}}",
              "processing_source": "={{$json.processing_source}}"
            }
          },
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          },
          "id": "d5053320-1723-4bb3-af10-da7f007f45b3"
        },
        {
          "name": "Save to Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            2300,
            600
          ],
          "parameters": {
            "operation": "create",
            "notionId": "your-notion-database-id",
            "properties": {
              "values": [
                {
                  "key": "Service Name",
                  "textValue": "={{$json.service_name}}"
                },
                {
                  "key": "Subscription Type",
                  "selectValue": "={{$json.subscription_type}}"
                },
                {
                  "key": "Amount",
                  "numberValue": "={{$json.amount}}"
                },
                {
                  "key": "Currency",
                  "textValue": "={{$json.currency}}"
                },
                {
                  "key": "Status",
                  "selectValue": "={{$json.status}}"
                },
                {
                  "key": "Next Billing",
                  "dateValue": "={{$json.next_billing_date}}"
                }
              ]
            }
          },
          "credentials": {
            "notionApi": {
              "id": "USSDM Notion",
              "name": "Notion API"
            }
          },
          "id": "5c39d68c-ac65-44a0-972c-3a6b2baed343"
        },
        {
          "name": "Prepare Dispute Analysis",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            2520,
            500
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "dispute_prompt",
                  "value": "Based on the following subscription information, determine if this subscription is eligible for a dispute or refund request under EU, US, or UK consumer protection laws:\n\nService: {{$json.service_name}}\nStatus: {{$json.status}}\nSubscription Type: {{$json.subscription_type}}\nAmount: {{$json.amount}} {{$json.currency}}\nNext Billing: {{$json.next_billing_date}}\n\nProvide:\n1. Dispute eligibility (YES/NO)\n2. Legal basis (if applicable)\n3. Recommended action\n4. Draft dispute email template"
                }
              ]
            }
          },
          "id": "65f311ef-8772-47aa-b308-625a558c0711"
        },
        {
          "name": "Claude - Dispute Analysis",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            2740,
            500
          ],
          "parameters": {
            "model": "claude-3-7-sonnet-20250219",
            "options": {},
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.dispute_prompt}}"
                }
              ]
            }
          },
          "credentials": {
            "anthropicClaudeApi": {
              "id": "USSDM Claude",
              "name": "Claude API"
            }
          },
          "id": "531d871f-48e1-4206-9205-2862f8d0d742"
        },
        {
          "name": "Process Dispute Analysis",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            2960,
            500
          ],
          "parameters": {
            "jsCode": "// Parse dispute analysis and create actionable recommendations\nconst items = $input.all();\nlet disputeAnalysis = [];\n\nfor (const item of items) {\n  try {\n    const analysis = item.json.content || item.json.message?.content || '';\n    \n    // Extract key information from Claude's response\n    const eligibilityMatch = analysis.match(/Dispute eligibility:\\s*(YES|NO)/i);\n    const legalBasisMatch = analysis.match(/Legal basis:\\s*([^\\n]+)/i);\n    const actionMatch = analysis.match(/Recommended action:\\s*([^\\n]+)/i);\n    \n    const dispute = {\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: eligibilityMatch ? eligibilityMatch[1].toUpperCase() === 'YES' : false,\n      legal_basis: legalBasisMatch ? legalBasisMatch[1] : null,\n      recommended_action: actionMatch ? actionMatch[1] : null,\n      full_analysis: analysis,\n      created_at: new Date().toISOString()\n    };\n    \n    disputeAnalysis.push(dispute);\n    \n  } catch (error) {\n    disputeAnalysis.push({\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: false,\n      error: error.message,\n      created_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn disputeAnalysis.map(analysis => ({ json: analysis }));"
          },
          "id": "d7769e2d-adef-4cb8-a9a1-eb8a3a10844f"
        },
        {
          "name": "Check Dispute Eligible",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            3180,
            500
          ],
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json.dispute_eligible}}"
                }
              ]
            }
          },
          "id": "f4342009-d8cd-4f34-8c69-ce2e8e38f4d2"
        },
        {
          "name": "Save Dispute Analysis",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            3400,
            400
          ],
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "dispute_recommendations",
            "documentData": {
              "subscription_id": "={{$json.subscription_id}}",
              "service_name": "={{$json.service_name}}",
              "dispute_eligible": "={{$json.dispute_eligible}}",
              "legal_basis": "={{$json.legal_basis}}",
              "recommended_action": "={{$json.recommended_action}}",
              "full_analysis": "={{$json.full_analysis}}",
              "created_at": "={{$json.created_at}}",
              "status": "pending_user_action"
            }
          },
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          },
          "id": "6421a5b3-3c90-4b45-ac24-523785600320"
        },
        {
          "name": "Error Webhook Handler",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            1640,
            800
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "ussdm-error",
            "responseData": "allEntries",
            "options": {}
          },
          "id": "85616fd8-a83c-4594-a8ea-2019870343bc"
        },
        {
          "name": "Log Error to Firebase",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            1860,
            800
          ],
          "parameters": {
            "operation": "create",
            "projectId": "your-firebase-project-id",
            "collection": "system_logs",
            "documentData": {
              "level": "error",
              "message": "={{$json.error_message}}",
              "stack_trace": "={{$json.stack_trace}}",
              "node_id": "={{$json.node_id}}",
              "workflow_id": "={{$json.workflow_id}}",
              "timestamp": "={{$now}}"
            }
          },
          "credentials": {
            "googleFirestoreServiceAccount": {
              "id": "USSDM Firebase",
              "name": "Firebase Service Account"
            }
          },
          "id": "d48f0173-2c26-4c18-8e9e-a5b2873a6ef9"
        },
        {
          "name": "Status Check Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            120,
            700
          ],
          "parameters": {
            "path": "ussdm-status",
            "responseData": "allEntries",
            "options": {}
          },
          "id": "e68bac4a-2e6c-4476-a105-4c80034d25b8"
        },
        {
          "name": "Generate Status Report",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            340,
            700
          ],
          "parameters": {
            "jsCode": "// Generate system status report\nconst systemStatus = {\n  status: 'healthy',\n  last_sync: new Date().toISOString(),\n  version: '1.0.0',\n  modules: {\n    email_aggregation: 'active',\n    subscription_detection: 'active',\n    dispute_analysis: 'active',\n    storage: 'active'\n  },\n  health_checks: {\n    api_connectivity: 'ok',\n    storage_accessible: 'ok',\n    ai_services: 'ok'\n  }\n};\n\nreturn [{ json: systemStatus }];"
          },
          "id": "4a034e25-58a0-4c00-96fc-627980d437d6"
        },
        {
          "name": "Return Status",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            560,
            700
          ],
          "parameters": {
            "respondWith": "json",
            "responseData": "={{$json}}"
          },
          "id": "ce4ee9e7-d0ef-49ef-9f56-4bf4be243c69"
        }
      ],
      "connections": {
        "Main Webhook Trigger": {
          "main": [
            [
              {
                "node": "Set Sync Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Daily Sync Schedule": {
          "main": [
            [
              {
                "node": "Set Sync Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Sync Operation": {
          "main": [
            [
              {
                "node": "Route by Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route by Operation": {
          "main": [
            [
              {
                "node": "Gmail - Fetch Subscription Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gmail - Fetch Subscription Emails": {
          "main": [
            [
              {
                "node": "Merge Email Data",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge Email Data": {
          "main": [
            [
              {
                "node": "Pre-Process Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Pre-Process Emails": {
          "main": [
            [
              {
                "node": "Prepare AI Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare AI Prompt": {
          "main": [
            [
              {
                "node": "Claude - Subscription Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude - Subscription Analysis": {
          "main": [
            [
              {
                "node": "Parse AI Response",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "OpenAI - Fallback Parser",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI - Fallback Parser": {
          "main": [
            [
              {
                "node": "Parse AI Response",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse AI Response": {
          "main": [
            [
              {
                "node": "Check Processing Success",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Processing Success": {
          "main": [
            [
              {
                "node": "Save to Firebase",
                "type": "main",
                "index": 0
              },
              {
                "node": "Save to Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Firebase": {
          "main": [
            [
              {
                "node": "Prepare Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Notion": {
          "main": [
            [
              {
                "node": "Prepare Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare Dispute Analysis": {
          "main": [
            [
              {
                "node": "Claude - Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude - Dispute Analysis": {
          "main": [
            [
              {
                "node": "Process Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ],
          "error": [
            [
              {
                "node": "Error Webhook Handler",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Dispute Analysis": {
          "main": [
            [
              {
                "node": "Check Dispute Eligible",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Dispute Eligible": {
          "main": [
            [
              {
                "node": "Save Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Error Webhook Handler": {
          "main": [
            [
              {
                "node": "Log Error to Firebase",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Status Check Webhook": {
          "main": [
            [
              {
                "node": "Generate Status Report",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Status Report": {
          "main": [
            [
              {
                "node": "Return Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "e4d21c48-aac6-42a3-8950-2315a6343f6b",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:29.95Z",
          "createdAt": "2025-11-01T14:40:29.95Z",
          "role": "workflow:owner",
          "workflowId": "OTe3UHEaw0GLEBtw",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:28.287Z",
      "createdAt": "2025-11-01T14:40:28.287Z",
      "id": "SSux3s2DcoxDAOsn",
      "name": "Sales Design Agent",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Sales Design Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -120,
            -140
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Sales & Design Agent, responsible for managing new design launches, limited edition drops, customer acquisition, and partnership opportunities. You create excitement around our handcrafted gadgets and drive sustainable growth through strategic releases.\n\n## Tools Available\n\n### Shopify Store Management\n- Product launches\n- Inventory tracking\n- Sales analytics\n- Customer data\n\n### Design Launch API\n- Schedule drops\n- Manage waitlists\n- Limited edition tracking\n- Pre-order management\n\n### Mailchimp Marketing\n- Email campaigns\n- Launch announcements\n- Waitlist management\n- Customer segmentation\n\n### Calendly Consultations\n- Design consultations\n- Custom order meetings\n- Partnership discussions\n\n### Instagram Integration\n- Product showcases\n- Behind-the-scenes content\n- Launch teasers\n- Customer features\n\n### Slack Design Team\n- New concept alerts\n- Launch coordination\n- Sales celebrations\n\n## Sales Focus Areas\n\n### Design Categories\n- **Steampunk Collection**\n  - Victorian-inspired pieces\n  - Brass and copper themes\n  - Gear-driven mechanisms\n  \n- **Art Deco Line**\n  - Geometric patterns\n  - Chrome and black finishes\n  - Elegant minimalism\n  \n- **Dieselpunk Series**\n  - Industrial aesthetics\n  - Rugged materials\n  - Military-inspired designs\n  \n- **Atompunk Edition**\n  - Retro-futuristic themes\n  - Atomic age styling\n  - Space-age materials\n\n### Launch Strategies\n\n#### Limited Editions\n- Batch sizes: 10-50 pieces\n- Pre-announcement teasers\n- Waitlist management\n- First-come allocation\n\n#### Surprise Drops\n- Unannounced releases\n- Social media reveals\n- 24-hour availability\n- Exclusive to subscribers\n\n#### Custom Commissions\n- One-of-a-kind pieces\n- Collaborative design process\n- Premium pricing tier\n- 3-6 month timeline\n\n### Target Customers\n- Collectors & enthusiasts\n- Gift buyers (unique/luxury)\n- Corporate clients\n- Interior designers\n- Museum gift shops\n\n### Pricing Strategy\n- Entry pieces: $150-300\n- Signature items: $300-800\n- Limited editions: $500-1500\n- Custom commissions: $1000+\n\n## Partnership Opportunities\n- Boutique retailers\n- Gallery exhibitions\n- Convention vendors\n- Subscription boxes\n- Corporate gifts\n\nMinimum wholesale orders: $2,500\nPartnership commission: 40% margin\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "1ade1553-46eb-4a0c-a2e2-52f7110c92ca"
        },
        {
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            -380,
            60
          ],
          "parameters": {
            "model": "gpt-4o",
            "options": {}
          },
          "id": "6b5f23cf-c91d-45d2-a017-da35de539683"
        },
        {
          "name": "Search Products",
          "type": "n8n-nodes-base.shopifyTool",
          "typeVersion": 1.1,
          "position": [
            -500,
            460
          ],
          "parameters": {},
          "credentials": {},
          "id": "9920b080-dbdd-464d-933b-9650e0025068"
        },
        {
          "name": "Schedule Design Drop",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -220,
            140
          ],
          "parameters": {
            "toolDescription": "Schedule a new design drop",
            "url": "https://api.retrofuturegadgetry.com/v2/launches/schedule",
            "sendQuery": true,
            "parametersQuery": {
              "values": [
                {}
              ]
            },
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "designName",
                  "description": "Name of new design",
                  "type": "string"
                },
                {
                  "name": "launchType",
                  "description": "Type of launch (limited/surprise/regular)",
                  "type": "string"
                },
                {
                  "name": "quantity",
                  "description": "Number of pieces",
                  "type": "number"
                },
                {
                  "name": "launchDate",
                  "description": "Launch date and time",
                  "type": "string"
                },
                {
                  "name": "pricing",
                  "description": "Price point",
                  "type": "number"
                },
                {
                  "name": "waitlistEnabled",
                  "description": "Enable waitlist",
                  "type": "boolean"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "6e89a621-04a4-4c44-a387-159b7a018c1a"
        },
        {
          "name": "Email Campaign",
          "type": "n8n-nodes-base.mailchimpTool",
          "typeVersion": 1.1,
          "position": [
            -500,
            700
          ],
          "parameters": {},
          "credentials": {},
          "id": "0f27ebe0-7d2c-460c-8ad4-ff7f20c694cf"
        },
        {
          "name": "Schedule Consultation",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -20,
            160
          ],
          "parameters": {
            "toolDescription": "Schedule a design consultation",
            "method": "POST",
            "url": "https://api.calendly.com/scheduled_events",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"event_type\": \"{eventType}\",\n  \"invitee\": {\n    \"email\": \"{inviteeEmail}\",\n    \"name\": \"{inviteeName}\"\n  },\n  \"start_time\": \"{startTime}\",\n  \"timezone\": \"{timezone}\",\n  \"location\": \"{location}\",\n  \"questions_and_answers\": {\n    \"design_interest\": \"{designInterest}\",\n    \"budget_range\": \"{budgetRange}\",\n    \"timeline\": \"{timeline}\"\n  }\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "eventType",
                  "description": "Type of consultation",
                  "type": "string"
                },
                {
                  "name": "inviteeEmail",
                  "description": "Customer email",
                  "type": "string"
                },
                {
                  "name": "inviteeName",
                  "description": "Customer name",
                  "type": "string"
                },
                {
                  "name": "startTime",
                  "description": "Consultation start time",
                  "type": "string"
                },
                {
                  "name": "timezone",
                  "description": "Meeting timezone",
                  "type": "string"
                },
                {
                  "name": "location",
                  "description": "Meeting location/link",
                  "type": "string"
                },
                {
                  "name": "designInterest",
                  "description": "Design preferences",
                  "type": "string"
                },
                {
                  "name": "budgetRange",
                  "description": "Customer budget",
                  "type": "string"
                },
                {
                  "name": "timeline",
                  "description": "Desired timeline",
                  "type": "string"
                },
                {
                  "name": "calendlyApiKey",
                  "description": "Calendly API key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "f4380e30-359b-46dd-84f9-05b745ce1ec7"
        },
        {
          "name": "Send Launch Email",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            120,
            120
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"customerEmail\") }}",
            "subject": "{{ $fromAI(\"emailSubject\", \"Exclusive: New RetroFuture Design Launch\") }}",
            "message": "={{ $fromAI(\"emailContent\") }}",
            "options": {}
          },
          "id": "0ecadce4-2525-4c90-bdd4-4290ec95d91c"
        },
        {
          "name": "Generate Catalog",
          "type": "n8n-nodes-base.googleDocsTool",
          "typeVersion": 1.1,
          "position": [
            -500,
            940
          ],
          "parameters": {},
          "credentials": {},
          "id": "f9038798-6343-4c85-b99f-7fd0dd172527"
        },
        {
          "name": "Post Design Teaser",
          "type": "n8n-nodes-base.instagramTool",
          "typeVersion": 1.1,
          "position": [
            -500,
            1180
          ],
          "parameters": {},
          "credentials": {},
          "id": "69e662e0-82be-4ddf-b41f-a769ac0b1d79"
        },
        {
          "name": "Notify Design Team",
          "type": "n8n-nodes-base.slackTool",
          "typeVersion": 1.4,
          "position": [
            -500,
            1440
          ],
          "parameters": {},
          "credentials": {},
          "id": "0b220fe7-a3a0-44bc-b784-76b4b2b52d5a"
        },
        {
          "name": "Update Sales Pipeline",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            260,
            100
          ],
          "parameters": {
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "256090c4-fc96-4ee7-ad69-70fffbd9c3ba"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            400,
            -240
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "79110a7e-601b-4eac-b185-4a683812594d"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            400,
            -40
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process sales design request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "858fb2be-0411-4cc1-a37b-3f5342bd630f"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -500,
            -140
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "c2ce3aed-5c44-4638-b6f9-88b0b128d0ad"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Sales Design Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Sales Design Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Design Drop": {
          "ai_tool": [
            [
              {
                "node": "Sales Design Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Consultation": {
          "ai_tool": [
            [
              {
                "node": "Sales Design Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Launch Email": {
          "ai_tool": [
            [
              {
                "node": "Sales Design Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Update Sales Pipeline": {
          "ai_tool": [
            [
              {
                "node": "Sales Design Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Sales Design Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "13ff32ff-3e10-4db3-b06f-e815a8a29415",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:28.289Z",
          "createdAt": "2025-11-01T14:40:28.289Z",
          "role": "workflow:owner",
          "workflowId": "SSux3s2DcoxDAOsn",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:32Z",
      "createdAt": "2025-11-02T02:38:59.684Z",
      "id": "SvrH9RykExiVClpC",
      "name": "My workflow 6",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -1000,
            100
          ],
          "parameters": {
            "multipleMethods": true,
            "httpMethod": [
              "POST"
            ],
            "path": "/webhook/ussdm-webhook",
            "options": {}
          },
          "id": "ba7278fc-ed85-42ae-a0fd-1ed0ae99afe4"
        },
        {
          "name": "Gmail",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 1,
          "position": [
            -780,
            100
          ],
          "parameters": {
            "resource": "message",
            "operation": "getAll",
            "returnAll": true,
            "additionalFields": {
              "q": "subject:(subscription OR billing OR invoice)"
            }
          },
          "credentials": {
            "gmailOAuth2": {
              "id": "Dpzy2ENM2r7misDH",
              "name": "Gmail account 2"
            }
          },
          "id": "f991a182-0118-475e-90e6-e812b7f8febe"
        },
        {
          "name": "OpenAI",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -560,
            100
          ],
          "parameters": {
            "model": "chatgpt-4o-latest",
            "options": {
              "temperature": 0.1
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "f2d4c1c6-69c5-4d0d-b561-245a8192bfa1"
        },
        {
          "name": "Parse OpenAI Response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 1,
          "position": [
            -340,
            100
          ],
          "parameters": {
            "jsCode": "try {\n  const extractedData = JSON.parse($input.first().json.message.content);\n  return [{\n    json: {\n      serviceName: extractedData.serviceName,\n      subscriptionType: extractedData.subscriptionType,\n      amount: extractedData.amount,\n      currency: extractedData.currency,\n      nextBillingDate: extractedData.nextBillingDate,\n      cancellationMethod: extractedData.cancellationMethod,\n      originalSubject: $input.first().json.subject,\n      extractedAt: new Date().toISOString()\n    }\n  }];\n} catch (error) {\n  return [{\n    json: {\n      serviceName: null,\n      subscriptionType: null,\n      amount: null,\n      currency: null,\n      nextBillingDate: null,\n      cancellationMethod: null,\n      originalSubject: $input.first().json.subject,\n      extractedAt: new Date().toISOString(),\n      error: error.message\n    }\n  }];\n}"
          },
          "id": "b24ea170-6d47-46c8-acd0-a37dc4c452fb"
        },
        {
          "name": "IF Valid Data",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            -120,
            100
          ],
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json.serviceName}}",
                  "operation": "isNotNull"
                }
              ]
            }
          },
          "id": "e33f416d-ed64-4723-83f6-aa692946c7c6"
        },
        {
          "name": "Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            100,
            0
          ],
          "parameters": {
            "resource": "database",
            "databaseId": {
              "__rl": true,
              "value": "1f274ec0-3114-8043-b25d-e85a9bbb94bb",
              "mode": "list",
              "cachedResultName": "USSDM - Subscriptions",
              "cachedResultUrl": "https://www.notion.so/1f274ec031148043b25de85a9bbb94bb"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "964053bd-2c25-4a3c-82b2-f6427920a165"
        },
        {
          "name": "Set Success Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            320,
            0
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "status",
                  "value": "success"
                },
                {
                  "name": "message",
                  "value": "Subscription data extracted and saved to Notion"
                },
                {
                  "name": "serviceName",
                  "value": "={{$json.serviceName}}"
                },
                {
                  "name": "itemsProcessed",
                  "value": "={{$itemIndex + 1}}"
                }
              ]
            },
            "options": {}
          },
          "id": "9b069377-e487-4810-a4b9-7956e0e42aac"
        },
        {
          "name": "Set Skip Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            100,
            200
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "status",
                  "value": "skipped"
                },
                {
                  "name": "message",
                  "value": "No valid subscription data found"
                },
                {
                  "name": "reason",
                  "value": "={{$json.error || 'Service name not found'}}"
                }
              ]
            },
            "options": {}
          },
          "id": "a4a34796-05e6-43f9-812a-c1643fe13a0e"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Gmail",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gmail": {
          "main": [
            [
              {
                "node": "OpenAI",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI": {
          "main": [
            [
              {
                "node": "Parse OpenAI Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse OpenAI Response": {
          "main": [
            [
              {
                "node": "IF Valid Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "IF Valid Data": {
          "main": [
            [
              {
                "node": "Notion",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Set Skip Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Notion": {
          "main": [
            [
              {
                "node": "Set Success Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "a58004e9-9be4-48e9-b02e-fc8e5156ea07",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:38:59.686Z",
          "createdAt": "2025-11-02T02:38:59.686Z",
          "role": "workflow:owner",
          "workflowId": "SvrH9RykExiVClpC",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:20Z",
      "createdAt": "2025-11-01T14:40:20.609Z",
      "id": "Sw7W3F3n6pR2eKtZ",
      "name": "My workflow 9",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Manual Trigger",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {},
          "id": "c3cb595d-b3a6-47d4-ad59-5a0ec04b243f"
        },
        {
          "name": "Get All Historical Transactions",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            220,
            0
          ],
          "parameters": {
            "operation": "getAll",
            "tableId": "historical_transactions"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "0a40fd1e-d953-486e-8ace-8859e38d7115"
        },
        {
          "name": "Rule Extraction Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            440,
            0
          ],
          "parameters": {
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "bodyParameters": {
              "parameters": [
                {}
              ]
            },
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "4a93fb1c-f5a6-4e00-a646-625e86d64415"
        },
        {
          "name": "Format Rules for Storage",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            660,
            0
          ],
          "parameters": {
            "jsCode": "// Extract the rules from the Anthropic response\nconst response = $input.all();\nconst anthropicResponse = response[0].json;\nconst rulesContent = anthropicResponse.content[0].text;\n\n// Parse the JSON rules\nconst rulesData = JSON.parse(rulesContent);\n\n// Format each rule for Supabase insertion\nconst formattedRules = rulesData.rules.map(rule => ({\n  json: {\n    rule_id: rule.rule_id,\n    rule_type: rule.type,\n    condition_value: rule.condition,\n    target_category: rule.classification.category,\n    target_vat_rate: rule.classification.vat_rate,\n    confidence_threshold: rule.classification.confidence,\n    created_at: new Date().toISOString()\n  }\n}));\n\nreturn formattedRules;"
          },
          "id": "5819ffd0-917b-4973-9699-f34690752931"
        },
        {
          "name": "Save Rules to Database",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            880,
            0
          ],
          "parameters": {
            "tableId": "extracted_rules"
          },
          "id": "e008f9da-92fd-42c3-bddc-6e3d10c095c2"
        }
      ],
      "connections": {
        "Manual Trigger": {
          "main": [
            [
              {
                "node": "Get All Historical Transactions",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get All Historical Transactions": {
          "main": [
            [
              {
                "node": "Rule Extraction Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Rule Extraction Agent": {
          "main": [
            [
              {
                "node": "Format Rules for Storage",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Rules for Storage": {
          "main": [
            [
              {
                "node": "Save Rules to Database",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "f3ccde97-c8d9-4724-9742-94296558392a",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:20.612Z",
          "createdAt": "2025-11-01T14:40:20.612Z",
          "role": "workflow:owner",
          "workflowId": "Sw7W3F3n6pR2eKtZ",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:47Z",
      "createdAt": "2025-11-01T14:40:19.688Z",
      "id": "U7jORLwIIwrzrCGA",
      "name": "My workflow 14",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2,
          "position": [
            -1940,
            -100
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "balding-pig/product-generator",
            "responseMode": "responseNode",
            "options": {
              "responseHeaders": {
                "entries": [
                  {
                    "name": "Content-Type",
                    "value": "application/json"
                  }
                ]
              }
            }
          },
          "id": "51c26858-95c8-4cf5-95a7-d3a6cd965f81"
        },
        {
          "name": "Validate Input",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            -1780,
            -280
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "6c5c7e50-ff41-4025-a5d1-13830a8e2b50",
                  "name": "validatedData",
                  "type": "object",
                  "value": "={{ $json }}"
                }
              ]
            },
            "options": {}
          },
          "id": "56686024-98e1-4a89-ad95-10c5890063c8"
        },
        {
          "name": "Process Agent Output",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -1380,
            -100
          ],
          "parameters": {
            "jsCode": "// Process the agent's output\nconst agentOutput = $input.all()[0].json;\nlet products = [];\n\n// Extract products from agent response\nif (agentOutput.output) {\n  try {\n    // Try to parse if it's a JSON string\n    const parsed = JSON.parse(agentOutput.output);\n    products = parsed.products || [];\n  } catch (e) {\n    // If not JSON, extract from text\n    const productMatches = agentOutput.output.match(/\\{[^}]+\\}/g);\n    if (productMatches) {\n      products = productMatches.map(match => {\n        try {\n          return JSON.parse(match);\n        } catch (e) {\n          return null;\n        }\n      }).filter(Boolean);\n    }\n  }\n}\n\n// Get original input config\nconst originalInput = $('Validate Input').item.json.validatedData;\n\n// Enhance products with metadata\nconst enhancedProducts = products.map((product, index) => {\n  const sku = `BP-${new Date().getFullYear()}-${String(index + 1).padStart(4, '0')}`;\n  \n  return {\n    ...product,\n    product_id: `${Date.now()}-${index + 1}`,\n    product_index: index + 1,\n    sku: sku,\n    generated_at: new Date().toISOString(),\n    webhook_config: {\n      discord_webhook_url: originalInput.discord_webhook_url || '',\n      notion_database_id: originalInput.notion_database_id || '',\n      printify_shop_id: originalInput.printify_shop_id || '',\n      printify_blueprint_id: originalInput.printify_blueprint_id || 384,\n      shopify_store_url: originalInput.shopify_store_url || ''\n    },\n    status: 'generated',\n    approval_status: 'pending_review'\n  };\n});\n\nreturn {\n  products: enhancedProducts,\n  success: enhancedProducts.length > 0,\n  product_count: enhancedProducts.length,\n  agent_response: agentOutput.output,\n  timestamp: new Date().toISOString()\n};"
          },
          "id": "fada99bf-c65b-4806-b57c-85b11dfa6695"
        },
        {
          "name": "Check Generation Success",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.1,
          "position": [
            -1180,
            -100
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict"
              },
              "conditions": [
                {
                  "id": "success-condition",
                  "leftValue": "={{ $json.success }}",
                  "rightValue": true,
                  "operator": {
                    "type": "boolean",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "id": "f789a938-55da-4f28-820f-ac7b50ebc448"
        },
        {
          "name": "Split Products Array",
          "type": "n8n-nodes-base.itemLists",
          "typeVersion": 3.1,
          "position": [
            -980,
            -200
          ],
          "parameters": {
            "fieldToSplitOut": "products",
            "options": {}
          },
          "id": "4360a08f-b1f0-43b3-b855-c5c6c3ecb78c"
        },
        {
          "name": "Send to Discord",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -780,
            -200
          ],
          "parameters": {
            "url": "=https://discord.com/api/webhooks/1387491153305403452/Vrx2bGwzb2tQDwXny_OS96duf70ZNvDyJ-ilJC31V3MuXs8lFUZPqC9AyIbSC-3MbTaN\n",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"username\": \"The Balding Pig Bot\",\n  \"avatar_url\": \"https://thebaldingpig.com/logo.png\",\n  \"embeds\": [\n    {\n      \"title\": \"🐷 New Product: {{ $json.name }}\",\n      \"description\": \"{{ $json.tagline }}\",\n      \"color\": 16711680,\n      \"fields\": [\n        {\n          \"name\": \"💰 Price\",\n          \"value\": \"${{ $json.estimated_price }}\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"🎨 Style\",\n          \"value\": \"{{ $json.design_style }}\",\n          \"inline\": true\n        },\n        {\n          \"name\": \"📦 SKU\",\n          \"value\": \"{{ $json.sku }}\",\n          \"inline\": true\n        }\n      ],\n      \"footer\": {\n        \"text\": \"Generated by AI Agent\"\n      },\n      \"timestamp\": \"{{ $json.generated_at }}\"\n    }\n  ],\n  \"content\": \"**Midjourney Prompt:**\\n/imagine prompt: {{ $json.ai_prompt }} --ar 1:1 --v 6 --style raw\"\n}",
            "options": {
              "timeout": 10000
            }
          },
          "continueOnFail": true,
          "id": "7e0f0cf2-9525-4df3-be76-86193d3d4338"
        },
        {
          "name": "Aggregate Results",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -380,
            -200
          ],
          "parameters": {
            "jsCode": "// Aggregate all results\nconst allItems = $input.all();\nconst originalData = $('Process Agent Output').item.json;\n\nconst summary = {\n  total_products: originalData.product_count,\n  successful: allItems.filter(item => !item.error).length,\n  failed: allItems.filter(item => item.error).length,\n  products: originalData.products.map((product, index) => ({\n    name: product.name,\n    sku: product.sku,\n    status: 'processed',\n    platforms: {\n      discord: allItems[index]?.json?.status === 200 ? 'sent' : 'failed',\n      notion: 'pending',\n      printify: 'pending',\n      shopify: 'pending'\n    }\n  })),\n  agent_performance: {\n    generation_agent: 'success',\n    integration_agent: 'active'\n  },\n  timestamp: new Date().toISOString()\n};\n\nreturn summary;"
          },
          "id": "3ffc0ff1-7085-496b-bb08-54583a063f27"
        },
        {
          "name": "Success Response",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.1,
          "position": [
            -180,
            -200
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ JSON.stringify($json) }}",
            "options": {
              "responseCode": 200,
              "responseHeaders": {
                "entries": [
                  {
                    "name": "X-Agent-Version",
                    "value": "2025.1-AI"
                  }
                ]
              }
            }
          },
          "id": "8b03fe67-e1fa-4ae0-a99b-d45a2313a1b6"
        },
        {
          "name": "Error Response",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.1,
          "position": [
            -1180,
            100
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "{\n  \"success\": false,\n  \"error\": \"{{ $json.error || 'Product generation failed' }}\",\n  \"message\": \"The AI Agent failed to generate products. Please check your input.\",\n  \"timestamp\": \"{{ new Date().toISOString() }}\"\n}",
            "options": {
              "responseCode": 400
            }
          },
          "id": "f40f4265-c31d-4610-9056-725ffac0051d"
        },
        {
          "name": "OpenAI",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            -1660,
            -140
          ],
          "parameters": {
            "modelId": {
              "__rl": true,
              "value": "gpt-4-turbo",
              "mode": "list",
              "cachedResultName": "GPT-4-TURBO"
            },
            "messages": {
              "values": [
                {
                  "content": "Generate exactly 2 e-commerce products for The Balding Pig brand. Return ONLY a JSON array with this exact format:\n[{\"name\":\"Product Name\",\"description\":\"50-100 word description\",\"tagline\":\"Catchy tagline\",\"design_style\":\"Modern\",\"colours\":\"#FF6B6B\",\"keywords\":\"bald,confidence\",\"ai_prompt\":\"Midjourney prompt\",\"target_audience\":\"25-55 bald people\",\"estimated_price\":29.99,\"product_category\":\"apparel\",\"print_areas\":\"front\",\"size_range\":\"S-3XL\",\"material_specs\":\"100% cotton\",\"care_instructions\":\"Machine wash cold\",\"usp\":\"Makes baldness cool\",\"social_media_hooks\":[\"Hook 1\",\"Hook 2\",\"Hook 3\"]}]",
                  "role": "system"
                },
                {
                  "content": "={{ $json.validatedData.prompt }}\n\n\n"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "cb6a66ec-10fc-4a12-a8aa-d25ee3b8d161"
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Validate Input",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Validate Input": {
          "main": [
            [
              {
                "node": "OpenAI",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Agent Output": {
          "main": [
            [
              {
                "node": "Check Generation Success",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Generation Success": {
          "main": [
            [
              {
                "node": "Split Products Array",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Error Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Split Products Array": {
          "main": [
            [
              {
                "node": "Send to Discord",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send to Discord": {
          "main": [
            [
              {
                "node": "Aggregate Results",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Aggregate Results": {
          "main": [
            [
              {
                "node": "Success Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI": {
          "main": [
            [
              {
                "node": "Process Agent Output",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "ddcd2e3d-6527-442e-8ab7-db791b9dfc5f",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:19.691Z",
          "createdAt": "2025-11-01T14:40:19.691Z",
          "role": "workflow:owner",
          "workflowId": "U7jORLwIIwrzrCGA",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:36:57.216Z",
      "createdAt": "2025-11-01T14:36:57.216Z",
      "id": "UenkUIQjLv0HHf5t",
      "name": "Tool Registry Refresh (04:00)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 4 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 04:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "bb536eb4-2f5c-4364-9653-b3943e542437"
        },
        {
          "parameters": {
            "operation": "getAll",
            "base": "={{$env.NOTION_DATABASE_ID_TOOL_REGISTRY}}",
            "returnAll": true
          },
          "name": "Get All Tools",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            450,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "8a040ad0-2819-4c60-b059-dd05d2ab4c84"
        },
        {
          "parameters": {
            "functionCode": "// Check tool status and update reliability\nconst tool = $input.item.json;\nconst now = new Date();\n\n// Mock health check (replace with actual API calls)\nconst isHealthy = Math.random() > 0.1; // 90% uptime simulation\n\nconst updatedTool = {\n  id: tool.id,\n  reliability_score: isHealthy ? Math.min(tool.ReliabilityScore + 1, 100) : Math.max(tool.ReliabilityScore - 5, 0),\n  status: isHealthy ? 'Active' : 'Degraded',\n  last_checked: now.toISOString()\n};\n\nreturn [{ json: updatedTool }];"
          },
          "name": "Check Tool Health",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "id": "63364896-acdb-4cf3-a839-7dffd8d44756"
        },
        {
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.id}}",
            "properties": {
              "ReliabilityScore": "={{$json.reliability_score}}",
              "Status": "={{$json.status}}"
            }
          },
          "name": "Update Tool Registry",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "4bf6651f-e8f3-4154-97e6-e08bb7caaf1a"
        }
      ],
      "connections": {
        "Schedule Trigger - 04:00": {
          "main": [
            [
              {
                "node": "Get All Tools",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get All Tools": {
          "main": [
            [
              {
                "node": "Check Tool Health",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Tool Health": {
          "main": [
            [
              {
                "node": "Update Tool Registry",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "29ed872e-2263-4b81-b564-d7d03bd11fab",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:57.218Z",
          "createdAt": "2025-11-01T14:36:57.218Z",
          "role": "workflow:owner",
          "workflowId": "UenkUIQjLv0HHf5t",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-31T05:42:22Z",
      "createdAt": "2025-10-30T11:24:19.99Z",
      "id": "Urbf1osHj93jCb2R",
      "name": "Midjourney Automation Receiver",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-automation",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "webhook-1",
          "name": "Webhook - Midjourney Data",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            256,
            304
          ],
          "webhookId": "midjourney-automation"
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "article_title",
                  "value": "={{ $json.article.title }}"
                },
                {
                  "name": "article_url",
                  "value": "={{ $json.article.url }}"
                },
                {
                  "name": "social_content",
                  "value": "={{ $json.socialPost.content }}"
                },
                {
                  "name": "image_url",
                  "value": "={{ $json.midjourney.imageUrl }}"
                },
                {
                  "name": "prompt",
                  "value": "={{ $json.midjourney.prompt }}"
                },
                {
                  "name": "timestamp",
                  "value": "={{ $json.timestamp }}"
                }
              ]
            },
            "options": {}
          },
          "id": "set-1",
          "name": "Extract Data",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            464,
            304
          ]
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.midjourney.status }}",
                  "operation": "contains",
                  "value2": "completed"
                }
              ]
            }
          },
          "id": "if-1",
          "name": "Check Status",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            656,
            304
          ]
        },
        {
          "parameters": {
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": "YOUR_GOOGLE_SHEET_ID"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": "Sheet1"
            },
            "options": {}
          },
          "id": "google-sheets-1",
          "name": "Save to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 3,
          "position": [
            864,
            208
          ],
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ { \"success\": true, \"message\": \"Data received and processed\", \"timestamp\": $json.timestamp } }}",
            "options": {}
          },
          "id": "respond-1",
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1328,
            400
          ]
        },
        {
          "parameters": {
            "sendTo": "michael@bermech.com",
            "subject": "=New Midjourney Image Generated",
            "message": "=New Midjourney Image Generated{{ $('Extract Data').item.json.body.midjourney.imageUrl }}",
            "options": {}
          },
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2.1,
          "position": [
            864,
            592
          ],
          "id": "b54ed877-e17d-4b07-8db3-917f5e0ae728",
          "name": "Send a message",
          "webhookId": "c648cf9b-2bd1-4bea-8139-3827611f6dbe",
          "credentials": {
            "gmailOAuth2": {
              "id": "620vdKWBF5Z99fQC",
              "name": "Gmail 3"
            }
          }
        },
        {
          "parameters": {
            "sendTo": "michael@bermech.com",
            "subject": "Midjourney image gen failed ",
            "message": "=Your Mid Journey image failed.  {{ $json.body.midjourney.prompt }}{{ $json.body.midjourney.status }}",
            "options": {}
          },
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2.1,
          "position": [
            864,
            400
          ],
          "id": "e00ff3b3-2019-43ca-8879-0532b51f902f",
          "name": "Send a message1",
          "webhookId": "90f1f797-9dda-41e9-acac-3825900313eb",
          "credentials": {
            "gmailOAuth2": {
              "id": "gp1NXWCFDSwhqabQ",
              "name": "Gmail account"
            }
          }
        }
      ],
      "connections": {
        "Webhook - Midjourney Data": {
          "main": [
            [
              {
                "node": "Extract Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Data": {
          "main": [
            [
              {
                "node": "Check Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Status": {
          "main": [
            [
              {
                "node": "Save to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Send a message",
                "type": "main",
                "index": 0
              },
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Send a message1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Google Sheets": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send a message": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send a message1": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {
        "Webhook - Midjourney Data": [
          {
            "json": {
              "headers": {
                "accept": "application/json, text/plain, */*",
                "content-type": "application/json",
                "user-agent": "axios/1.13.0",
                "content-length": "625",
                "accept-encoding": "gzip, compress, deflate, br",
                "host": "192.168.50.246:5678",
                "connection": "keep-alive"
              },
              "params": {},
              "query": {},
              "body": {
                "timestamp": "2025-10-30T11:46:01.092Z",
                "source": "midjourney-news-automation",
                "article": {
                  "title": "AI Breakthrough in 2024",
                  "url": "https://example.com/ai-breakthrough",
                  "source": "Tech News",
                  "content": "Revolutionary AI technology announced..."
                },
                "socialPost": {
                  "platform": "LinkedIn",
                  "content": "Exciting developments in AI! Check out this breakthrough...",
                  "hashtags": [
                    "#AI",
                    "#Technology",
                    "#Innovation"
                  ]
                },
                "midjourney": {
                  "prompt": "futuristic AI laboratory, holographic displays, scientists working, cyberpunk style, cinematic lighting",
                  "imageUrl": "https://example.com/generated-image.png",
                  "jobId": "test-job-123",
                  "status": "completed"
                }
              },
              "webhookUrl": "http://192.168.50.246:5678/webhook/midjourney-automation",
              "executionMode": "production"
            }
          }
        ]
      },
      "versionId": "43cd9cb9-a7a3-4721-8d5c-b2aec6fa8a6b",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-30T11:24:20.013Z",
          "createdAt": "2025-10-30T11:24:20.013Z",
          "role": "workflow:owner",
          "workflowId": "Urbf1osHj93jCb2R",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-26T06:34:20Z",
      "createdAt": "2025-10-26T02:59:45.038Z",
      "id": "VnGWw39TYdMdW8aT",
      "name": "Audio Production Pipeline v2",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "audio-production",
            "responseMode": "responseNode",
            "options": {}
          },
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1.1,
          "position": [
            240,
            304
          ],
          "webhookId": "audio-production",
          "id": "473f6e8e-0d20-4177-8d98-0c81a9e67005"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.mode}}",
                  "operation": "equals",
                  "value2": "preview"
                }
              ]
            }
          },
          "name": "Check Mode",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            672,
            304
          ],
          "id": "64f8ad8c-a652-4a75-abce-a075452f01f3"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.openai.com/v1/audio/speech",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "openAiApi",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"tts-1\",\n  \"voice\": \"{{ $json.voice || 'alloy' }}\",\n  \"input\": \"{{ $json.text }}\"\n}",
            "options": {
              "response": {
                "response": {
                  "fullResponse": true,
                  "responseFormat": "json"
                }
              }
            }
          },
          "name": "OpenAI TTS Preview",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            896,
            208
          ],
          "id": "03623857-2b75-4e2a-b28e-907f3a23a92e",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "=https://api.elevenlabs.io/v1/text-to-speech/{{ $json.voiceId || '21m00Tcm4TlvDq8ikWAM' }}",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "httpHeaderAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"text\": \"{{ $json.text }}\",\n  \"model_id\": \"eleven_multilingual_v2\",\n  \"voice_settings\": {\n    \"stability\": 0.5,\n    \"similarity_boost\": 0.75\n  }\n}",
            "options": {
              "response": {
                "response": {
                  "responseFormat": "file"
                }
              }
            }
          },
          "name": "ElevenLabs Production",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            896,
            400
          ],
          "id": "c7583ad0-b57a-4ef7-a011-89555951645c",
          "credentials": {
            "httpHeaderAuth": {
              "id": "tuSFB1kiLHhmlFl7",
              "name": "Novel Studio ElevenLabs"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Save audio file and create metadata\nconst crypto = require('crypto');\nconst fs = require('fs');\nconst path = require('path');\n\n// Get audio data from previous node\nconst audioData = $input.item.binary.data;\nconst seriesId = $input.item.json.seriesId || 'default';\nconst mode = $input.item.json.mode || 'preview';\n\n// Calculate hash for deduplication\nconst hash = crypto.createHash('sha256').update(audioData).digest('hex');\nconst hashPrefix = hash.substring(0, 2);\n\n// Storage paths (use /share/Container/NovelStudio when mounted in container)\nconst baseDir = '/share/Container/NovelStudio/audio';\nconst seriesDir = `${baseDir}/${seriesId}`;\nconst hashDir = `${seriesDir}/${hashPrefix}`;\nconst filename = `${hash}.mp3`;\nconst fullPath = `${hashDir}/${filename}`;\n\n// Create directories if they don't exist\ntry {\n  if (!fs.existsSync(seriesDir)) fs.mkdirSync(seriesDir, { recursive: true });\n  if (!fs.existsSync(hashDir)) fs.mkdirSync(hashDir, { recursive: true });\n  \n  // Write file\n  fs.writeFileSync(fullPath, audioData);\n  \n  return {\n    json: {\n      success: true,\n      hash: hash,\n      path: fullPath,\n      seriesId: seriesId,\n      mode: mode,\n      size: audioData.length,\n      timestamp: new Date().toISOString()\n    }\n  };\n} catch (error) {\n  return {\n    json: {\n      success: false,\n      error: error.message,\n      attempted_path: fullPath\n    }\n  };\n}"
          },
          "name": "Save Audio File",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1120,
            304
          ],
          "id": "31a35f2d-ed9e-4721-9467-3d3c334a5ec0"
        },
        {
          "parameters": {
            "options": {}
          },
          "name": "Respond",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1328,
            304
          ],
          "id": "ea3647f7-41b3-4644-b975-a5fffa153905"
        },
        {
          "parameters": {
            "respondWith": "text",
            "responseBody": "={{ $json }}",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            1536,
            304
          ],
          "id": "07b5e6b5-0b81-4c28-86a0-21300e6b3b71",
          "name": "Respond to Webhook"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Check Mode",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Mode": {
          "main": [
            [
              {
                "node": "OpenAI TTS Preview",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "ElevenLabs Production",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI TTS Preview": {
          "main": [
            [
              {
                "node": "Save Audio File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "ElevenLabs Production": {
          "main": [
            [
              {
                "node": "Save Audio File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Audio File": {
          "main": [
            [
              {
                "node": "Respond",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Respond": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Respond to Webhook": {
          "main": [
            []
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {},
      "versionId": "4dbb8031-2f34-4a32-ac5e-8483ce64e6e4",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-26T02:59:45.042Z",
          "createdAt": "2025-10-26T02:59:45.042Z",
          "role": "workflow:owner",
          "workflowId": "VnGWw39TYdMdW8aT",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:34Z",
      "createdAt": "2025-11-01T14:40:22.269Z",
      "id": "Vw8xvJRKziGbcrAR",
      "name": "My workflow 5",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Main Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "path": "ussdm-webhook",
            "options": {}
          },
          "id": "dff1d294-85a1-49c7-b068-253f81d185f2"
        },
        {
          "name": "Daily Sync Schedule",
          "type": "n8n-nodes-base.schedule",
          "typeVersion": 1,
          "position": [
            0,
            200
          ],
          "parameters": {},
          "id": "97116cfd-cf44-47bc-9aac-b5689c11d6d9"
        },
        {
          "name": "Set Sync Operation",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            220,
            100
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "operation",
                  "value": "sync_emails"
                },
                {
                  "name": "module",
                  "value": "email_aggregation"
                }
              ]
            },
            "options": {}
          },
          "id": "d2e712b3-b785-4798-bac6-5d86c6d2cda9"
        },
        {
          "name": "Route by Operation",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            420,
            100
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.operation}}",
                  "value2": "sync_emails"
                }
              ]
            }
          },
          "id": "90376cee-296d-439a-a8b3-6aeb7e429e3a"
        },
        {
          "name": "Gmail - Fetch Subscription Emails",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2,
          "position": [
            640,
            0
          ],
          "parameters": {
            "authentication": "oAuth2Api",
            "sendTo": "bermingham85@hotmail.com",
            "subject": "\"\"",
            "message": "\"\"",
            "options": {}
          },
          "id": "d89a9513-415c-4ab6-bb5b-faf4eff25c55"
        },
        {
          "name": "Merge Email Data",
          "type": "n8n-nodes-base.merge",
          "typeVersion": 2,
          "position": [
            860,
            100
          ],
          "parameters": {
            "mode": "combine",
            "combinationMode": "mergeByPosition",
            "options": {}
          },
          "id": "f7386bb5-3861-4946-84f4-d55dfcf153f5"
        },
        {
          "name": "Pre-Process Emails",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1080,
            100
          ],
          "parameters": {
            "jsCode": "// Process each email for subscription detection\nlet subscriptionEmails = [];\n\nfor (const item of $input.all()) {\n  const email = item.json;\n  \n  // Extract relevant email content\n  const emailData = {\n    id: email.id,\n    subject: email.payload?.headers?.find(h => h.name === 'Subject')?.value || '',\n    from: email.payload?.headers?.find(h => h.name === 'From')?.value || '',\n    date: email.payload?.headers?.find(h => h.name === 'Date')?.value || '',\n    snippet: email.snippet || '',\n    body: email.payload?.parts?.[0]?.body?.data || email.payload?.body?.data || ''\n  };\n  \n  // Extract keywords that indicate subscriptions\n  const subscriptionKeywords = [\n    'subscription', 'billing', 'payment', 'invoice', 'auto-renew',\n    'monthly charge', 'annual subscription', 'premium', 'upgrade',\n    'cancel subscription', 'unsubscribe', 'trial ending'\n  ];\n  \n  const hasSubscriptionKeywords = subscriptionKeywords.some(keyword => \n    emailData.subject.toLowerCase().includes(keyword) ||\n    emailData.snippet.toLowerCase().includes(keyword)\n  );\n  \n  if (hasSubscriptionKeywords) {\n    subscriptionEmails.push({\n      ...emailData,\n      classification: 'potential_subscription',\n      processing_status: 'pending_ai_analysis'\n    });\n  }\n}\n\nreturn subscriptionEmails.map(email => ({ json: email }));"
          },
          "id": "df436663-480c-4124-8b96-f21b564fdf73"
        },
        {
          "name": "Prepare AI Prompt",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            1300,
            100
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "prompt",
                  "value": "Analyze the following email content for subscription-related information. Extract:\n1. Service/Company name\n2. Subscription type (monthly/annual/trial)\n3. Amount charged\n4. Currency\n5. Next billing date\n6. Subscription status (active/cancelled/trial)\n7. Cancellation method if available\n\nEmail Content:\nSubject: {{$json.subject}}\nFrom: {{$json.from}}\nSnippet: {{$json.snippet}}\n\nRespond in JSON format with the extracted information."
                }
              ]
            },
            "options": {}
          },
          "id": "c40b6ea5-eaa6-4ee5-a813-e758890115a6"
        },
        {
          "name": "Claude - Subscription Analysis",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            1520,
            100
          ],
          "parameters": {},
          "credentials": {},
          "id": "4b6e34c6-b957-4227-947f-e57416f08890"
        },
        {
          "name": "OpenAI - Fallback Parser",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            1520,
            300
          ],
          "parameters": {
            "model": "chatgpt-4o-latest",
            "options": {
              "temperature": 0.1
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "75870e54-ef78-4aa4-9158-a3a4fcacdaa4"
        },
        {
          "name": "Parse AI Response",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1740,
            200
          ],
          "parameters": {
            "jsCode": "// Parse and structure AI response\nconst items = $input.all();\nlet processedSubscriptions = [];\n\nfor (const item of items) {\n  try {\n    let analysisResult;\n    \n    // Try to parse Claude's response\n    if (item.json.content) {\n      analysisResult = JSON.parse(item.json.content);\n    } else if (item.json.message?.content) {\n      analysisResult = JSON.parse(item.json.message.content);\n    } else {\n      throw new Error('No valid content found');\n    }\n    \n    // Structure the subscription data\n    const subscription = {\n      id: item.json.id || 'unknown',\n      service_name: analysisResult.service_name || 'Unknown Service',\n      subscription_type: analysisResult.subscription_type || 'unknown',\n      amount: analysisResult.amount || 0,\n      currency: analysisResult.currency || 'USD',\n      next_billing_date: analysisResult.next_billing_date || null,\n      status: analysisResult.subscription_status || 'unknown',\n      cancellation_method: analysisResult.cancellation_method || null,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString(),\n      processing_source: item.json.content ? 'claude' : 'openai'\n    };\n    \n    processedSubscriptions.push(subscription);\n    \n  } catch (error) {\n    // Log error and create fallback entry\n    processedSubscriptions.push({\n      id: item.json.id || 'unknown',\n      service_name: 'Parse Error',\n      status: 'error',\n      error_message: error.message,\n      original_email: {\n        subject: item.json.subject,\n        from: item.json.from,\n        date: item.json.date\n      },\n      processed_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn processedSubscriptions.map(sub => ({ json: sub }));"
          },
          "id": "d0db713c-9777-4259-9d39-28f56ea30d5b"
        },
        {
          "name": "Check Processing Success",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1960,
            200
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.status}}",
                  "operation": "notEqual",
                  "value2": "error"
                }
              ]
            }
          },
          "id": "8560e88f-126f-49c7-b93d-b26f2468ee4c"
        },
        {
          "name": "Save to Firebase",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            2180,
            100
          ],
          "parameters": {},
          "credentials": {},
          "id": "8731e985-c7d1-4e2c-9c97-3d6a46b6ed52"
        },
        {
          "name": "Save to Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            2180,
            300
          ],
          "parameters": {
            "resource": "database",
            "databaseId": {
              "__rl": true,
              "value": "1f274ec0-3114-8043-b25d-e85a9bbb94bb",
              "mode": "list",
              "cachedResultName": "USSDM - Subscriptions",
              "cachedResultUrl": "https://www.notion.so/1f274ec031148043b25de85a9bbb94bb"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "dc6695f9-7e3f-407f-a629-431df445d2b3"
        },
        {
          "name": "Prepare Dispute Analysis",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            2400,
            200
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "dispute_prompt",
                  "value": "Based on the following subscription information, determine if this subscription is eligible for a dispute or refund request under EU, US, or UK consumer protection laws:\n\nService: {{$json.service_name}}\nStatus: {{$json.status}}\nSubscription Type: {{$json.subscription_type}}\nAmount: {{$json.amount}} {{$json.currency}}\nNext Billing: {{$json.next_billing_date}}\n\nProvide:\n1. Dispute eligibility (YES/NO)\n2. Legal basis (if applicable)\n3. Recommended action\n4. Draft dispute email template"
                }
              ]
            },
            "options": {}
          },
          "id": "ebb14615-72e5-4e6b-a845-cd85d9eb87f9"
        },
        {
          "name": "Claude - Dispute Analysis",
          "type": "n8n-nodes-base.anthropicClaude",
          "typeVersion": 1,
          "position": [
            2620,
            200
          ],
          "parameters": {},
          "credentials": {},
          "id": "60f1a887-f602-4822-ab23-969eefcd8d18"
        },
        {
          "name": "Process Dispute Analysis",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            2840,
            200
          ],
          "parameters": {
            "jsCode": "// Parse dispute analysis and create actionable recommendations\nconst items = $input.all();\nlet disputeAnalysis = [];\n\nfor (const item of items) {\n  try {\n    const analysis = item.json.content || item.json.message?.content || '';\n    \n    // Extract key information from Claude's response\n    const eligibilityMatch = analysis.match(/Dispute eligibility:\\s*(YES|NO)/i);\n    const legalBasisMatch = analysis.match(/Legal basis:\\s*([^\\n]+)/i);\n    const actionMatch = analysis.match(/Recommended action:\\s*([^\\n]+)/i);\n    \n    const dispute = {\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: eligibilityMatch ? eligibilityMatch[1].toUpperCase() === 'YES' : false,\n      legal_basis: legalBasisMatch ? legalBasisMatch[1] : null,\n      recommended_action: actionMatch ? actionMatch[1] : null,\n      full_analysis: analysis,\n      created_at: new Date().toISOString()\n    };\n    \n    disputeAnalysis.push(dispute);\n    \n  } catch (error) {\n    disputeAnalysis.push({\n      subscription_id: item.json.id,\n      service_name: item.json.service_name,\n      dispute_eligible: false,\n      error: error.message,\n      created_at: new Date().toISOString()\n    });\n  }\n}\n\nreturn disputeAnalysis.map(analysis => ({ json: analysis }));"
          },
          "id": "2211c78d-8c5a-430c-9a04-cf910de3789a"
        },
        {
          "name": "Check Dispute Eligible",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            3060,
            200
          ],
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{$json.dispute_eligible}}"
                }
              ]
            }
          },
          "id": "518bd2fc-9c8b-4ecc-b878-d2903962099a"
        },
        {
          "name": "Save Dispute Analysis",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            3280,
            100
          ],
          "parameters": {},
          "credentials": {},
          "id": "a8101b11-dd98-4ae5-bbc3-4676505bf5ee"
        },
        {
          "name": "Error Webhook Handler",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            1520,
            500
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "ussdm-error",
            "options": {}
          },
          "id": "7d1ef309-5d68-446f-9278-e1b30bbea4c7"
        },
        {
          "name": "Log Error to Firebase",
          "type": "n8n-nodes-base.firestore",
          "typeVersion": 1,
          "position": [
            1740,
            500
          ],
          "parameters": {},
          "credentials": {},
          "id": "cd35b6f4-ab8b-4678-9bd6-471aa71598ad"
        },
        {
          "name": "Status Check Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            0,
            400
          ],
          "parameters": {
            "path": "ussdm-status",
            "options": {}
          },
          "id": "0eeccfcd-52ab-4dfc-90d7-01a6d7af2e15"
        },
        {
          "name": "Generate Status Report",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            220,
            400
          ],
          "parameters": {
            "jsCode": "// Generate system status report\nconst systemStatus = {\n  status: 'healthy',\n  last_sync: new Date().toISOString(),\n  version: '1.0.0',\n  modules: {\n    email_aggregation: 'active',\n    subscription_detection: 'active',\n    dispute_analysis: 'active',\n    storage: 'active'\n  },\n  health_checks: {\n    api_connectivity: 'ok',\n    storage_accessible: 'ok',\n    ai_services: 'ok'\n  }\n};\n\nreturn [{ json: systemStatus }];"
          },
          "id": "b2b5f673-8cf1-49f9-b6f9-80f4857bf209"
        },
        {
          "name": "Return Status",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            440,
            400
          ],
          "parameters": {
            "path": "45e7bf07-c15c-4190-bc71-100a544e19be",
            "options": {}
          },
          "id": "6c7dbdd4-2545-4e54-897f-2dab262e88c0"
        }
      ],
      "connections": {
        "Main Webhook Trigger": {
          "main": [
            [
              {
                "node": "Set Sync Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Sync Operation": {
          "main": [
            [
              {
                "node": "Route by Operation",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route by Operation": {
          "main": [
            [
              {
                "node": "Gmail - Fetch Subscription Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Gmail - Fetch Subscription Emails": {
          "main": [
            [
              {
                "node": "Merge Email Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge Email Data": {
          "main": [
            [
              {
                "node": "Pre-Process Emails",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Pre-Process Emails": {
          "main": [
            [
              {
                "node": "Prepare AI Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI - Fallback Parser": {
          "main": [
            [
              {
                "node": "Parse AI Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse AI Response": {
          "main": [
            [
              {
                "node": "Check Processing Success",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Processing Success": {
          "main": [
            [
              {
                "node": "Save to Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Notion": {
          "main": [
            [
              {
                "node": "Prepare Dispute Analysis",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Dispute Analysis": {
          "main": [
            [
              {
                "node": "Check Dispute Eligible",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Status Check Webhook": {
          "main": [
            [
              {
                "node": "Generate Status Report",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "6d91b229-243c-49c8-b493-2280f735a87f",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:22.271Z",
          "createdAt": "2025-11-01T14:40:22.271Z",
          "role": "workflow:owner",
          "workflowId": "Vw8xvJRKziGbcrAR",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:18Z",
      "createdAt": "2025-11-01T14:40:26.549Z",
      "id": "VxwN93c3oJwevyRi",
      "name": "Custom Orders Agent",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Custom Orders Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -180,
            -60
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Custom Orders Agent, specializing in managing bespoke gadget orders, from initial design consultation through to delivery. You handle custom steampunk, art deco, and retro-futuristic device requests with meticulous attention to personalization details.\n\n## Tools Available\n\n### Order Management API\n- Create custom orders\n- Configure personalization options\n- Set production timelines\n- Track order progress\n\n### Design Configuration\n- Capture custom specifications\n- Material selection\n- Engraving details\n- Special features setup\n\n### Airtable Order Tracking\n- Manage order pipeline\n- Track customization details\n- Monitor production stages\n\n### Gmail Communication\n- Send order confirmations\n- Share design mockups\n- Coordinate special requests\n\n### Google Sheets Inventory\n- Component availability\n- Material stock levels\n- Cost calculations\n\n### Slack Coordination\n- Artisan assignments\n- Rush order alerts\n- Design approvals\n\n## Product Categories\n\n### Gadget Types\n- Steampunk USB Drives\n- Art Deco Smartwatches\n- Dieselpunk Phone Cases\n- Atompunk Desk Accessories\n- Cyberpunk Gaming Peripherals\n\n### Customization Options\n\n#### Materials\n- Brass and copper finishes\n- Reclaimed wood inlays\n- Vintage leather wrapping\n- Custom gear mechanisms\n\n#### Personalization\n- Laser engraving\n- Custom patina finishes\n- Bespoke gear configurations\n- Illumination options\n\n## Order Management\n- Minimum order value: $150\n- Lead time: 2-6 weeks\n- Rush orders: +50% surcharge\n- Limited edition runs: Max 50 units\n\n## Key Order Metrics\n- Customization complexity score\n- Material availability status\n- Artisan skill matching\n- Production timeline accuracy\n- Customer satisfaction rating\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "922cf9ed-c483-482e-9700-7eda4b27774a"
        },
        {
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            -520,
            180
          ],
          "parameters": {
            "model": "gpt-4o",
            "options": {}
          },
          "id": "aa8da691-1b5b-420a-916a-a81c73b53c4d"
        },
        {
          "name": "Create Custom Order",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -340,
            220
          ],
          "parameters": {
            "toolDescription": "Create a new custom gadget order",
            "method": "POST",
            "url": "https://api.retrofuturegadgetry.com/v2/orders",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"customerId\": \"{customerId}\",\n  \"productType\": \"{productType}\",\n  \"customizations\": {\n    \"materials\": {materials},\n    \"engraving\": {engravingDetails},\n    \"features\": {customFeatures}\n  },\n  \"quantity\": {quantity},\n  \"rushOrder\": {rushOrder},\n  \"specialInstructions\": \"{specialInstructions}\",\n  \"estimatedDelivery\": \"{estimatedDelivery}\"\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "customerId",
                  "description": "Customer account ID",
                  "type": "string"
                },
                {
                  "name": "productType",
                  "description": "Type of gadget",
                  "type": "string"
                },
                {
                  "name": "materials",
                  "description": "Selected materials",
                  "type": "json"
                },
                {
                  "name": "engravingDetails",
                  "description": "Engraving specifications",
                  "type": "json"
                },
                {
                  "name": "customFeatures",
                  "description": "Special features",
                  "type": "json"
                },
                {
                  "name": "quantity",
                  "description": "Order quantity",
                  "type": "number"
                },
                {
                  "name": "rushOrder",
                  "description": "Rush order flag",
                  "type": "boolean"
                },
                {
                  "name": "specialInstructions",
                  "description": "Special instructions",
                  "type": "string"
                },
                {
                  "name": "estimatedDelivery",
                  "description": "Estimated delivery date",
                  "type": "string"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "c4c1c0ac-df8a-4d80-89ca-3194c6825c72"
        },
        {
          "name": "Configure Design",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -160,
            260
          ],
          "parameters": {
            "toolDescription": "Configure custom design specifications",
            "method": "POST",
            "url": "https://api.retrofuturegadgetry.com/v2/design/configure",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"orderId\": \"{orderId}\",\n  \"baseDesign\": \"{baseDesign}\",\n  \"colorScheme\": {colorScheme},\n  \"mechanicalElements\": {mechanicalElements},\n  \"illumination\": \"{illuminationType}\",\n  \"dimensionAdjustments\": {dimensions}\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "orderId",
                  "description": "Order ID",
                  "type": "string"
                },
                {
                  "name": "baseDesign",
                  "description": "Base design template",
                  "type": "string"
                },
                {
                  "name": "colorScheme",
                  "description": "Color configuration",
                  "type": "json"
                },
                {
                  "name": "mechanicalElements",
                  "description": "Gear and mechanism specs",
                  "type": "json"
                },
                {
                  "name": "illuminationType",
                  "description": "LED/lighting options",
                  "type": "string"
                },
                {
                  "name": "dimensions",
                  "description": "Size adjustments",
                  "type": "json"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "a91b3893-7127-4f4c-8363-da4ef083fdd3"
        },
        {
          "name": "Create Order Record",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            -620,
            540
          ],
          "parameters": {},
          "credentials": {},
          "id": "81353c1c-93e9-408b-8386-f8de01780828"
        },
        {
          "name": "Send Order Confirmation",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            -20,
            240
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"customerEmail\") }}",
            "subject": "={{ $fromAI(\"emailSubject\", \"Your RetroFuture Custom Order\") }}",
            "message": "={{ $fromAI(\"orderConfirmation\") }}",
            "options": {}
          },
          "id": "329d89b3-b1a7-4f91-957f-fba32583c243"
        },
        {
          "name": "Track Order",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            140,
            200
          ],
          "parameters": {
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "f4d2082b-e002-4450-ba15-e6949a5b697f"
        },
        {
          "name": "Notify Artisan Team",
          "type": "n8n-nodes-base.slackTool",
          "typeVersion": 1.4,
          "position": [
            -620,
            780
          ],
          "parameters": {},
          "credentials": {},
          "id": "41531b0a-754d-4c29-b80d-9cc55f4b8bbb"
        },
        {
          "name": "Get Order Status",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            300,
            200
          ],
          "parameters": {
            "toolDescription": "Get order status and progress",
            "url": "https://api.retrofuturegadgetry.com/v2/orders/{orderId}/status",
            "sendQuery": true,
            "parametersQuery": {
              "values": [
                {}
              ]
            },
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "orderId",
                  "description": "Order ID",
                  "type": "string"
                },
                {
                  "name": "includePhotos",
                  "description": "Include progress photos",
                  "type": "boolean"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "5d51c7a8-d272-4b1e-b039-1fe26e577745"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            400,
            -160
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "1558d785-db30-4056-92cb-25aa0649d1c2"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            400,
            40
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process custom order request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "5e641495-9ad0-43d1-a6e1-b3eaf8618499"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -620,
            -60
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "ecd78bb6-c872-46c7-a67b-5fc642151abc"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Create Custom Order": {
          "ai_tool": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Configure Design": {
          "ai_tool": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Order Confirmation": {
          "ai_tool": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Track Order": {
          "ai_tool": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Get Order Status": {
          "ai_tool": [
            [
              {
                "node": "Custom Orders Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Custom Orders Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "e896b9ac-81c5-4dbf-aaab-4f883bd01470",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:26.551Z",
          "createdAt": "2025-11-01T14:40:26.551Z",
          "role": "workflow:owner",
          "workflowId": "VxwN93c3oJwevyRi",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:52:45Z",
      "createdAt": "2025-11-01T14:40:32.775Z",
      "id": "WWnLdcSZo2GeuOwW",
      "name": "GitHub Integration Workflow (imported 20251101_144033)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "GitHub Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "github-webhook",
            "options": {}
          },
          "id": "0833bde2-18cc-436a-8f72-746e9e892a96"
        },
        {
          "name": "Filter Push Events",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.headers['x-github-event'] }}",
                  "rightValue": "push",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "27ea9b78-01eb-44db-9248-35193519d885"
        },
        {
          "name": "Get Repository Issues",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            240
          ],
          "parameters": {
            "resource": "repository",
            "operation": "getIssues",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}"
          },
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          },
          "id": "0b989e58-30a4-4f20-8f6b-cfcfdb871e0d"
        },
        {
          "name": "Sync Workflows",
          "type": "n8n-nodes-base.github",
          "typeVersion": 1,
          "position": [
            680,
            360
          ],
          "parameters": {
            "resource": "file",
            "operation": "get",
            "owner": "={{ $json.repository.owner.login }}",
            "repository": "={{ $json.repository.name }}",
            "filePath": "workflows/"
          },
          "credentials": {
            "githubApi": {
              "id": "github-api",
              "name": "GitHub API"
            }
          },
          "id": "a7ecf23e-7654-4f83-83b9-f02b8c47140c"
        },
        {
          "name": "Import Workflows to n8n",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ],
          "parameters": {
            "method": "POST",
            "url": "http://localhost:5678/rest/workflows/import",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ $json }}"
            }
          },
          "id": "7063b544-fe58-4b44-aa86-d24f2ef02134"
        }
      ],
      "connections": {
        "GitHub Webhook": {
          "main": [
            [
              {
                "node": "Filter Push Events",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Push Events": {
          "main": [
            [
              {
                "node": "Get Repository Issues",
                "type": "main",
                "index": 0
              },
              {
                "node": "Sync Workflows",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Repository Issues": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Sync Workflows": {
          "main": [
            [
              {
                "node": "Import Workflows to n8n",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "13129e97-f553-46c4-91a2-c0fac80ed0e1",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:32.777Z",
          "createdAt": "2025-11-01T14:40:32.777Z",
          "role": "workflow:owner",
          "workflowId": "WWnLdcSZo2GeuOwW",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:15Z",
      "createdAt": "2025-11-02T02:39:00.596Z",
      "id": "ZC3sXHr8i6H6evHG",
      "name": "balding pig product gen to notion",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Trigger",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -1520,
            820
          ],
          "parameters": {
            "rule": {
              "interval": [
                {}
              ]
            }
          },
          "id": "4fabf6cc-58b8-4cbf-8006-e16ab89034be"
        },
        {
          "name": "Get New Products",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            -1300,
            820
          ],
          "parameters": {
            "resource": "databasePage",
            "operation": "get",
            "pageId": {
              "__rl": true,
              "mode": "id",
              "value": "",
              "__regex": "^([0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12})"
            }
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "cfa40d57-90c2-46ba-8d6c-34b010389db6"
        },
        {
          "name": "Process Each Product",
          "type": "n8n-nodes-base.splitInBatches",
          "typeVersion": 2,
          "position": [
            -1080,
            920
          ],
          "parameters": {
            "batchSize": 1,
            "options": {}
          },
          "id": "cc061b68-c467-4013-b709-3cc6aed9d7af"
        },
        {
          "name": "Extract Product Data",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -860,
            920
          ],
          "parameters": {
            "functionCode": "// Extract product data and format it for processing\nconst product = $input.item.json;\nconst productData = {};\n\n// Extract properties from Notion format\ntry {\n  // Handle different property types\n  Object.keys(product.properties).forEach(key => {\n    const prop = product.properties[key];\n    \n    if (prop.type === 'title' && prop.title.length > 0) {\n      productData.product_name = prop.title[0].plain_text;\n    }\n    else if (prop.type === 'rich_text' && prop.rich_text.length > 0) {\n      productData[key] = prop.rich_text[0].plain_text;\n    }\n    else if (prop.type === 'select' && prop.select) {\n      productData[key] = prop.select.name;\n    }\n    else if (prop.type === 'multi_select' && prop.multi_select) {\n      productData[key] = prop.multi_select.map(item => item.name);\n    }\n    else if (prop.type === 'number' && prop.number !== null) {\n      productData[key] = prop.number;\n    }\n  });\n} catch (error) {\n  // Provide fallback if property extraction fails\n  console.log('Error extracting properties:', error);\n  productData.error = error.message;\n}\n\n// Add a unique ID for tracking\nproductData.id = product.id;\n\n// Add an AI prompt for image generation\nif (productData.product_name && productData.description) {\n  productData.ai_prompt = `${productData.product_name} - ${productData.description}`;\n} else if (productData.product_name) {\n  productData.ai_prompt = productData.product_name;\n} else {\n  productData.ai_prompt = \"Balding Pig branded product, professional product photography\";\n}\n\nreturn [{ json: productData }];"
          },
          "id": "5c07045b-dbfc-46a3-8b1b-729309e02009"
        },
        {
          "name": "Generate Social Media Content",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -640,
            720
          ],
          "parameters": {
            "prompt": "Create social media posts for a product from our baldness-themed brand \"The Balding Pig\". Create one post each for LinkedIn, Instagram, TikTok and Facebook. Each post should be appropriate for the platform, have the right tone and length, and include relevant hashtags.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nTarget Demographics: {{ $json.target_demographics }}\n\nOur brand voice is confident, slightly humorous, and empowering for people experiencing hair loss. We celebrate baldness as a sign of confidence and character rather than something to be ashamed of.\n\nFormat each post clearly with the platform name as a header.",
            "options": {
              "maxTokens": 1000,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "00f7eb19-75c7-417a-bedf-90cad2c37c6a"
        },
        {
          "name": "Generate Product Description",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -420,
            920
          ],
          "parameters": {
            "prompt": "Create a detailed product description for an e-commerce website selling baldness-themed products. This is for our brand \"The Balding Pig\" which celebrates baldness with humor, confidence, and style.\n\nProduct Information:\nName: {{ $json.product_name }}\nDescription: {{ $json.description }}\nTagline: {{ $json.tagline }}\nProduct Type: {{ $json.product_type }}\nDesign Style: {{ $json.design_style }}\nColors Available: {{ $json.colours }}\nTarget Demographics: {{ $json.target_demographics }}\n\nThe product description should include:\n1. An attention-grabbing headline (max 60 characters)\n2. A 150-200 word main description that emphasizes benefits and features\n3. 3-5 bullet points highlighting key selling points\n4. A short closing statement with a call-to-action\n\nWrite in HTML format with appropriate tags for headings, paragraphs, and bullet points. The tone should be confident, slightly humorous, and empowering for people experiencing hair loss.",
            "options": {
              "maxTokens": 800,
              "temperature": 0.7
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "db2318d0-24cc-41ca-8239-d3fb1f716e39"
        },
        {
          "name": "Process MJ Response",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -420,
            1120
          ],
          "parameters": {
            "functionCode": "// Process the MJ response\nconst responseData = $input.item.json;\n\nlet result = {\n  success: false,\n  image_urls: [],\n  task_id: '',\n  error: ''\n};\n\ntry {\n  // Extract task ID\n  if (responseData.task_id) {\n    result.task_id = responseData.task_id;\n  } else if (responseData.id) {\n    result.task_id = responseData.id;\n  }\n  \n  // Extract image URLs\n  if (responseData.image_urls && Array.isArray(responseData.image_urls)) {\n    result.image_urls = responseData.image_urls;\n    result.success = true;\n  } else if (responseData.images && Array.isArray(responseData.images)) {\n    result.image_urls = responseData.images;\n    result.success = true;\n  } else if (responseData.image_url) {\n    // Single image URL\n    result.image_urls = [responseData.image_url];\n    result.success = true;\n  }\n  \n  // Try to get product ID from earlier nodes\n  try {\n    // Look for product ID in static data or previous node output\n    const productId = $workflow.staticData.currentProductId || $node[\"Extract Product Data\"].json.id;\n    result.product_id = productId;\n  } catch (e) {\n    console.log('Could not retrieve product ID from workflow data');\n  }\n  \n  // Check if we have any images\n  if (result.image_urls.length === 0) {\n    if (responseData.status === 'pending' || responseData.status === 'processing') {\n      result.error = 'Image generation is still in progress. Results will be delivered via webhook.';\n    } else {\n      result.error = 'No images were found in the response.';\n    }\n  }\n  \n} catch (error) {\n  result.error = `Error processing Midjourney response: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "9d98cf2d-b343-4636-86e6-bb4e9d52ef57"
        },
        {
          "name": "Select Best Image",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            20,
            1020
          ],
          "parameters": {
            "functionCode": "// Select the best image from the grid (defaults to first image)\nconst imageUrls = $json.image_urls;\n\nlet result = {\n  success: false,\n  image_url: '',\n  error: '',\n  product_id: $json.product_id\n};\n\ntry {\n  // Check if we have any images\n  if (imageUrls && imageUrls.length > 0) {\n    // Select the first image by default\n    result.image_url = imageUrls[0];\n    result.success = true;\n    \n    // Here you could implement more sophisticated image selection logic\n    // For example, you could analyze image dimensions, content, etc.\n    \n    // Store all available images in case they're needed\n    result.all_images = imageUrls;\n  } else {\n    result.error = 'No images available to select';\n  }\n} catch (error) {\n  result.error = `Error selecting image: ${error.message}`;\n}\n\nreturn [{ json: result }];"
          },
          "id": "40b94f3c-591f-4369-8200-14c08bfe7f11"
        },
        {
          "name": "Update Product in Notion",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            240,
            1020
          ],
          "parameters": {
            "operation": "updatePage"
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "0843240f-8ad8-41a7-9d52-5cc40f54e0ee"
        },
        {
          "name": "Save Social Content",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -420,
            720
          ],
          "parameters": {
            "functionCode": "// Save social media content for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    social_content: $json.text\n  }\n}];"
          },
          "id": "c3e1f3ff-bc96-4d3f-b44d-74f62cf10d4f"
        },
        {
          "name": "Save Product Description",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            -200,
            920
          ],
          "parameters": {
            "functionCode": "// Save product description for the product\nreturn [{\n  json: {\n    product_id: $node[\"Extract Product Data\"].json.id,\n    product_description: $json.text\n  }\n}];"
          },
          "id": "0abee95f-53bf-48bc-9830-9fe08e9a88b4"
        },
        {
          "name": "Is Image Available?",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            -200,
            1120
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.success }}",
                  "value2": "true"
                }
              ]
            }
          },
          "id": "3f3e2c8a-6e64-4bbe-9364-4d7f35cad82a"
        },
        {
          "name": "Workflow Notes",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -300,
            540
          ],
          "parameters": {
            "content": "# Balding Pig Product Generation with GoAPI - Direct Notion Storage\n\nThis workflow uses GoAPI to generate Midjourney images for products in Notion and then stores the image URLs directly back in Notion without using Cloudinary.\n\n## Before Running\n\n1. Make sure your Notion database has the following fields:\n   - Image URL (URL type)\n   - All Generated Images (Rich Text type)\n   - Status (Select type with 'Image Generated' option)\n\n2. Once you run the workflow for the first time, you'll get a webhook URL:\n   - Copy the URL from the \"MJ Response Webhook\" node\n   - Update the workflow's static data with this URL\n\n## Process Flow\n\n1. Gets products from Notion database\n2. Processes each product one by one\n3. Extracts product data\n4. Generates social media content and product descriptions\n5. Sends product info to GoAPI to generate Midjourney images\n6. Receives generated image grid through webhook\n7. Processes the response and selects the best image\n8. Updates the product in Notion with the image URL\n\n## Setup Webhook URL\n\nAfter the first run:\n1. Go to the \"MJ Response Webhook\" node and copy the webhook URL\n2. Update the workflow static data with this URL:\n\n```\n{\n  \"webhookUrl\": \"YOUR_MJ_RESPONSE_WEBHOOK_URL\"\n}\n```\n\nThe GoAPI works by taking your image generation request, processing it asynchronously, and then sending the results back via a webhook when it's complete.",
            "height": 420,
            "width": 632
          },
          "id": "ded4d241-ccb8-4965-84f2-7b0b717d1241"
        },
        {
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2,
          "position": [
            -1300,
            1020
          ],
          "parameters": {
            "path": "9373536c-3966-4cb9-b4f5-086e82553f6d",
            "options": {}
          },
          "id": "00ba4b43-718f-4a5f-aa49-dbf05eb5e1bf"
        },
        {
          "name": "go api midjourney api call",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -640,
            1120
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.goapi.ai/api/v1/task",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer 25a527222498cbd8e2af66a99d631fde92763cdf0c2a0997cc94b6d236ebea23"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"model\": \"midjourney\",\n  \"task_type\": \"imagine\",\n  \"input\": {\n    \"prompt\": \"simple test image, product on white background\"\n  }\n}",
            "options": {}
          },
          "id": "76c76e03-9c51-409e-840c-3d1b13f5411e"
        },
        {
          "name": "HTTP Request",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -640,
            920
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.goapi.ai/api/v1/task",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer 25a527222498cbd8e2af66a99d631fde92763cdf0c2a0997cc94b6d236ebea23"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"model\": \"midjourney\",\n  \"task_type\": \"imagine\",\n  \"input\": {\n    \"prompt\": \"simple test image, product on white background\"\n  }\n}",
            "options": {}
          },
          "id": "5b42c9f6-ce33-49fb-b840-478575df3f79"
        },
        {
          "name": "Gmail",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 2.1,
          "position": [
            20,
            1220
          ],
          "parameters": {
            "sendTo": "michael@rentasling.ie",
            "subject": "error in midjourney image creation",
            "message": "your image didnt process",
            "options": {}
          },
          "credentials": {
            "gmailOAuth2": {
              "id": "gp1NXWCFDSwhqabQ",
              "name": "Gmail account"
            }
          },
          "id": "36e73073-b31f-46e7-af3d-9bbd3b683173"
        }
      ],
      "connections": {
        "Schedule Trigger": {
          "main": [
            [
              {
                "node": "Get New Products",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get New Products": {
          "main": [
            [
              {
                "node": "Process Each Product",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process Each Product": {
          "main": [
            [
              {
                "node": "Extract Product Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Product Data": {
          "main": [
            [
              {
                "node": "Generate Social Media Content",
                "type": "main",
                "index": 0
              },
              {
                "node": "HTTP Request",
                "type": "main",
                "index": 0
              },
              {
                "node": "go api midjourney api call",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Social Media Content": {
          "main": [
            [
              {
                "node": "Save Social Content",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Product Description": {
          "main": [
            [
              {
                "node": "Save Product Description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Process MJ Response": {
          "main": [
            [
              {
                "node": "Is Image Available?",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Select Best Image": {
          "main": [
            [
              {
                "node": "Update Product in Notion",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Is Image Available?": {
          "main": [
            [
              {
                "node": "Select Best Image",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Gmail",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook": {
          "main": [
            [
              {
                "node": "Process Each Product",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "go api midjourney api call": {
          "main": [
            [
              {
                "node": "Process MJ Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request": {
          "main": [
            [
              {
                "node": "Generate Product Description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "693083fb-5ef0-4957-9f2c-28f52b78644f",
      "triggerCount": 2,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:39:00.611Z",
          "createdAt": "2025-11-02T02:39:00.611Z",
          "role": "workflow:owner",
          "workflowId": "ZC3sXHr8i6H6evHG",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-08T09:40:32Z",
      "createdAt": "2025-11-02T02:38:58.771Z",
      "id": "ZMHsS928BbmNWr7J",
      "name": "AI agent chat",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "options": {}
          },
          "name": "When chat message received",
          "type": "@n8n/n8n-nodes-langchain.chatTrigger",
          "typeVersion": 1.1,
          "position": [
            384,
            240
          ],
          "id": "5e3375f8-9eca-409d-bb0c-cf3e6182f8a3",
          "webhookId": "14b20147-bdc3-410f-b730-cc6ee9414338"
        },
        {
          "parameters": {},
          "name": "Simple Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            720,
            464
          ],
          "id": "43eeaa89-e3a2-4304-964e-02e687768bf9"
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4o-mini"
            },
            "options": {}
          },
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            592,
            464
          ],
          "id": "1c4f200d-8887-4aad-a3d8-16d0c0c362bd",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "options": {
              "gl": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Country', ``, 'string') }}",
              "device": "desktop",
              "no_cache": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Explicit_Array', ``, 'boolean') }}",
              "google_domain": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Google_Domain', ``, 'string') }}",
              "hl": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Language', ``, 'string') }}"
            }
          },
          "name": "SerpAPI",
          "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
          "typeVersion": 1,
          "position": [
            864,
            464
          ],
          "id": "f81f031e-f96c-4c2d-b224-c2f2ca073d2a",
          "credentials": {
            "serpApi": {
              "id": "yqXVynogTPdyOFhk",
              "name": "SerpAPI Account"
            }
          }
        },
        {
          "parameters": {
            "options": {}
          },
          "name": "AI Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.8,
          "position": [
            624,
            240
          ],
          "id": "6480d54d-00e8-4073-b728-31708d46fc45"
        },
        {
          "parameters": {
            "workflowId": {
              "__rl": true,
              "value": "JPidV93aXIdb6VyS",
              "mode": "list",
              "cachedResultUrl": "/workflow/JPidV93aXIdb6VyS",
              "cachedResultName": "multiflow decision process"
            },
            "workflowInputs": {
              "mappingMode": "defineBelow",
              "value": {}
            }
          },
          "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
          "typeVersion": 2.2,
          "position": [
            928,
            480
          ],
          "id": "a519e16e-4fa8-465b-8e15-efd63cbcba77",
          "name": "Call 'multiflow decision process'"
        }
      ],
      "connections": {
        "SerpAPI": {
          "ai_tool": [
            [
              {
                "node": "AI Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "AI Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "When chat message received": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Call 'multiflow decision process'": {
          "ai_tool": [
            [
              {
                "node": "AI Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": null,
      "pinData": {},
      "versionId": "1e5d7e9b-fc56-481b-b239-68e29a899d5c",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:38:58.775Z",
          "createdAt": "2025-11-02T02:38:58.775Z",
          "role": "workflow:owner",
          "workflowId": "ZMHsS928BbmNWr7J",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-29T03:28:14Z",
      "createdAt": "2025-11-01T14:37:00.134Z",
      "id": "ZOjhBk4SWtGBYy4G",
      "name": "E-commerce Test Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "webhook-test",
            "options": {}
          },
          "id": "webhook-trigger",
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            240,
            300
          ],
          "webhookId": "test-webhook"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-paid-orders",
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            460,
            300
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"order_id\": $json.order_id, \"customer_email\": $json.customer_email, \"amount\": $json.amount, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "log-to-sheets",
          "name": "Log Order (Sheets Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            240
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"lead_data\": { \"name\": $json.customer_name, \"email\": $json.customer_email, \"source\": \"ecommerce_order\" }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "create-lead",
          "name": "Create Lead (Salesforce Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            680,
            360
          ]
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://httpbin.org/post",
            "options": {
              "headers": {
                "Content-Type": "application/json"
              }
            },
            "body": {
              "mode": "json",
              "json": "={{ { \"email_data\": { \"to\": $json.customer_email, \"subject\": \"Order Confirmation\", \"body\": \"Thank you for your order #\" + $json.order_id }, \"timestamp\": new Date().toISOString() } }}"
            }
          },
          "id": "send-email",
          "name": "Send Email (Gmail Simulation)",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4,
          "position": [
            900,
            300
          ]
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Log Order (Sheets Simulation)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Lead (Salesforce Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Log Order (Sheets Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Lead (Salesforce Simulation)": {
          "main": [
            [
              {
                "node": "Send Email (Gmail Simulation)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "def5e9c6-75d4-49c2-aaf5-ac80a317d4af",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:37:00.138Z",
          "createdAt": "2025-11-01T14:37:00.138Z",
          "role": "workflow:owner",
          "workflowId": "ZOjhBk4SWtGBYy4G",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:46Z",
      "createdAt": "2025-11-01T14:40:19.271Z",
      "id": "aC4crladZeIJ2niU",
      "name": "My workflow 15",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Trigger",
          "type": "n8n-nodes-base.trigger",
          "typeVersion": 1,
          "position": [
            160,
            260
          ],
          "parameters": {},
          "id": "8f9d4e82-063b-494d-9428-3424df04b6be"
        },
        {
          "name": "File Upload",
          "type": "n8n-nodes-base.fileUpload",
          "typeVersion": 1,
          "position": [
            360,
            260
          ],
          "parameters": {},
          "id": "2cfcd9c3-6c00-409e-83cf-3cf52d96669d"
        },
        {
          "name": "Parse Transactions",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            560,
            260
          ],
          "parameters": {
            "jsCode": "// Parse bank transaction data\nconst items = [];\nconst fileContent = $input.item.binary.data.data;\n\n// Handle CSV format\nif ($input.item.json.mimeType.includes('csv')) {\n  const lines = fileContent.toString().split('\\n');\n  const headers = lines[0].split(',');\n  \n  for (let i = 1; i < lines.length; i++) {\n    if (lines[i].trim()) {\n      const values = lines[i].split(',');\n      const transaction = {};\n      headers.forEach((header, index) => {\n        transaction[header.trim()] = values[index]?.trim();\n      });\n      items.push({ json: transaction });\n    }\n  }\n}\n\n// Handle JSON format\nif ($input.item.json.mimeType.includes('json')) {\n  const data = JSON.parse(fileContent.toString());\n  const transactions = Array.isArray(data) ? data : [data];\n  transactions.forEach(t => items.push({ json: t }));\n}\n\nreturn items;"
          },
          "id": "7f0bc2d2-a68f-440c-b8d0-c0695d719d1f"
        },
        {
          "name": "Claude Categorizer",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1,
          "position": [
            760,
            260
          ],
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "options": {}
          },
          "id": "8b2cda9b-9b71-4ca1-a979-b66e43572e69"
        },
        {
          "name": "Check Match",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2,
          "position": [
            960,
            260
          ],
          "parameters": {
            "conditions": {
              "boolean": [
                {
                  "value1": "={{ JSON.parse($json.content).matched }}",
                  "value2": true
                }
              ]
            },
            "options": {}
          },
          "id": "d0cd4b56-8745-4ffd-914b-79b40617584f"
        },
        {
          "name": "Apply Rule",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1160,
            200
          ],
          "parameters": {
            "jsCode": "// Extract the rule from Claude's response\nconst response = JSON.parse($json.content);\nconst transaction = $input.item.json;\n\n// Create QuickBooks-compatible rule\nconst rule = response.rule || {\n  \"Rule Name\": `${transaction.vendor} - ${response.category}`,\n  \"Rule Conditions\": {\n    \"ruleConditions\": [\n      { \"ruleType\": 10, \"value\": transaction.type === 'income' ? \"1\" : \"-1\" },\n      { \"ruleType\": 1, \"value\": transaction.vendor }\n    ],\n    \"isAndRule\": true\n  },\n  \"Rule Outputs\": {\n    \"ruleActions\": [\n      { \"actionType\": 0, \"value\": response.category }\n    ]\n  }\n};\n\nreturn {\n  json: {\n    transaction: transaction,\n    rule: rule,\n    confidence: response.confidence,\n    appliedRule: true\n  }\n};"
          },
          "id": "2024cbc4-1a25-4994-a27f-8ee904e9159b"
        },
        {
          "name": "Prepare Question",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3,
          "position": [
            1160,
            300
          ],
          "parameters": {
            "options": {}
          },
          "id": "d1dd6806-f166-441c-ae18-72b747900ff0"
        },
        {
          "name": "Send Clarification",
          "type": "n8n-nodes-base.slack",
          "typeVersion": 2.1,
          "position": [
            1360,
            300
          ],
          "parameters": {
            "otherOptions": {}
          },
          "id": "54f2764d-5b1a-4e13-9e93-a75b13e026e1"
        },
        {
          "name": "Save to Sheet",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4,
          "position": [
            1360,
            200
          ],
          "parameters": {
            "operation": "append",
            "documentId": {
              "__rl": true,
              "value": "YOUR_GOOGLE_SHEET_ID",
              "mode": "string"
            },
            "sheetName": "Rules",
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Rule Name": "={{ $json.rule['Rule Name'] }}",
                "Rule Conditions": "={{ JSON.stringify($json.rule['Rule Conditions']) }}",
                "Rule Outputs": "={{ JSON.stringify($json.rule['Rule Outputs']) }}",
                "Confidence": "={{ $json.confidence }}",
                "Applied Date": "={{ new Date().toISOString() }}"
              }
            },
            "options": {}
          },
          "id": "653ad41b-0a51-45a8-b6fc-26a78260f88d"
        },
        {
          "name": "Load Rules",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            560,
            100
          ],
          "parameters": {
            "jsCode": "// Load existing rules from various sources\nconst rules = [];\nconst vendorMappings = {\n  // AI & Software\n  \"Elevenlabs\": \"AI Services\",\n  \"Wondr AI\": \"AI Services\", \n  \"Midjourney\": \"AI Services\",\n  \"Runway\": \"AI Services\",\n  \"Musicfy\": \"AI Services\",\n  \"Pika Art\": \"AI Services\",\n  \"ChatGPT\": \"AI Services\",\n  \"Claude\": \"AI Services\",\n  \"Suno AI\": \"AI Services\",\n  \n  // SaaS & Software\n  \"Spotify AB\": \"Entertainment\",\n  \"Canva\": \"Marketing & Design\",\n  \"Notion Labs Inc\": \"Software Subscriptions\",\n  \"Google\": \"Software Subscriptions\",\n  \"Google Play\": \"Software Subscriptions\",\n  \"Microsoft Ireland Operations\": \"Software Subscriptions\",\n  \"Intuit\": \"Accounting Software\",\n  \"Stripe\": \"Payment Processing\",\n  \"Paypal\": \"Payment Processing\",\n  \"Paddle\": \"SaaS\",\n  \n  // Food & Groceries\n  \"Aldi\": \"Groceries\",\n  \"Lidl\": \"Groceries\", \n  \"Spar\": \"Groceries\",\n  \"Tesco\": \"Groceries\",\n  \"Deliveroo\": \"Meals & Entertainment\",\n  \"Just Eat\": \"Meals & Entertainment\",\n  \"FREE NOW\": \"Transportation\",\n  \n  // Utilities\n  \"Energia\": \"Utilities\",\n  \"Electric Ireland\": \"Utilities\",\n  \"Three Ireland Hutchison\": \"Telecommunications\",\n  \"Eir\": \"Telecommunications\",\n  \"Vodafone\": \"Telecommunications\",\n  \n  // E-commerce\n  \"Amazon\": \"E-commerce\",\n  \"Temu\": \"E-commerce\",\n  \"Shopify\": \"E-commerce expense\",\n  \n  // Other\n  \"Payzone\": \"Financial Services\",\n  \"RBS\": \"Bank Fees\",\n  \"AIB\": \"Bank Fees\"\n};\n\n// Convert mappings to rules\nfor (const [vendor, category] of Object.entries(vendorMappings)) {\n  rules.push({\n    \"Rule Name\": `${vendor} - ${category}`,\n    \"Rule Conditions\": {\n      \"ruleConditions\": [\n        { \"ruleType\": 10, \"value\": \"-1\" },\n        { \"ruleType\": 1, \"value\": vendor }\n      ],\n      \"isAndRule\": true\n    },\n    \"Rule Outputs\": {\n      \"ruleActions\": [\n        { \"actionType\": 0, \"value\": category }\n      ]\n    }\n  });\n}\n\nreturn {\n  json: {\n    rules: rules,\n    vendorMappings: vendorMappings\n  }\n};"
          },
          "id": "a4c73844-b537-48b6-983f-44432a0da50a"
        },
        {
          "name": "Schedule Check",
          "type": "n8n-nodes-base.googleCalendar",
          "typeVersion": 2,
          "position": [
            160,
            100
          ],
          "parameters": {},
          "executeOnce": true,
          "id": "05b30b73-a7ad-43c6-b3c8-10f4da711d9c"
        },
        {
          "name": "Workflow Info",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "content": "## 🎯 Intelligent Financial Rule Engine\n\nThis workflow automatically categorizes bank transactions using:\n1. **Historical patterns** from Booke.ai audit logs\n2. **Existing QuickBooks rules** \n3. **Claude AI** for intelligent matching\n4. **Human feedback** for unknown vendors\n\n### Features:\n- ✅ Auto-learns from 327+ historical transactions\n- ✅ Matches vendors like Spotify, Canva, Paddle\n- ✅ Asks clarifying questions via Slack\n- ✅ Exports QuickBooks-compatible rules\n- ✅ Continuously improves accuracy",
            "height": 300,
            "width": 400
          },
          "id": "32a49da0-7b36-40db-9b7f-81d42917e437"
        },
        {
          "name": "Google Drive Trigger",
          "type": "n8n-nodes-base.googleDriveTrigger",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "pollTimes": {
              "item": [
                {
                  "mode": "everyWeek",
                  "hour": 10,
                  "weekday": "5"
                }
              ]
            },
            "triggerOn": "specificFolder",
            "folderToWatch": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "cISWm5eOll9FnV3g",
              "name": "Google Drive account"
            }
          },
          "id": "9976b9e1-b113-4b26-b94b-5d74af4c0a69"
        }
      ],
      "connections": {},
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "63ca9921-0a3a-4042-a99d-11dcdae30f7e",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:19.273Z",
          "createdAt": "2025-11-01T14:40:19.273Z",
          "role": "workflow:owner",
          "workflowId": "aC4crladZeIJ2niU",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-08T09:58:53.939Z",
      "createdAt": "2025-10-31T03:45:41.888Z",
      "id": "aqp1UaeSfV2e9Y0u",
      "name": "Tool Registry Refresh (04:00)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 4 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 04:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "3fda6a38-6e42-43ee-a181-82efa578ebb1"
        },
        {
          "parameters": {
            "operation": "getAll",
            "base": "a6eeff00-2c5a-4fb0-be1c-d8d15712a58e",
            "returnAll": true
          },
          "name": "Get All Tools",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            450,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "db09654a-0341-441e-84dc-b48b9323296f"
        },
        {
          "parameters": {
            "functionCode": "// Check tool status and update reliability\nconst tool = $input.item.json;\nconst now = new Date();\n\n// Mock health check (replace with actual API calls)\nconst isHealthy = Math.random() > 0.1; // 90% uptime simulation\n\nconst updatedTool = {\n  id: tool.id,\n  reliability_score: isHealthy ? Math.min(tool.ReliabilityScore + 1, 100) : Math.max(tool.ReliabilityScore - 5, 0),\n  status: isHealthy ? 'Active' : 'Degraded',\n  last_checked: now.toISOString()\n};\n\nreturn [{ json: updatedTool }];"
          },
          "name": "Check Tool Health",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "id": "6354b104-981e-4e35-a939-2e1c2f93cb4d"
        },
        {
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.id}}",
            "properties": {
              "ReliabilityScore": "={{$json.reliability_score}}",
              "Status": "={{$json.status}}"
            }
          },
          "name": "Update Tool Registry",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "4125b56a-958c-47fc-a42f-c4c469ba6940"
        }
      ],
      "connections": {
        "Schedule Trigger - 04:00": {
          "main": [
            [
              {
                "node": "Get All Tools",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get All Tools": {
          "main": [
            [
              {
                "node": "Check Tool Health",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Tool Health": {
          "main": [
            [
              {
                "node": "Update Tool Registry",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 04:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": {},
      "versionId": "f2d383ff-edf9-4aed-b1f8-a671d46437c3",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-31T03:45:41.89Z",
          "createdAt": "2025-10-31T03:45:41.89Z",
          "role": "workflow:owner",
          "workflowId": "aqp1UaeSfV2e9Y0u",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:21Z",
      "createdAt": "2025-11-01T14:40:26.962Z",
      "id": "d5raws2BAaBMn4wQ",
      "name": "Customer Experience Agent",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Customer Experience Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -440,
            140
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Customer Experience Agent, dedicated to providing exceptional support throughout the custom gadget journey. You help customers from initial inquiry through delivery and beyond, ensuring each interaction reflects our artisanal craftsmanship values.\n\n## Tools Available\n\n### Airtable CRM\n- Manage customer accounts\n- Track order history\n- Monitor satisfaction scores\n- Document special requests\n\n### Gmail Communication\n- Send order updates\n- Provide care instructions\n- Share progress photos\n- Handle inquiries\n\n### Slack Support Channel\n- Real-time customer assistance\n- Quick issue resolution\n- Success story sharing\n\n### Google Sheets Order Tracking\n- Order status updates\n- Delivery tracking\n- Custom modification logs\n\n### Knowledge Base Access\n- Care guides\n- FAQ responses\n- Troubleshooting steps\n\n## Key Support Areas\n\n### Order Journey Support\n- Design consultation\n- Customization guidance\n- Progress updates\n- Delivery coordination\n\n### Product Care\n- Maintenance instructions\n- Patina preservation\n- Mechanism care\n- Repair guidance\n\n### Customer Success\n- Personalization ideas\n- Display suggestions\n- Gift recommendations\n- Collection building\n\n## Customer Experience Standards\n- Response time: <4 hours\n- Update frequency: Weekly\n- Photo updates: At key stages\n- Satisfaction target: 95%+\n\n## Common Inquiries\n### Pre-Order\n- Customization options\n- Material choices\n- Timeline estimates\n- Pricing questions\n\n### During Production\n- Status updates\n- Modification requests\n- Progress photos\n- Delivery timing\n\n### Post-Delivery\n- Care instructions\n- Display ideas\n- Minor adjustments\n- Future orders\n\nAlways emphasize the handcrafted, unique nature of each piece.\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "9bcf2f27-e51d-4d99-99e7-f31e5c86c2b9"
        },
        {
          "name": "Anthropic Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1.2,
          "position": [
            -560,
            360
          ],
          "parameters": {
            "options": {}
          },
          "id": "f6b0230e-3e4b-4312-9c68-a8b67ec2b73a"
        },
        {
          "name": "Send Customer Email",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            -400,
            400
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"customerEmail\") }}",
            "subject": "={{ $fromAI(\"emailSubject\", \"Your RetroFuture Gadget Update\") }}",
            "message": "={{ $fromAI(\"emailBody\") }}",
            "options": {}
          },
          "id": "6cd09181-11db-47de-8dea-2621a4d2d64e"
        },
        {
          "name": "Get Order History",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            -240,
            380
          ],
          "parameters": {
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "affecfcf-50e6-4587-bafe-e9ec06a2ab26"
        },
        {
          "name": "Update Customer Record",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            -80,
            380
          ],
          "parameters": {
            "operation": "update",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "38a0fb3c-b447-461f-9169-5e5bcd7ac38a"
        },
        {
          "name": "Generate Care Guide",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -760,
            980
          ],
          "parameters": {
            "toolDescription": "Generate care instructions for gadget",
            "method": "POST",
            "url": "https://api.retrofuturegadgetry.com/v1/support/care-guide",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"productType\": \"{productType}\",\n  \"materials\": {materials},\n  \"features\": {features},\n  \"includeVideo\": {includeVideo}\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "productType",
                  "description": "Type of gadget",
                  "type": "string"
                },
                {
                  "name": "materials",
                  "description": "Materials used",
                  "type": "json"
                },
                {
                  "name": "features",
                  "description": "Special features",
                  "type": "json"
                },
                {
                  "name": "includeVideo",
                  "description": "Include video guide link",
                  "type": "boolean"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "aaf74440-ebc5-4d60-8f3a-7e31d6674dd4"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            20,
            40
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "b79e59cb-fdc5-4d70-a43f-c5ff7bd83717"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            20,
            240
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process customer experience request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "09f531b1-7d25-4611-ba97-a2ec581a6f7c"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -760,
            140
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "e0162f8f-1109-4e2e-84a1-648b2df4b723"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Customer Experience Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Anthropic Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Customer Experience Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Send Customer Email": {
          "ai_tool": [
            [
              {
                "node": "Customer Experience Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Get Order History": {
          "ai_tool": [
            [
              {
                "node": "Customer Experience Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Update Customer Record": {
          "ai_tool": [
            [
              {
                "node": "Customer Experience Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Generate Care Guide": {
          "ai_tool": [
            []
          ]
        },
        "Customer Experience Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "af4d5291-02d5-446f-9980-1bccaed78da1",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:26.963Z",
          "createdAt": "2025-11-01T14:40:26.963Z",
          "role": "workflow:owner",
          "workflowId": "d5raws2BAaBMn4wQ",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:36:58.963Z",
      "createdAt": "2025-11-01T14:36:58.963Z",
      "id": "dPKB9hFfZ5MPk69m",
      "name": "Midjourney Automation Receiver",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-automation",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "webhook-1",
          "name": "Webhook - Midjourney Data",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "webhookId": "midjourney-automation"
        },
        {
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "article_title",
                  "value": "={{ $json.article.title }}"
                },
                {
                  "name": "article_url",
                  "value": "={{ $json.article.url }}"
                },
                {
                  "name": "social_content",
                  "value": "={{ $json.socialPost.content }}"
                },
                {
                  "name": "image_url",
                  "value": "={{ $json.midjourney.imageUrl }}"
                },
                {
                  "name": "prompt",
                  "value": "={{ $json.midjourney.prompt }}"
                },
                {
                  "name": "timestamp",
                  "value": "={{ $json.timestamp }}"
                }
              ]
            },
            "options": {}
          },
          "id": "set-1",
          "name": "Extract Data",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            450,
            300
          ]
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.midjourney.status }}",
                  "operation": "equals",
                  "value2": "completed"
                }
              ]
            }
          },
          "id": "if-1",
          "name": "Check Status",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            650,
            300
          ]
        },
        {
          "parameters": {
            "resource": "sheet",
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": "YOUR_GOOGLE_SHEET_ID"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Timestamp": "={{ $json.timestamp }}",
                "Article Title": "={{ $json.article_title }}",
                "Article URL": "={{ $json.article_url }}",
                "Social Content": "={{ $json.social_content }}",
                "Midjourney Prompt": "={{ $json.prompt }}",
                "Image URL": "={{ $json.image_url }}"
              }
            },
            "options": {}
          },
          "id": "google-sheets-1",
          "name": "Save to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 3,
          "position": [
            850,
            200
          ]
        },
        {
          "parameters": {
            "fromEmail": "michael@rentasling.ie",
            "toEmail": "your-email@example.com",
            "subject": "New Midjourney Image Generated",
            "emailType": "html",
            "message": "=<h2>New Content Generated</h2><p><strong>Article:</strong> {{ $json.article_title }}</p><p><strong>Social Post:</strong><br>{{ $json.social_content }}</p><p><strong>Midjourney Prompt:</strong><br>{{ $json.prompt }}</p><p><strong>Image:</strong><br><img src=\"{{ $json.image_url }}\" style=\"max-width:600px;\"></p><hr><p><a href=\"{{ $json.article_url }}\">View Original Article</a></p>",
            "options": {}
          },
          "id": "email-1",
          "name": "Send Email Notification",
          "type": "n8n-nodes-base.emailSend",
          "typeVersion": 2,
          "position": [
            850,
            400
          ]
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ { \"success\": true, \"message\": \"Data received and processed\", \"timestamp\": $json.timestamp } }}",
            "options": {}
          },
          "id": "respond-1",
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ]
        }
      ],
      "connections": {
        "Webhook - Midjourney Data": {
          "main": [
            [
              {
                "node": "Extract Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Data": {
          "main": [
            [
              {
                "node": "Check Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Status": {
          "main": [
            [
              {
                "node": "Save to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Send Email Notification",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Google Sheets": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Email Notification": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "9406985d-272f-40f7-bc52-f494e54bcc19",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:58.966Z",
          "createdAt": "2025-11-01T14:36:58.966Z",
          "role": "workflow:owner",
          "workflowId": "dPKB9hFfZ5MPk69m",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:23.9Z",
      "createdAt": "2025-11-01T14:40:23.9Z",
      "id": "eBhrXHFP4Hhjamkn",
      "name": "review of transactions",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "WellyBox Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            560,
            -40
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "wellybox-webhook",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "37c759f9-6f43-4cd2-b537-b1e67f36ff08"
        },
        {
          "name": "Receipt Parser Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            780,
            -40
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 1500,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are the Rule Extraction Agent. Analyze Booke.ai historical transaction data to generate classification rules.\\n\\nHISTORICAL DATA: {{ $json | json }}\\n\\nEXTRACT PATTERNS FOR:\\n- Merchant name patterns\\n- Amount ranges\\n- Description keywords\\n- Category mappings\\n- VAT rates\\n- Business vs personal flags\\n\\nOUTPUT FORMAT:\\n{\\n  \\\"rules\\\": [\\n    {\\n      \\\"rule_id\\\": \\\"R001\\\",\\n      \\\"conditions\\\": {\\n        \\\"merchant_pattern\\\": \\\"regex_or_exact\\\",\\n        \\\"amount_range\\\": {\\\"min\\\": 0, \\\"max\\\": 1000},\\n        \\\"description_keywords\\\": [\\\"keyword1\\\", \\\"keyword2\\\"]\\n      },\\n      \\\"classification\\\": {\\n        \\\"category\\\": \\\"Office Supplies\\\",\\n        \\\"vat_rate\\\": 20,\\n        \\\"flags\\\": [\\\"taxable\\\", \\\"business_expense\\\"],\\n        \\\"confidence\\\": 0.85\\n      }\\n    }\\n  ]\\n}\\n\\nReturn only valid JSON with extracted rules.\"\n    }\n  ]\n}",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "ab76e2d0-b37a-4cc0-8d31-58d8b84cd5b3"
        },
        {
          "name": "Rule Extraction Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            1220,
            -220
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\", \n  \"max_tokens\": 100,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Extract 1 rule from this data: {{ $json.payee }} - {{ $json.category }}. Return JSON: {\\\"rule\\\": \\\"simple pattern\\\"}\"\n    }\n  ]\n}",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "9605616a-a135-4eaa-a200-c42cd303a123"
        },
        {
          "name": "Transaction Matcher Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            1220,
            -40
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 1000,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are the Transaction Matcher Agent. Match WellyBox receipts to bank transactions using fuzzy logic.\\n\\nINPUT:\\n- RECEIPT DATA: {{ $json }}\\n- BANK FEED DATA: Available in workflow\\n\\nMATCHING CRITERIA:\\n1. Amount exact match (±2% tolerance)\\n2. Date proximity (±3 days)\\n3. Merchant name similarity (>80%)\\n4. Description keywords\\n\\nCONFIDENCE SCORING:\\n- 95%+: Exact amount + date + merchant\\n- 85%+: Exact amount + date, partial merchant\\n- 75%+: Close amount + date + merchant\\n- <75%: Flag for review\\n\\nOUTPUT FORMAT:\\n{\\n  \\\"match_found\\\": true,\\n  \\\"matched_transaction\\\": {},\\n  \\\"match_confidence\\\": 0.85,\\n  \\\"reasoning\\\": \\\"explanation here\\\"\\n}\\n\\nReturn only valid JSON.\"\n    }\n  ]\n}",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "4fede9aa-3f26-4877-a13b-a9a0a9122bba"
        },
        {
          "name": "Classification Engine",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            1440,
            -40
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 1000,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are the Classification Engine. Apply learned rules to categorize business transactions.\\n\\nINPUT:\\n- MATCHED TRANSACTION: Sample transaction data will be provided\\n- AVAILABLE RULES: Sample rules will be provided\\n\\nCLASSIFICATION TYPES:\\n- Internal Transfer (between own accounts)\\n- Personal Use (non-business)\\n- Business Expense (with VAT %)\\n- Reimbursable (employee expenses)\\n\\nRULE APPLICATION ORDER:\\n1. Exact merchant matches\\n2. Amount-based patterns\\n3. Description keyword analysis\\n4. Date/time context\\n5. Default to most frequent pattern for similar transactions\\n\\nOUTPUT FORMAT:\\n{\\n  \\\"category\\\": \\\"Office Supplies\\\",\\n  \\\"vat_rate\\\": 20,\\n  \\\"flags\\\": [\\\"taxable\\\", \\\"business_expense\\\"],\\n  \\\"classification_confidence\\\": 0.87,\\n  \\\"applied_rule_id\\\": \\\"R001\\\",\\n  \\\"reasoning\\\": \\\"explanation of why this rule applied\\\"\\n}\\n\\nALWAYS explain which rule triggered and why. Return only valid JSON.\"\n    }\n  ]\n}",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "32e55a0f-74f7-4252-974e-b7507ee0813f"
        },
        {
          "name": "Confidence Router",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1660,
            -40
          ],
          "parameters": {
            "conditions": {
              "number": [
                {
                  "value1": "={{ JSON.parse($('Classification Engine').first().json.content[0].text).classification_confidence }}",
                  "operation": "largerEqual",
                  "value2": 0.75
                }
              ]
            }
          },
          "id": "ebd24fb1-0f4a-4fdc-a648-3a6dbf1a06db"
        },
        {
          "name": "Explainer Agent",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            1880,
            -140
          ],
          "parameters": {
            "method": "POST",
            "url": "https://api.anthropic.com/v1/messages",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "anthropicApi",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                },
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 1000,\n  \"temperature\": 0.3,\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are the Explainer Agent. Generate a human-readable audit trail explanation for a business transaction classification.\\n\\nINPUT:\\n- CLASSIFIED TRANSACTION: {{ $('Classification Engine').first().json.content[0].text }}\\n- ORIGINAL RECEIPT: {{ $('Receipt Parser Agent').first().json.content[0].text }}\\n- MATCHED BANK TRANSACTION: {{ $('Transaction Matcher Agent').first().json.content[0].text }}\\n\\nINSTRUCTIONS:\\n1. Explain how the receipt matched the bank transaction (amount, date, merchant).\\n2. Describe the rule that was applied and why.\\n3. Clarify confidence level and logic behind it.\\n4. Break down VAT calculation if applicable.\\n5. List any flags (personal use, internal transfer, reimbursable).\\n\\nOUTPUT FORMAT (JSON only):\\n{\\n  \\\"audit_trail\\\": \\\"Human readable explanation...\\\",\\n  \\\"decision_summary\\\": \\\"Brief summary of classification and reasoning\\\",\\n  \\\"traceability\\\": {\\n    \\\"receipt_id\\\": \\\"...\\\",\\n    \\\"bank_transaction_id\\\": \\\"...\\\",\\n    \\\"rule_applied\\\": \\\"R001\\\",\\n    \\\"timestamp\\\": \\\"{{ new Date().toISOString() }}\\\",\\n    \\\"confidence_score\\\": 0.87\\n  }\\n}\\n\\nReturn only valid JSON in the specified structure.\"\n    }\n  ]\n}\n",
            "options": {}
          },
          "credentials": {
            "anthropicApi": {
              "id": "JJwrhlu8BrgsIzvC",
              "name": "Anthropic account"
            }
          },
          "id": "564abc1c-1f5b-4d65-901a-ce5ab9b022bd"
        },
        {
          "name": "Save Audit Log",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            2100,
            -140
          ],
          "parameters": {
            "tableId": "transaction_audit_log"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "e0260c5d-f5d5-410a-816f-eacf24010012"
        },
        {
          "name": "Get Booke History",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            780,
            -220
          ],
          "parameters": {
            "tableId": "booke_transaction_history"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "60417cfb-0202-4637-a2b7-d233c9f3c818"
        },
        {
          "name": "Get Bank Feeds",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            1000,
            -40
          ],
          "parameters": {
            "tableId": "bank_feed_data"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "f83c8303-a632-4c3b-b96b-64ff8b433193"
        },
        {
          "name": "Webhook Response",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            2320,
            -40
          ],
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "id": "3d008104-5009-448e-93e9-1ad92583f43b"
        },
        {
          "name": "Queue for Human Review",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            1940,
            140
          ],
          "parameters": {
            "tableId": "human_review_queue"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "cf0f2335-8173-44ab-8c85-2eabe520002f"
        },
        {
          "name": "Supabase",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            1000,
            -220
          ],
          "parameters": {
            "operation": "getAll",
            "tableId": "historical_transactions"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "bd07b42e-081f-463a-a830-1d7baae1708b"
        }
      ],
      "connections": {
        "WellyBox Webhook": {
          "main": [
            [
              {
                "node": "Receipt Parser Agent",
                "type": "main",
                "index": 0
              },
              {
                "node": "Get Booke History",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Receipt Parser Agent": {
          "main": [
            [
              {
                "node": "Get Bank Feeds",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Booke History": {
          "main": [
            [
              {
                "node": "Supabase",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Bank Feeds": {
          "main": [
            [
              {
                "node": "Transaction Matcher Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Transaction Matcher Agent": {
          "main": [
            [
              {
                "node": "Classification Engine",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Classification Engine": {
          "main": [
            [
              {
                "node": "Confidence Router",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Confidence Router": {
          "main": [
            [
              {
                "node": "Explainer Agent",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Queue for Human Review",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Explainer Agent": {
          "main": [
            [
              {
                "node": "Save Audit Log",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Audit Log": {
          "main": [
            [
              {
                "node": "Webhook Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Supabase": {
          "main": [
            [
              {
                "node": "Rule Extraction Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "d5480301-061d-42c9-adea-b2e62f210276",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:23.902Z",
          "createdAt": "2025-11-01T14:40:23.902Z",
          "role": "workflow:owner",
          "workflowId": "eBhrXHFP4Hhjamkn",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-29T03:27:41Z",
      "createdAt": "2025-11-27T21:34:35.738Z",
      "id": "ejUB1CauLpACddus",
      "name": "Generate AI viral videos with NanoBanana & VEO3, shared on socials via Blotato",
      "active": false,
      "isArchived": true,
      "nodes": [
        {
          "id": "101bdee1-4de4-4b5e-9170-4d490d4e8128",
          "name": "Sticky Note3",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2320,
            880
          ],
          "parameters": {
            "color": 4,
            "width": 1344,
            "height": 832,
            "content": "# 📑 STEP 5 — Auto-Post to All Platforms\n\n"
          },
          "typeVersion": 1
        },
        {
          "id": "db2db976-7988-4939-a931-b6b2b98570aa",
          "name": "Upload Video to BLOTATO",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2384,
            1504
          ],
          "parameters": {
            "mediaUrl": "={{ $('Download Video from VEO3').item.json.data.response.resultUrls[0] }}",
            "resource": "media"
          },
          "typeVersion": 2
        },
        {
          "id": "6866a654-e6a7-4543-b98a-8288f9d04b47",
          "name": "Youtube",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1296
          ],
          "parameters": {
            "options": {},
            "platform": "youtube",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "8047",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/8047",
              "cachedResultName": "DR FIRASS (Dr. Firas)"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}",
            "postCreateYoutubeOptionTitle": "={{ $('Save Caption Video to Google Sheets').item.json['TITRE VIDEO'] }}",
            "postCreateYoutubeOptionPrivacyStatus": "private",
            "postCreateYoutubeOptionShouldNotifySubscribers": false
          },
          "typeVersion": 2
        },
        {
          "id": "a1b51932-2e2c-4e32-a37a-7ce94620cdd9",
          "name": "Tiktok",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1120
          ],
          "parameters": {
            "options": {},
            "platform": "tiktok",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "9332",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/9332",
              "cachedResultName": "docteur.firas"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "2c6cb6a6-e4b2-470d-8afb-b2c03b72e97b",
          "name": "Merge",
          "type": "n8n-nodes-base.merge",
          "position": [
            3296,
            1200
          ],
          "parameters": {
            "mode": "chooseBranch",
            "numberInputs": 9
          },
          "typeVersion": 3.2
        },
        {
          "id": "bee496d6-fc2d-4f1c-812f-9d6be08154a7",
          "name": "Update Status to \"DONE\"",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            3472,
            1312
          ],
          "parameters": {
            "columns": {
              "value": {
                "STATUS": "Published",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {},
            "operation": "appendOrUpdate",
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "typeVersion": 4.5
        },
        {
          "id": "5f7344d8-a277-457b-a33f-c48e2ced1e49",
          "name": "Linkedin",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1120
          ],
          "parameters": {
            "options": {},
            "platform": "linkedin",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "1446",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1446",
              "cachedResultName": "Samuel Amalric"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "31bc2347-2457-4fad-8436-09282df89609",
          "name": "Facebook",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1120
          ],
          "parameters": {
            "options": {},
            "platform": "facebook",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "1759",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759",
              "cachedResultName": "Firass Ben"
            },
            "facebookPageId": {
              "__rl": true,
              "mode": "list",
              "value": "101603614680195",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759/subaccounts/101603614680195",
              "cachedResultName": "Dr. Firas"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "06e29e46-c3ce-4c9e-825d-39df924a607d",
          "name": "Instagram",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1296
          ],
          "parameters": {
            "options": {},
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "11892",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/11892",
              "cachedResultName": "doc.firass"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "3f7560c8-3e4a-4d62-bf62-e8d543df8026",
          "name": "Threads",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1504
          ],
          "parameters": {
            "options": {},
            "platform": "threads",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "2280",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/2280",
              "cachedResultName": "doc.firass"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "3e4b6251-7c56-40ca-8fb6-4b77c910a2e6",
          "name": "Bluesky",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1504
          ],
          "parameters": {
            "options": {},
            "platform": "bluesky",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "6012",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/6012",
              "cachedResultName": "formationinternet.bsky.social"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "61f5f513-b7ec-40ca-a4a1-1b897f092a04",
          "name": "Pinterest",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1504
          ],
          "parameters": {
            "options": {},
            "platform": "pinterest",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "363",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/363",
              "cachedResultName": "formationinternet2022"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "pinterestBoardId": {
              "__rl": true,
              "mode": "id",
              "value": "1146658823815436667"
            },
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "4fb185bf-f237-4b71-8557-178f15f0caec",
          "name": "Twitter (X)",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1296
          ],
          "parameters": {
            "options": {},
            "platform": "twitter",
            "accountId": {
              "__rl": true,
              "mode": "list",
              "value": "1289",
              "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1289",
              "cachedResultName": "Docteur_Firas"
            },
            "postContentText": "={{ $('Save Caption Video to Google Sheets').item.json['CAPTION VIDEO'] }}",
            "postContentMediaUrls": "={{ $json.url }}"
          },
          "typeVersion": 2
        },
        {
          "id": "cb9939c6-1c5c-448b-ab3a-a66d90767cf2",
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            1840,
            1216
          ],
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "2c244851-7835-4f4a-8fe9-10a26acf6365",
          "name": "Think",
          "type": "@n8n/n8n-nodes-langchain.toolThink",
          "position": [
            1984,
            1216
          ],
          "parameters": {},
          "typeVersion": 1
        },
        {
          "id": "0695e935-93ac-48da-a893-1615ce22a6e7",
          "name": "Structured Output Parser",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            2128,
            1216
          ],
          "parameters": {
            "jsonSchemaExample": "{\n  \"title\": \"string\",\n  \"final_prompt\": \"string\"\n}\n"
          },
          "typeVersion": 1.3
        },
        {
          "id": "ff995af1-503e-4356-8e67-6392b4629496",
          "name": "Send Video URL via Telegram",
          "type": "n8n-nodes-base.telegram",
          "position": [
            2368,
            1008
          ],
          "webhookId": "ea6e5974-1930-4b67-a51b-16249a9ed8bd",
          "parameters": {
            "text": "=Url VIDEO : {{ $('Download Video from VEO3').item.json.data.response.resultUrls[0] }}",
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.chat.id }}",
            "additionalFields": {}
          },
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "257eedc1-30c1-4e40-913b-24ceb018df28",
          "name": "Send Final Video Preview",
          "type": "n8n-nodes-base.telegram",
          "position": [
            2384,
            1248
          ],
          "webhookId": "443fd41d-a051-45bf-ad68-173197dba26b",
          "parameters": {
            "file": "={{ $('Save Caption Video to Google Sheets').item.json['URL VIDEO FINAL'] }}",
            "chatId": "={{ $json.result.chat.id }}",
            "operation": "sendVideo",
            "additionalFields": {}
          },
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "11f4ee14-912b-4a77-8696-7d36f7fc8a21",
          "name": "Telegram Trigger: Receive Video Idea",
          "type": "n8n-nodes-base.telegramTrigger",
          "position": [
            1152,
            432
          ],
          "webhookId": "26dbe6f5-5197-4b2b-9e32-8060f2119686",
          "parameters": {
            "updates": [
              "message"
            ],
            "additionalFields": {}
          },
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "45e0b8ee-b830-48bc-8a9a-a426a7afcd43",
          "name": "Set Master Prompt",
          "type": "n8n-nodes-base.set",
          "position": [
            1600,
            992
          ],
          "parameters": {
            "options": {},
            "assignments": {
              "assignments": [
                {
                  "id": "cc2e0500-57b1-4615-82cb-1c950e5f2ec4",
                  "name": "json_master",
                  "type": "string",
                  "value": "={\n  \"description\": \"Brief narrative description of the scene, focusing on key visual storytelling and product transformation.\",\n  \"style\": \"cinematic | photorealistic | stylized | gritty | elegant\",\n  \"camera\": {\n    \"type\": \"fixed | dolly | Steadicam | crane combo\",\n    \"movement\": \"describe any camera moves like slow push-in, pan, orbit\",\n    \"lens\": \"optional lens type or focal length for cinematic effect\"\n  },\n  \"lighting\": {\n    \"type\": \"natural | dramatic | high-contrast\",\n    \"sources\": \"key lighting sources (sunset, halogen, ambient glow...)\",\n    \"FX\": \"optional VFX elements like fog, reflections, flares\"\n  },\n  \"environment\": {\n    \"location\": \"describe location or room (kitchen, desert, basketball court...)\",\n    \"set_pieces\": [\n      \"list of key background or prop elements\",\n      \"e.g. hardwood floors, chain-link fence, velvet surface\"\n    ],\n    \"mood\": \"describe the ambient atmosphere (moody, clean, epic...)\"\n  },\n  \"elements\": [\n    \"main physical items involved (product box, accessories, vehicles...)\",\n    \"include brand visibility (logos, packaging, texture...)\"\n  ],\n  \"subject\": {\n    \"character\": {\n      \"description\": \"optional – physical description, outfit\",\n      \"pose\": \"optional – position or gesture\",\n      \"lip_sync_line\": \"optional – spoken line if there’s a voiceover\"\n    },\n    \"product\": {\n      \"brand\": \"Brand name\",\n      \"model\": \"Product model or name\",\n      \"action\": \"description of product transformation or assembly\"\n    }\n  },\n  \"motion\": {\n    \"type\": \"e.g. transformation, explosion, vortex\",\n    \"details\": \"step-by-step visual flow of how elements move or evolve\"\n  },\n  \"VFX\": {\n    \"transformation\": \"optional – describe style (neon trails, motion blur...)\",\n    \"impact\": \"optional – e.g. shockwave, glow, distortion\",\n    \"particles\": \"optional – embers, sparks, thread strands...\",\n    \"environment\": \"optional – VFX affecting the scene (ripples, wind...)\"\n  },\n  \"audio\": {\n    \"music\": \"optional – cinematic score, trap beat, ambient tone\",\n    \"sfx\": [\n      \"list of sound effects (zip, pop, woosh...)\"\n    ],\n    \"ambience\": \"optional – background soundscape (traffic, wind...)\",\n    \"voiceover\": {\n      \"delivery\": \"tone and style (confident, whisper, deep...)\",\n      \"line\": \"text spoken if applicable\"\n    }\n  },\n  \"ending\": \"Final shot description – what is seen or felt at the end (freeze frame, logo pulse, glow...)\",\n  \"text\": \"none | overlay | tagline | logo pulse at end only\",\n  \"format\": \"16:9 | 4k | vertical\",\n  \"keywords\": [\n    \"brand\",\n    \"scene style\",\n    \"motion type\",\n    \"camera style\",\n    \"sound mood\",\n    \"target theme\"\n  ]\n}\n"
                }
              ]
            }
          },
          "typeVersion": 3.4
        },
        {
          "id": "a27e8e28-cb43-4b3f-a96e-e986a25209fb",
          "name": "AI Agent: Generate Video Script",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            1920,
            992
          ],
          "parameters": {
            "text": "=Create a UGC-style video prompt using both the reference image and the user description.  \n\n**Inputs**  \n- User description (optional):  \n  `{{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}`  \n- Reference image analysis (stay strictly faithful to what’s visible):  \n  `{{ $('Google Sheets: Update Image Description').item.json['IMAGE DESCRIPTION'] }}`  \n\n**Rules**  \n- Keep the style casual, authentic, and realistic. Avoid studio-like or cinematic language.  \n- Default model: `veo3_fast` (unless otherwise specified).  \n- Output only **one JSON object** with the key: `video_prompt`.  \n",
            "options": {
              "systemMessage": "=system_prompt:\n  ## SYSTEM PROMPT: Structured Video Ad Prompt Generator\n  A - Ask:\n    Generate a structured video ad prompt for cinematic generation, strictly based on the master schema provided in: {{ $json.json_master }}.\n    The final result must be a JSON object with exactly two top-level keys: `title` and `final_prompt`.\n\n  G - Guidance:\n    role: Creative Director\n    output_count: 1\n    character_limit: None\n    constraints:\n      - The output must be valid JSON.\n      - The `title` field should contain a short, descriptive and unique title (max 15 words).\n      - The `final_prompt` field must contain a **single-line JSON string** that follows the exact structure of {{ $json.json_master }} with all fields preserved.\n      - Do not include any explanations, markdown, or extra text — only the JSON object.\n      - Escape all inner quotes in the `final_prompt` string so it is valid as a stringified JSON inside another JSON.\n    tool_usage:\n      - Ensure consistent alignment across all fields (camera, lighting, motion, etc.).\n      - Maintain full structure even for optional fields (use \"none\", \"\", or [] as needed).\n\n  N - Notation:\n    format: JSON\n    expected_output:\n      {\n        \"title\": \"A unique short title for the scene\",\n        \"final_prompt\": \"{...stringified JSON of the full prompt...}\"\n      }\n\n"
            },
            "promptType": "define",
            "hasOutputParser": true
          },
          "typeVersion": 2
        },
        {
          "id": "16902ea9-197e-4cac-936e-83c1fc226854",
          "name": "Generate Video with VEO3",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            1200,
            1504
          ],
          "parameters": {
            "url": "https://api.kie.ai/api/v1/veo/generate",
            "body": "={\n  \"prompt\": {{ $json.prompt }},\n  \"model\": \"{{ $('Google Sheets: Read Video Parameters (CONFIG)').item.json.model }}\",\n  \"aspectRatio\": \"{{ $json.aspectRatio }}\",\n  \"imageUrls\": [\n    \"{{ $('Download Edited Image').item.json.images[0].url }}\"\n  ]\n}",
            "method": "POST",
            "options": {},
            "sendBody": true,
            "contentType": "raw",
            "authentication": "genericCredentialType",
            "rawContentType": "application/json",
            "genericAuthType": "httpHeaderAuth"
          },
          "typeVersion": 4.2
        },
        {
          "id": "a7fffb23-dba4-4d1e-a42e-191a1414ec60",
          "name": "Wait for VEO3 Rendering",
          "type": "n8n-nodes-base.wait",
          "position": [
            1408,
            1504
          ],
          "webhookId": "f6d814f3-4eb8-4629-a920-134cfa4ea03b",
          "parameters": {
            "amount": 20
          },
          "typeVersion": 1.1
        },
        {
          "id": "67889216-2c0f-4ed8-ae54-8e7e7fdbac90",
          "name": "Download Video from VEO3",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            1616,
            1504
          ],
          "parameters": {
            "url": "https://api.kie.ai/api/v1/veo/record-info",
            "options": {},
            "sendQuery": true,
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('Generate Video with VEO3').item.json.data.taskId }}"
                }
              ]
            }
          },
          "typeVersion": 4.2
        },
        {
          "id": "f6dda272-6129-4c04-b4c2-1e6bf5d156d8",
          "name": "Rewrite Caption with GPT-4o",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            1776,
            1504
          ],
          "parameters": {
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4o",
              "cachedResultName": "GPT-4O"
            },
            "options": {},
            "messages": {
              "values": [
                {
                  "content": "=You are rewriting a TikTok video script, caption, and overlay —\nnot inventing a new one. You must follow this format and obey\nthese rules strictly.\n---\n### CONTEXT:\nHere is the content idea to use:{{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}\n\nand the Title is : {{ $('AI Agent: Generate Video Script').item.json.output.title }}\n\n\nWrite the caption text using the topic.\n\n---\n- MUST be under 200 characters (yes \"Characters\" not wordcount)\nthis is an absolute MUST, no more than 200 characters!!! \n\n### FINAL OUTPUT FORMAT (no markdown formatting):\n\nDO NOT return any explanations. Only return the Caption Text\n"
                }
              ]
            }
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "typeVersion": 1.8
        },
        {
          "id": "8b4c6b55-a0d7-4a19-b85c-1927ccb5eaa2",
          "name": "Save Caption Video to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            2080,
            1504
          ],
          "parameters": {
            "columns": {
              "value": {
                "STATUS": "CREATE",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
                "TITRE VIDEO": "={{ $('AI Agent: Generate Video Script').item.json.output.title }}",
                "CAPTION VIDEO": "={{ $json.message.content }}",
                "URL VIDEO FINAL": "={{ $('Download Video from VEO3').item.json.data.response.resultUrls[0] }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {},
            "operation": "appendOrUpdate",
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "typeVersion": 4.6
        },
        {
          "id": "30c415e0-58e0-48b9-b7e9-11dc5d979ac8",
          "name": "Format Prompt",
          "type": "n8n-nodes-base.code",
          "position": [
            1200,
            1200
          ],
          "parameters": {
            "jsCode": "const structuredPrompt = $input.first().json.output.final_prompt;\nreturn {\n  json: {\n    prompt: JSON.stringify(structuredPrompt), // this escapes it correctly!\n    model: \"veo3_fast\",\n    aspectRatio: \"16:9\"\n  }\n};\n"
          },
          "typeVersion": 2
        },
        {
          "id": "61ce4a03-4104-4beb-bb16-0b2d2dde142d",
          "name": "Sticky Note2",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            880
          ],
          "parameters": {
            "width": 1180,
            "height": 460,
            "content": "# 📑 STEP 3 — Generate Video Ad Script"
          },
          "typeVersion": 1
        },
        {
          "id": "9f91c353-3ad6-498c-ba14-907bb91e208c",
          "name": "Sticky Note4",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            1392
          ],
          "parameters": {
            "width": 1180,
            "height": 320,
            "content": "# 📑 STEP 4 — Generate Video with VEO3"
          },
          "typeVersion": 1
        },
        {
          "id": "3051b833-571a-4f0c-993a-ca8ffd03e476",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            240
          ],
          "parameters": {
            "width": 1184,
            "height": 592,
            "content": "# 📑 STEP 1 — Collect Idea & Image"
          },
          "typeVersion": 1
        },
        {
          "id": "785aa7c8-8921-4b6b-8db3-8d55e2a42564",
          "name": "Sticky Note1",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2320,
            240
          ],
          "parameters": {
            "width": 1328,
            "height": 592,
            "content": "# 📑 STEP 2 — Create Image with NanoBanana\n"
          },
          "typeVersion": 1
        },
        {
          "id": "fa25f6bf-d05b-4b8d-8a8a-b8684c601510",
          "name": "Telegram: Get Image File",
          "type": "n8n-nodes-base.telegram",
          "position": [
            1584,
            304
          ],
          "webhookId": "06ceb31d-dcd9-4a9a-bbbe-a7bf7ae0ad4a",
          "parameters": {
            "fileId": "={{ $json.message.photo[2].file_id }}",
            "resource": "file",
            "additionalFields": {}
          },
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "7a362123-c86c-45f9-b80c-a5660f92da46",
          "name": "Google Drive: Upload Image",
          "type": "n8n-nodes-base.googleDrive",
          "position": [
            1600,
            496
          ],
          "parameters": {
            "name": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
            "driveId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "options": {},
            "folderId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "wKDeQ9ILLpAqI9Yt",
              "name": "Google Drive account"
            }
          },
          "typeVersion": 3
        },
        {
          "id": "a9614733-44e3-4580-95f8-a955d9136be4",
          "name": "Google Sheets: Log Image & Caption",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            1600,
            672
          ],
          "parameters": {
            "columns": {
              "value": {
                "STATUS": "EN COURS",
                "CAPTION": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}",
                "IMAGE URL": "={{ $json.webContentLink }}",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {},
            "operation": "appendOrUpdate",
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "typeVersion": 4.7
        },
        {
          "id": "a8e85901-2451-4037-ba0c-aa2b229c9d0f",
          "name": "Set: Bot Token (Placeholder)",
          "type": "n8n-nodes-base.set",
          "position": [
            1840,
            432
          ],
          "parameters": {
            "options": {},
            "assignments": {
              "assignments": [
                {
                  "id": "af62651a-3fc8-419d-908b-6514f6f4bcb3",
                  "name": "YOUR_BOT_TOKEN",
                  "type": "string",
                  "value": ""
                }
              ]
            }
          },
          "typeVersion": 3.4
        },
        {
          "id": "ae9da8d7-f2c4-4ada-897c-651176cbfdb6",
          "name": "Telegram API: Get File URL",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            2032,
            432
          ],
          "parameters": {
            "url": "=https://api.telegram.org/bot{{ $json.YOUR_BOT_TOKEN }}/getFile?file_id={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[3].file_id }}",
            "options": {}
          },
          "typeVersion": 4.2
        },
        {
          "id": "6527e03e-6417-45a5-95a8-2ef84b872df0",
          "name": "OpenAI Vision: Analyze Reference Image",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            2448,
            432
          ],
          "parameters": {
            "text": "=You are an image analysis assistant.\n\nYour task is to analyze the given image and output results **only in YAML format**. Do not add explanations, comments, or extra text outside YAML.\n\nRules:\n\n- If the image depicts a **product**, return:\n    \n    ```yaml\n    brand_name: (brand if visible or inferable)\n    color_scheme:\n      - hex: (hex code of each prominent color)\n        name: (descriptive name of the color)\n    font_style: (serif/sans-serif, bold/thin, etc.)\n    visual_description: (1–2 sentences summarizing what is seen, ignoring the background)\n    \n    ```\n    \n- If the image depicts a **character**, return:\n    \n    ```yaml\n    character_name: (name if visible or inferable, else \"unknown\")\n    color_scheme:\n      - hex: (hex code of each prominent color on the character)\n        name: (descriptive name of the color)\n    outfit_style: (clothing style, accessories, or notable features)\n    visual_description: (1–2 sentences summarizing what the character looks like, ignoring the background)\n    \n    ```\n    \n- If the image depicts **both**, return **both sections** in YAML.\n\nOnly output valid YAML. No explanations.",
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "chatgpt-4o-latest",
              "cachedResultName": "CHATGPT-4O-LATEST"
            },
            "options": {},
            "resource": "image",
            "imageUrls": "=https://api.telegram.org/file/bot{{ $('Set: Bot Token (Placeholder)').item.json.YOUR_BOT_TOKEN }}/{{ $json.result.file_path }}",
            "operation": "analyze"
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "typeVersion": 1.8
        },
        {
          "id": "6d78c44a-9073-4a2c-9a17-102c870b2162",
          "name": "Google Sheets: Update Image Description",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            2688,
            432
          ],
          "parameters": {
            "columns": {
              "value": {
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
                "IMAGE DESCRIPTION": "={{ $json.content }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {},
            "operation": "appendOrUpdate",
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "typeVersion": 4.7
        },
        {
          "id": "efd41bb8-ecef-49ea-9051-ead169d6766b",
          "name": "LLM: Structured Output Parser",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            3072,
            672
          ],
          "parameters": {
            "jsonSchemaExample": "{\n\t\"image_prompt\": \"string\"\n}"
          },
          "typeVersion": 1.3
        },
        {
          "id": "96a49fe4-d013-42c8-9ae8-11eb713e132f",
          "name": "LLM: OpenAI Chat",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            2864,
            672
          ],
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "f6599d80-4301-4dd1-bc38-1c39e57e21cb",
          "name": "Generate Image Prompt",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            2912,
            432
          ],
          "parameters": {
            "text": "=Your task is to create an image prompt following the system guidelines.  \nEnsure that the reference image is represented as **accurately as possible**, including all text elements.  \n\nUse the following inputs:  \n\n- **User’s description:**  \n{{ $json.CAPTION }}\n\n- **Reference image description:**  \n{{ $json['IMAGE DESCRIPTION'] }}\n",
            "options": {
              "systemMessage": "=ROLE: UGC Image Prompt Builder  \n\nGOAL:  \nGenerate one concise, natural, and realistic image prompt (≤120 words) from a given product or reference image. The prompt must simulate authentic UGC (user-generated content) photography.  \n\nRULES:  \n- Always output **one JSON object only** with the key:  \n  - `image_prompt`: (string with full description)  \n- Do **not** add commentary, metadata, or extra keys. JSON only.  \n\nSTYLE GUIDELINES:  \n- Tone: casual, unstaged, lifelike, handheld snapshot.  \n- Camera cues: include at least 2–3 (e.g., phone snapshot, handheld framing, off-center composition, natural indoor light, soft shadows, slight motion blur, auto exposure, unpolished look, mild grain).  \n- Realism: embrace imperfections (wrinkles, stray hairs, skin texture, clutter, smudges).  \n- Packaging/Text: preserve exactly as visible. Never invent claims, numbers, or badges.  \n- Diversity: if people appear but are unspecified, vary gender/ethnicity naturally; default age range = 21–38.  \n- Setting: default to real-world everyday spaces (home, street, store, gym, office).  \n\nSAFETY:  \n- No copyrighted character names.  \n- No dialogue or scripts. Only describe scenes.  \n\nOUTPUT CONTRACT:  \n- JSON only, no prose outside.  \n- Max 120 words in `image_prompt`.  \n- Must cover: subject, action, mood, setting, style/camera, colors, and text accuracy.  \n\nCHECKLIST BEFORE OUTPUT:  \n- Natural handheld tone?  \n- At least 2 camera cues included?  \n- Product text preserved exactly?  \n- Only JSON returned?  \n\n---  \n\n### Example  \n\nGood Example :  \n```json\n{ \"image_prompt\": \"a young adult casually holding a skincare tube near a bathroom mirror; action: dabs small amount on the back of the hand; mood: easy morning; setting: small apartment bathroom with towel on rack and toothbrush cup; style/camera: phone snapshot, handheld framing, off-center composition, natural window light, slight motion blur, mild grain; colors: soft whites and mint label; text accuracy: keep every word on the tube exactly as visible, no added claims\" }\n"
            },
            "promptType": "define",
            "hasOutputParser": true
          },
          "typeVersion": 2.2
        },
        {
          "id": "80274aa5-bdf0-49bf-9980-0624d99d68ef",
          "name": "NanoBanana: Create Image",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            3248,
            432
          ],
          "parameters": {
            "url": "https://queue.fal.run/fal-ai/nano-banana/edit",
            "method": "POST",
            "options": {},
            "jsonBody": "={\n\t\"prompt\": \"{{ $json.output.image_prompt.replace(/\\\"/g, '\\\\\\\"').replace(/\\n/g, '\\\\n') }}\",\n\"image_urls\": [\"{{ $('Google Drive: Upload Image').item.json.webContentLink }}\"]\n\n}\n\n",
            "sendBody": true,
            "specifyBody": "json",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth"
          },
          "typeVersion": 4.2
        },
        {
          "id": "e132487d-da8c-4850-9d3f-9e057e9bde64",
          "name": "Wait for Image Edit",
          "type": "n8n-nodes-base.wait",
          "position": [
            3456,
            432
          ],
          "webhookId": "df52d997-45c4-431f-bdf6-89dd25027b5b",
          "parameters": {
            "amount": 20
          },
          "typeVersion": 1.1
        },
        {
          "id": "2c7ffce1-8ace-418d-9738-c659f4554980",
          "name": "Download Edited Image",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            3456,
            656
          ],
          "parameters": {
            "url": "={{ $json.response_url }}",
            "options": {},
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth"
          },
          "typeVersion": 4.2
        },
        {
          "id": "ec725aa0-fd30-4d98-b984-0228873db428",
          "name": "Google Sheets: Read Video Parameters (CONFIG)",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            1392,
            992
          ],
          "parameters": {
            "options": {},
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            }
          },
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          },
          "typeVersion": 4.6
        },
        {
          "id": "abafa8c6-55a0-488c-970e-d2a969ad7959",
          "name": "Telegram: Send notification",
          "type": "n8n-nodes-base.telegram",
          "position": [
            3472,
            1520
          ],
          "webhookId": "2f4a4bc1-99de-4e93-8523-dd8c6499b893",
          "parameters": {
            "text": "Published",
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.chat.id }}",
            "additionalFields": {}
          },
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          },
          "typeVersion": 1.2
        },
        {
          "id": "77030cb3-3246-41d5-bcbc-74f82bdd501b",
          "name": "Sticky Note5",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            368,
            240
          ],
          "parameters": {
            "color": 6,
            "width": 700,
            "height": 1476,
            "content": "# 🎬 Generate AI viral videos with NanoBanana & VEO3, shared on socials via Blotato (By Dr. Firas)\n\n\n# 🎥 Full Tutorial :\n[![AI Voice Agent Preview](https://www.dr-firas.com/nanobanana.png)](https://youtu.be/nlwpbXQqNQ4)\n\n---\n\n# 📘 Documentation  \nAccess detailed setup instructions, API config, platform connection guides, and workflow customization tips:\n\n📎 [Open the full documentation on Notion](https://automatisation.notion.site/NonoBanan-2643d6550fd98041aef5dcbe8ab0f7a1?source=copy_link)\n\n---\n\n# ⚙️ Requirements\n\n1. ✅ **Create a [Blotato](https://blotato.com/?ref=firas) account** (Pro plan required for API access)  \n2. 🔑 **Generate your Blotato API Key** via: `Settings > API > Generate API Key`  \n3. 📦 **Enable “Verified Community Nodes”** in the n8n admin settings  \n4. 🧩 **Install the Blotato** verified community node in n8n  \n5. 🛠 **Create a Blotato API credential** inside your n8n credentials tab  \n6. 📄 **Duplicate this [Google Sheet template](https://docs.google.com/spreadsheets/d/1FutmZHblwnk36fp59fnePjONzuJBdndqZOCuRoGWSmY/edit?usp=sharing)**  \n7. ☁️ **Make sure your Google Drive folder is PUBLIC** (anyone with the link can access)  \n8. 📌 **Complete the 3 brown sticky note steps** inside the workflow editor\n\n"
          },
          "typeVersion": 1
        }
      ],
      "connections": {
        "Merge": {
          "main": [
            [
              {
                "node": "Update Status to \"DONE\"",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Think": {
          "ai_tool": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Tiktok": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Bluesky": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 7
              }
            ]
          ]
        },
        "Threads": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 6
              }
            ]
          ]
        },
        "Youtube": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 5
              }
            ]
          ]
        },
        "Facebook": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 2
              }
            ]
          ]
        },
        "Linkedin": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Instagram": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 3
              }
            ]
          ]
        },
        "Pinterest": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 8
              }
            ]
          ]
        },
        "Twitter (X)": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 4
              }
            ]
          ]
        },
        "Format Prompt": {
          "main": [
            [
              {
                "node": "Generate Video with VEO3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LLM: OpenAI Chat": {
          "ai_languageModel": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Set Master Prompt": {
          "main": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for Image Edit": {
          "main": [
            [
              {
                "node": "Download Edited Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Edited Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Read Video Parameters (CONFIG)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Image Prompt": {
          "main": [
            [
              {
                "node": "NanoBanana: Create Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Update Status to \"DONE\"": {
          "main": [
            [
              {
                "node": "Telegram: Send notification",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upload Video to BLOTATO": {
          "main": [
            [
              {
                "node": "Tiktok",
                "type": "main",
                "index": 0
              },
              {
                "node": "Linkedin",
                "type": "main",
                "index": 0
              },
              {
                "node": "Facebook",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram",
                "type": "main",
                "index": 0
              },
              {
                "node": "Twitter (X)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Youtube",
                "type": "main",
                "index": 0
              },
              {
                "node": "Threads",
                "type": "main",
                "index": 0
              },
              {
                "node": "Bluesky",
                "type": "main",
                "index": 0
              },
              {
                "node": "Pinterest",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for VEO3 Rendering": {
          "main": [
            [
              {
                "node": "Download Video from VEO3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Video from VEO3": {
          "main": [
            [
              {
                "node": "Rewrite Caption with GPT-4o",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Video with VEO3": {
          "main": [
            [
              {
                "node": "Wait for VEO3 Rendering",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "NanoBanana: Create Image": {
          "main": [
            [
              {
                "node": "Wait for Image Edit",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Final Video Preview": {
          "main": [
            [
              {
                "node": "Upload Video to BLOTATO",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Structured Output Parser": {
          "ai_outputParser": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "Telegram: Get Image File": {
          "main": [
            [
              {
                "node": "Google Drive: Upload Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Drive: Upload Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Log Image & Caption",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram API: Get File URL": {
          "main": [
            [
              {
                "node": "OpenAI Vision: Analyze Reference Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Rewrite Caption with GPT-4o": {
          "main": [
            [
              {
                "node": "Save Caption Video to Google Sheets",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Video URL via Telegram": {
          "main": [
            [
              {
                "node": "Send Final Video Preview",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set: Bot Token (Placeholder)": {
          "main": [
            [
              {
                "node": "Telegram API: Get File URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LLM: Structured Output Parser": {
          "ai_outputParser": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent: Generate Video Script": {
          "main": [
            [
              {
                "node": "Format Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Log Image & Caption": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Caption Video to Google Sheets": {
          "main": [
            [
              {
                "node": "Send Video URL via Telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram Trigger: Receive Video Idea": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Telegram: Get Image File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Vision: Analyze Reference Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Update Image Description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Update Image Description": {
          "main": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Read Video Parameters (CONFIG)": {
          "main": [
            [
              {
                "node": "Set Master Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": null,
      "staticData": null,
      "meta": {
        "templateId": "8270"
      },
      "pinData": null,
      "versionId": "232e0e5b-cfaf-44a8-9d66-eaf289da29d6",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-27T21:34:35.744Z",
          "createdAt": "2025-11-27T21:34:35.744Z",
          "role": "workflow:owner",
          "workflowId": "ejUB1CauLpACddus",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-08T09:42:14Z",
      "createdAt": "2025-11-01T14:40:26.116Z",
      "id": "hPEhindqlbJo7oZ9",
      "name": "Artisan Production Agent",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Artisan Production Agent, coordinating the handcrafting process from raw materials to finished retro-futuristic gadgets. You manage workshop schedules, artisan assignments, and ensure quality craftsmanship at every production stage.\n\n## Tools Available\n\n### Airtable - Production Pipeline\n- Track gadgets through production stages\n- Manage artisan workloads\n- Monitor quality checkpoints\n\n### Google Calendar - Workshop Schedule\n- Schedule production slots\n- Book specialized equipment\n- Coordinate artisan availability\n\n### Gmail - Team Communication\n- Send production briefs\n- Coordinate with artisans\n- Share technique updates\n\n### Google Drive - Design Repository\n- Access blueprints and templates\n- Store production photos\n- Share crafting guides\n\n### Slack - Workshop Coordination\n- Real-time production updates\n- Quality issue alerts\n- Technique discussions\n\n## Production Standards\n- Each piece must meet RetroFuture's artisanal quality standards\n- Verify authentic materials and finishes\n- Document unique characteristics of each piece\n- Ensure proper aging and patina processes\n\n## Production Workflow\n1. Design Blueprint Review\n2. Material Preparation\n3. Artisan Assignment\n4. Crafting Timeline\n5. Quality Checkpoints\n6. Finishing & Packaging\n\n## Artisan Specializations\n- Metalworking (brass, copper, steel)\n- Leathercraft (wrapping, embossing)\n- Woodworking (inlays, carving)\n- Electronics Integration\n- Patina & Finishing\n- Gear Mechanism Assembly\n\n## Production Stages\n1. **Material Prep** - Component sourcing and preparation\n2. **Base Construction** - Primary structure assembly\n3. **Detailing** - Adding gears, mechanisms, decorative elements\n4. **Electronics** - LED, USB, or smart component integration\n5. **Finishing** - Patina, polishing, aging effects\n6. **Quality Control** - Final inspection and testing\n7. **Packaging** - Custom presentation boxes\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "name": "Artisan Production Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -688,
            -64
          ],
          "id": "779ed269-5072-4d53-82ca-f1944419a8d1",
          "onError": "continueErrorOutput"
        },
        {
          "parameters": {
            "model": "gpt-4o",
            "options": {}
          },
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1.2,
          "position": [
            -960,
            160
          ],
          "id": "5e117a15-bc02-418d-9d20-0955feb8ad57"
        },
        {
          "parameters": {
            "operation": "search",
            "base": {
              "__rl": true,
              "value": "retrofuture-production-base",
              "mode": "list",
              "cachedResultName": "Artisan Production"
            },
            "table": {
              "__rl": true,
              "value": "production-pipeline-table",
              "mode": "list",
              "cachedResultName": "Gadget Projects"
            },
            "options": {}
          },
          "name": "Search Production Pipeline",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            -800,
            160
          ],
          "id": "aab1b44a-3c07-472d-9d75-3b04b89e711b"
        },
        {
          "parameters": {
            "operation": "create",
            "base": {
              "__rl": true,
              "value": "retrofuture-production-base",
              "mode": "list",
              "cachedResultName": "Artisan Production"
            },
            "table": {
              "__rl": true,
              "value": "production-pipeline-table",
              "mode": "list",
              "cachedResultName": "Gadget Projects"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "orderId": "={{ $fromAI(\"orderId\") }}",
                "productName": "={{ $fromAI(\"productName\") }}",
                "gadgetType": "={{ $fromAI(\"gadgetType\") }}",
                "materials": "={{ $fromAI(\"materials\") }}",
                "deadline": "={{ $fromAI(\"deadline\") }}",
                "stage": "={{ $fromAI(\"stage\", \"Material Prep\") }}",
                "assignedArtisan": "={{ $fromAI(\"assignedArtisan\") }}",
                "specialTechniques": "={{ $fromAI(\"specialTechniques\") }}",
                "qualityChecked": "={{ $fromAI(\"qualityChecked\", false) }}"
              }
            },
            "options": {}
          },
          "name": "Create Production Job",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            -640,
            160
          ],
          "id": "bb38a0ef-92a5-4c9a-bba6-eaffdaf88d5a"
        },
        {
          "parameters": {
            "operation": "update",
            "base": {
              "__rl": true,
              "value": "retrofuture-production-base",
              "mode": "list",
              "cachedResultName": "Artisan Production"
            },
            "table": {
              "__rl": true,
              "value": "production-pipeline-table",
              "mode": "list",
              "cachedResultName": "Gadget Projects"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "stage": "={{ $fromAI(\"stage\") }}",
                "completionPercentage": "={{ $fromAI(\"completionPercentage\") }}",
                "notes": "={{ $fromAI(\"notes\") }}"
              }
            },
            "options": {}
          },
          "name": "Update Production Status",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            -496,
            160
          ],
          "id": "0b0f0b0a-748f-4d1f-b06c-6a49c8e1e79b"
        },
        {
          "parameters": {
            "calendar": {
              "__rl": true,
              "value": "workshop@retrofuturegadgetry.com",
              "mode": "list"
            },
            "start": "={{ $fromAI(\"sessionStart\") }}",
            "end": "={{ $fromAI(\"sessionEnd\") }}",
            "additionalFields": {
              "attendees": "={{ $fromAI(\"attendees\", []) }}",
              "description": "={{ $fromAI(\"sessionDescription\") }}",
              "location": "={{ $fromAI(\"location\", \"RetroFuture Workshop\") }}",
              "summary": "={{ $fromAI(\"sessionTitle\") }}"
            }
          },
          "name": "Schedule Production",
          "type": "n8n-nodes-base.googleCalendarTool",
          "typeVersion": 1.3,
          "position": [
            -368,
            160
          ],
          "id": "663b72ac-5129-46f8-a8fc-ed98457187bf"
        },
        {
          "parameters": {
            "sendTo": "={{ $fromAI(\"artisanEmail\") }}",
            "subject": "={{ $fromAI(\"emailSubject\") }}",
            "message": "={{ $fromAI(\"emailBody\") }}",
            "options": {}
          },
          "name": "Send Production Brief",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            -224,
            160
          ],
          "id": "1e092319-4ee2-4096-a4f7-ac2cdce6b3c6",
          "webhookId": "48c85e4d-0a5a-41e9-838c-f4254af7f16e"
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            -96,
            -160
          ],
          "id": "a9de7827-b7b8-4e29-b09d-06ccf4fb3f4d"
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "An error occurred with the artisan production request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            -96,
            48
          ],
          "id": "ee4de968-22eb-4913-8fc1-9f9367dda60a"
        },
        {
          "parameters": {
            "inputSource": "passthrough"
          },
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -1120,
            -64
          ],
          "id": "767d239d-b8da-49ce-8833-a7d1919d1200"
        },
        {
          "parameters": {
            "pageId": {
              "__rl": true,
              "mode": "url",
              "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Parent_Page', ``, 'string') }}"
            },
            "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}",
            "options": {}
          },
          "type": "n8n-nodes-base.notionTool",
          "typeVersion": 2.2,
          "position": [
            -896,
            208
          ],
          "id": "db23f933-6f62-4db5-8a74-fcad20123848",
          "name": "Create a page in Notion",
          "credentials": {
            "notionApi": {
              "id": "f5tTT8IA2z8CgeZk",
              "name": "Novel Studio Notion"
            }
          }
        },
        {
          "parameters": {
            "path": "5f832aea-9a78-4927-ac65-0e615bf24fc6"
          },
          "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
          "typeVersion": 2,
          "position": [
            -800,
            304
          ],
          "id": "8808ffa7-8bc1-43ac-bce6-49fd9cfb473f",
          "name": "MCP Server Trigger",
          "webhookId": "5f832aea-9a78-4927-ac65-0e615bf24fc6"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Search Production Pipeline": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              },
              {
                "node": "MCP Server Trigger",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Create Production Job": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Update Production Status": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Schedule Production": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Production Brief": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Artisan Production Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create a page in Notion": {
          "ai_tool": [
            [
              {
                "node": "Artisan Production Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": {},
      "versionId": "395b9df5-476f-4e39-8dee-c9c5f97eb605",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:26.118Z",
          "createdAt": "2025-11-01T14:40:26.118Z",
          "role": "workflow:owner",
          "workflowId": "hPEhindqlbJo7oZ9",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-11T17:28:59Z",
      "createdAt": "2025-11-08T09:58:54.138Z",
      "id": "jKuoxiRGZdEplhgP",
      "name": "Hourly Check (HH:55)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "55 * * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - Every Hour at :55",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "a95be710-2e66-435a-b256-88c20b91a777"
        },
        {
          "parameters": {
            "operation": "getAll",
            "base": "0c6cedb5-a728-4de8-b6eb-8313c093839a",
            "returnAll": false,
            "limit": 100,
            "filters": {
              "conditions": [
                {
                  "property": "Status",
                  "condition": "equals",
                  "value": "InProgress"
                }
              ]
            }
          },
          "name": "Get InProgress Tasks",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            450,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "2e8d99e9-eca1-4f04-941b-bf14d97a7171"
        },
        {
          "parameters": {
            "functionCode": "// Check task status and determine next action\nconst task = $input.item.json;\nconst now = new Date();\nconst lastCheck = task.LastCheck ? new Date(task.LastCheck) : new Date(task.CreatedTime);\nconst hoursSinceCheck = (now - lastCheck) / (1000 * 60 * 60);\n\n// Determine action based on time and status\nlet action = 'check_status';\nlet nextStatus = 'InProgress';\nlet nextAction = '';\n\n// If no update in >4 hours, mark for clarification\nif (hoursSinceCheck > 4) {\n  action = 'needs_clarification';\n  nextStatus = 'WaitingClarify';\n  nextAction = 'Task has been in progress for >4 hours without update. Need status check.';\n}\n\n// If SLA is approaching, escalate\nconst slaDue = new Date(task.SLA_Due);\nconst hoursToSLA = (slaDue - now) / (1000 * 60 * 60);\nif (hoursToSLA < 2 && hoursToSLA > 0) {\n  action = 'sla_warning';\n  nextAction = 'SLA due in less than 2 hours - escalate';\n}\n\nreturn [{\n  json: {\n    task_id: task.id,\n    task_name: task.Title,\n    action: action,\n    next_status: nextStatus,\n    next_action: nextAction,\n    hours_since_check: hoursSinceCheck.toFixed(1),\n    sla_hours_remaining: hoursToSLA ? hoursToSLA.toFixed(1) : 'N/A'\n  }\n}];"
          },
          "name": "Analyze Task Status",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "id": "1d43aa04-2e91-4a53-a13c-3e3354983a22"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.action}}",
                  "value2": "needs_clarification"
                }
              ]
            }
          },
          "name": "If Needs Clarification",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            850,
            200
          ],
          "id": "ede6707a-e467-48a5-afad-f84ed6efb812"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.action}}",
                  "value2": "sla_warning"
                }
              ]
            }
          },
          "name": "If SLA Warning",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            850,
            400
          ],
          "id": "802d4ed0-d1c0-404c-ac18-315c1f5e7123"
        },
        {
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.task_id}}",
            "properties": {
              "Status": "WaitingClarify",
              "NextAction": "={{$json.next_action}}",
              "LastCheck": "={{new Date().toISOString()}}"
            }
          },
          "name": "Update to WaitingClarify",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            1050,
            150
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "f7879831-f198-4a43-aa88-54a7985b861c"
        },
        {
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.task_id}}",
            "properties": {
              "NextAction": "={{$json.next_action}}",
              "LastCheck": "={{new Date().toISOString()}}"
            }
          },
          "name": "Update SLA Warning",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            1050,
            400
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "b1c888bc-549d-48bc-ad9a-37a6e5be04f1"
        },
        {
          "parameters": {
            "operation": "update",
            "pageId": "={{$json.task_id}}",
            "properties": {
              "LastCheck": "={{new Date().toISOString()}}"
            }
          },
          "name": "Update LastCheck",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            1050,
            600
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "60c9d66a-96e7-46f2-9e6d-0d1565c0bc69"
        }
      ],
      "connections": {
        "Schedule Trigger - Every Hour at :55": {
          "main": [
            [
              {
                "node": "Get InProgress Tasks",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get InProgress Tasks": {
          "main": [
            [
              {
                "node": "Analyze Task Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Analyze Task Status": {
          "main": [
            [
              {
                "node": "If Needs Clarification",
                "type": "main",
                "index": 0
              },
              {
                "node": "If SLA Warning",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If Needs Clarification": {
          "main": [
            [
              {
                "node": "Update to WaitingClarify",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Update LastCheck",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If SLA Warning": {
          "main": [
            [
              {
                "node": "Update SLA Warning",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Update LastCheck",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - Every Hour at :55": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "20ddf8ff-133d-4528-8232-7947d6db3a9d",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-08T09:58:54.174Z",
          "createdAt": "2025-11-08T09:58:54.174Z",
          "role": "workflow:owner",
          "workflowId": "jKuoxiRGZdEplhgP",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-08T09:58:53.806Z",
      "createdAt": "2025-11-01T14:36:57.814Z",
      "id": "kXrrQJ5srtlR2SYM",
      "name": "Evening Autopilot (17:00)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 17 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 17:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "2a4d5030-1a4c-47d7-a4ea-5e1f119eec8f"
        }
      ],
      "connections": {},
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 17:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "0df64921-486c-4202-8156-a406c078696a",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:57.816Z",
          "createdAt": "2025-11-01T14:36:57.816Z",
          "role": "workflow:owner",
          "workflowId": "kXrrQJ5srtlR2SYM",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-26T03:03:48Z",
      "createdAt": "2025-10-26T02:32:54.126Z",
      "id": "ngROtDNsR0rk6bpk",
      "name": "Audio Production Pipeline",
      "active": false,
      "isArchived": true,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "audio-production",
            "responseMode": "responseNode",
            "options": {}
          },
          "name": "Webhook - Audio Request",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            -608,
            112
          ],
          "webhookId": "audio-production",
          "id": "7271d553-04f0-4954-86e7-362021c93f97"
        },
        {
          "parameters": {
            "jsCode": "// Determine audio type: quick preview or professional production\nconst mode = $input.item.json.mode || 'preview'; // 'preview' or 'production'\nconst text = $input.item.json.text;\nconst characterVoice = $input.item.json.characterVoice;\nconst seriesId = $input.item.json.seriesId;\n\nreturn {\n  json: {\n    mode,\n    text,\n    characterVoice,\n    seriesId,\n    timestamp: new Date().toISOString()\n  }\n};"
          },
          "name": "Parse Request",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -400,
            112
          ],
          "id": "3e474422-0e98-4f60-8428-ea5384349e27"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.mode}}",
                  "operation": "equals",
                  "value2": "preview"
                }
              ]
            }
          },
          "name": "Check Mode",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            -208,
            112
          ],
          "id": "11b8787f-d3d4-4a1d-8edd-edcf358b35ca"
        },
        {
          "parameters": {
            "model": "=",
            "prompt": "=",
            "simplifyOutput": false,
            "options": {},
            "requestOptions": {}
          },
          "name": "OpenAI TTS - Quick Preview",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "id": "60229457-18b3-4092-a362-c00cbf9cb035",
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.elevenlabs.io/v1/text-to-speech/{{$json.voiceId}}",
            "authentication": "headerAuth",
            "options": {}
          },
          "name": "ElevenLabs - Professional Audio",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 3,
          "position": [
            0,
            208
          ],
          "id": "d1271555-3550-48e0-a953-97b1a5911b6e"
        },
        {
          "parameters": {
            "jsCode": "// Calculate SHA-256 hash for deduplication\nconst crypto = require('crypto');\nconst audioBuffer = $input.item.binary.data;\nconst hash = crypto.createHash('sha256').update(audioBuffer).digest('hex');\n\nconst seriesId = $input.item.json.seriesId;\nconst timestamp = Date.now();\nconst storagePath = `Z:\\\\NovelStudio\\\\audio\\\\${seriesId}\\\\${hash.substring(0, 2)}\\\\${hash}.mp3`;\n\nreturn {\n  json: {\n    hash,\n    storagePath,\n    seriesId,\n    metadata: $input.item.json\n  },\n  binary: {\n    data: audioBuffer\n  }\n};"
          },
          "name": "Hash & Deduplicate",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            208,
            112
          ],
          "id": "c7e477d7-c713-4c9f-a912-2726426a26f3"
        },
        {
          "parameters": {},
          "name": "Save to NAS Storage",
          "type": "n8n-nodes-base.files",
          "typeVersion": 1,
          "position": [
            400,
            112
          ],
          "id": "b7a26371-5d5a-4942-bbc6-d0953b4ea990"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.notion.com/v1/pages",
            "authentication": "headerAuth",
            "options": {}
          },
          "name": "Update Notion Database",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 3,
          "position": [
            608,
            112
          ],
          "id": "7ec1a236-3794-4601-8c72-cdaa425d79a9"
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{$json}}",
            "options": {}
          },
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            800,
            112
          ],
          "id": "2781768d-dcfa-41f8-816a-2ce99132d9d0"
        }
      ],
      "connections": {
        "Webhook - Audio Request": {
          "main": [
            [
              {
                "node": "Parse Request",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse Request": {
          "main": [
            [
              {
                "node": "Check Mode",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Mode": {
          "main": [
            [
              {
                "node": "OpenAI TTS - Quick Preview",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "ElevenLabs - Professional Audio",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI TTS - Quick Preview": {
          "main": [
            [
              {
                "node": "Hash & Deduplicate",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "ElevenLabs - Professional Audio": {
          "main": [
            [
              {
                "node": "Hash & Deduplicate",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Update Notion Database": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {
        "OpenAI TTS - Quick Preview": [
          {
            "json": {
              "name": "First item",
              "code": 1
            }
          },
          {
            "json": {
              "name": "Second item",
              "code": 2
            }
          }
        ]
      },
      "versionId": "e8f04320-d859-4c90-b4c3-d6c07ece6534",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-10-26T02:32:54.149Z",
          "createdAt": "2025-10-26T02:32:54.149Z",
          "role": "workflow:owner",
          "workflowId": "ngROtDNsR0rk6bpk",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:24.334Z",
      "createdAt": "2025-11-01T14:40:24.334Z",
      "id": "ouQj3CZAkgBOcquT",
      "name": "transaction categoriser webhook",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Transaction Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "booke-categorizer",
            "options": {}
          },
          "id": "ea02c3aa-d8fa-44ab-b260-f3cc5f6a1422"
        },
        {
          "name": "Transaction Categorizer",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            220,
            0
          ],
          "parameters": {
            "jsCode": "// Booke.ai Transaction Categorizer\n// Analyzes and categorizes transactions based on historical patterns\n\nfunction analyzeBookeAiData() {\n  // Vendor categorization rules based on your historical data\n  const vendorRules = {\n    // Utilities\n    'electric ireland': { category: 'Utilities', taxRate: '9%: Second Reduced' },\n    'energia': { category: 'Utilities', taxRate: '9%: Second Reduced' },\n    'three ireland': { category: 'Utilities', taxRate: '23%: Standard' },\n    'spar hampton wood': { category: 'Utilities', taxRate: '9%: Second Reduced' },\n    'circle k': { category: 'Utilities', taxRate: '9%: Second Reduced' },\n    \n    // Subscriptions & Software\n    'microsoft': { category: 'Dues and subscriptions', taxRate: 'AMOUNT_BASED' },\n    'spotify': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'google play': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'canva': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'openai': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'netflix': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'disney plus': { category: 'Dues and subscriptions', taxRate: '23%: Standard' },\n    'quickbooks': { category: 'Legal and professional fees', taxRate: '23%: Standard' },\n    'intuit': { category: 'Legal and professional fees', taxRate: '23%: Standard' },\n    \n    // E-commerce & Retail\n    'amazon': { category: 'Repairs and Maintenance', taxRate: '23%: Standard' },\n    'aliexpress': { category: 'Repairs and Maintenance', taxRate: '23%: Standard' },\n    'temu': { category: 'Repairs and Maintenance', taxRate: '23%: Standard' },\n    'screwfix': { category: 'Repairs and Maintenance', taxRate: '23%: Standard' },\n    \n    // Groceries\n    'lidl': { category: 'Materials - COS', taxRate: '23%: Standard' },\n    'aldi': { category: 'Materials - COS', taxRate: '23%: Standard' },\n    'tesco': { category: 'Materials - COS', taxRate: '23%: Standard' },\n    \n    // Food & Entertainment\n    'deliveroo': { category: 'Meals and entertainment', taxRate: '23%: Standard' },\n    'just eat': { category: 'Meals and entertainment', taxRate: '23%: Standard' },\n    'mcdonalds': { category: 'Meals and entertainment', taxRate: '23%: Standard' },\n    \n    // Transportation\n    'free now': { category: 'Travel expenses - selling expenses', taxRate: '23%: Standard' },\n    'mytaxi': { category: 'Travel expenses - selling expenses', taxRate: '23%: Standard' },\n    'payzone': { category: 'Travel expenses - general and admin expenses', taxRate: '23%: Standard' },\n    \n    // Professional Services\n    'excelsious limited': { category: 'Legal and professional fees', taxRate: '23%: Standard' },\n    'booke ai': { category: 'Legal and professional fees', taxRate: '23%: Standard' },\n    \n    // E-commerce Platform\n    'shopify': { category: 'E commerce expense', taxRate: '23%: Standard' },\n    'bluehost': { category: 'E commerce expense', taxRate: '23%: Standard' },\n    \n    // Income\n    'airbnb': { category: 'Airbnb Income', taxRate: '13.5%: Reduced' },\n    \n    // Special Categories\n    'revolut pro': { category: 'Cashnack Rewards', taxRate: '0%: OOS' },\n    'paypal': { category: 'Owners Draw', taxRate: '0%: OOS' },\n    \n    // Personal Payments\n    'joseph bermingham': { category: 'Rent or lease payments', taxRate: '0%: Exempt - EU' },\n    'carlos alberto rodriguez perez': { category: 'Cash and cash equivalents', taxRate: '–' }\n  };\n  \n  // Amount-based rules for specific vendors\n  const amountRules = {\n    'microsoft': {\n      '14.39': { taxRate: '13.5%: Reduced' },\n      '17.22': { taxRate: '9%: Second Reduced - R' }\n    },\n    'joseph bermingham': {\n      '1000': { category: 'Rent or lease payments', taxRate: '0%: Exempt - EU' }\n    }\n  };\n  \n  return { vendorRules, amountRules };\n}\n\n// Function to categorize a transaction\nfunction categorizeTransaction(transaction) {\n  const { vendorRules, amountRules } = analyzeBookeAiData();\n  \n  // Clean the input - handle different field names\n  const payee = (transaction.payee || transaction.description || transaction.merchant || '').toLowerCase();\n  const amount = parseFloat(transaction.amount || 0);\n  \n  let category = transaction.category || '';\n  let taxRate = transaction.taxRate || '';\n  let matchedRule = '';\n  \n  // Check vendor rules first\n  for (const [vendor, rule] of Object.entries(vendorRules)) {\n    if (payee.includes(vendor)) {\n      category = rule.category;\n      taxRate = rule.taxRate;\n      matchedRule = vendor;\n      \n      // Check for amount-based tax rates\n      if (taxRate === 'AMOUNT_BASED' && amountRules[vendor]) {\n        const amountRule = amountRules[vendor][amount.toFixed(2)];\n        if (amountRule) {\n          taxRate = amountRule.taxRate;\n          matchedRule += ` (${amount})`;\n        } else {\n          taxRate = '23%: Standard'; // Default for unmatched amounts\n        }\n      }\n      break;\n    }\n  }\n  \n  // Check amount rules for specific payees\n  for (const [vendor, amounts] of Object.entries(amountRules)) {\n    if (payee.includes(vendor)) {\n      const amountRule = amounts[amount.toFixed(2)];\n      if (amountRule) {\n        if (amountRule.category) category = amountRule.category;\n        if (amountRule.taxRate) taxRate = amountRule.taxRate;\n        matchedRule = `${vendor} (${amount})`;\n      }\n    }\n  }\n  \n  // Set defaults if no rules matched\n  if (!category) category = 'Uncategorized';\n  if (!taxRate) taxRate = '23%: Standard';\n  \n  return {\n    ...transaction,\n    category: category,\n    taxRate: taxRate,\n    autoCategorized: !!matchedRule,\n    matchedRule: matchedRule || 'No rule matched',\n    processedAt: new Date().toISOString()\n  };\n}\n\n// Main processing logic\ntry {\n  // Get the input data\n  const inputData = $input.first().json;\n  \n  // Handle different input formats\n  let transaction;\n  if (inputData.body) {\n    transaction = inputData.body;\n  } else if (inputData.transaction) {\n    transaction = inputData.transaction;\n  } else {\n    transaction = inputData;\n  }\n  \n  // Log the input for debugging\n  console.log('Input transaction:', JSON.stringify(transaction, null, 2));\n  \n  // Categorize the transaction\n  const categorized = categorizeTransaction(transaction);\n  \n  // Log the result\n  console.log('Categorized transaction:', JSON.stringify(categorized, null, 2));\n  \n  // Return the categorized transaction\n  return [{\n    json: {\n      success: true,\n      original: transaction,\n      categorized: categorized,\n      message: `Transaction categorized successfully. Matched rule: ${categorized.matchedRule}`\n    }\n  }];\n  \n} catch (error) {\n  console.error('Error processing transaction:', error);\n  \n  return [{\n    json: {\n      success: false,\n      error: error.message,\n      original: $input.first().json\n    }\n  }];\n}"
          },
          "id": "e49e0684-b6a8-42a0-915e-c782469d5e0e"
        },
        {
          "name": "Send Response",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            440,
            0
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ $json }}",
            "options": {}
          },
          "id": "1e1d9877-7987-4fb0-a0a0-bbaf31b885d9"
        }
      ],
      "connections": {
        "Transaction Webhook": {
          "main": [
            [
              {
                "node": "Transaction Categorizer",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Transaction Categorizer": {
          "main": [
            [
              {
                "node": "Send Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "cda01858-5411-4023-bb85-a901a6f35125",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:24.336Z",
          "createdAt": "2025-11-01T14:40:24.336Z",
          "role": "workflow:owner",
          "workflowId": "ouQj3CZAkgBOcquT",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-12-20T02:01:47Z",
      "createdAt": "2025-12-02T00:59:28.843Z",
      "id": "piW6arJDnuOjUU84",
      "name": "Claude Chat Analyzer - Simple",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.systemPrompt }}\n\n---\n\nHere are the chat conversations to analyze:\n\n{{ $json.chatData }}",
            "options": {}
          },
          "id": "478bc60a-6470-474d-bbe1-20f160db4dfb",
          "name": "AI Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.6,
          "position": [
            2736,
            256
          ]
        },
        {
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "options": {}
          },
          "id": "4c095c4e-f151-4f00-bcda-eed8ada6f5eb",
          "name": "Claude Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1,
          "position": [
            2640,
            496
          ],
          "credentials": {
            "anthropicApi": {
              "id": "IIca9t1WgOJ5kPJo",
              "name": "Anthropic Account"
            }
          }
        },
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "minutes"
                }
              ]
            }
          },
          "id": "7a4c3cbe-3530-456d-99a9-09397d5abe51",
          "name": "Every 5 Minutes1",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            1616,
            256
          ]
        },
        {
          "parameters": {
            "filePath": "C:\\Users\\bermi\\Projects\\CHAT_ANALYZER_MASTER\\config\\analysis_config.json"
          },
          "id": "84495eb3-4dbe-436b-9c2a-b2f73cb2b208",
          "name": "Read Config File1",
          "type": "n8n-nodes-base.readBinaryFile",
          "typeVersion": 1,
          "position": [
            1840,
            256
          ]
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "config",
                  "name": "config",
                  "value": "={{ JSON.parse($binary.data.toString()) }}",
                  "type": "object"
                }
              ]
            },
            "options": {}
          },
          "id": "7ccdd190-d023-4f6e-9d41-d0d173bfdff9",
          "name": "Parse Config1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            2064,
            256
          ]
        },
        {
          "parameters": {
            "filePath": "={{ $json.config.chatFilePath }}"
          },
          "id": "afe23274-484a-4245-9128-afa74d63b1a6",
          "name": "Read Chat File1",
          "type": "n8n-nodes-base.readBinaryFile",
          "typeVersion": 1,
          "position": [
            2288,
            256
          ]
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "chat_data",
                  "name": "chatData",
                  "value": "={{ $binary.data.toString() }}",
                  "type": "string"
                },
                {
                  "id": "system_prompt",
                  "name": "systemPrompt",
                  "value": "={{ $('Parse Config1').item.json.config.systemPrompt }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "171b856a-16e3-435a-a18c-e135083a2fa0",
          "name": "Prepare Data1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            2512,
            256
          ]
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "timestamp",
                  "name": "timestamp",
                  "value": "={{ $now.toISO() }}",
                  "type": "string"
                },
                {
                  "id": "analysis_result",
                  "name": "analysis",
                  "value": "={{ $json.response }}",
                  "type": "string"
                },
                {
                  "id": "output_path",
                  "name": "outputPath",
                  "value": "={{ $('Parse Config1').item.json.config.outputPath }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "3b4db08a-d3e9-4b3e-938e-d897a77aa876",
          "name": "Format Output1",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            3088,
            256
          ]
        },
        {
          "parameters": {
            "operation": "toJson",
            "mode": "each",
            "options": {}
          },
          "id": "cd429c9b-ab6d-4690-a4ab-b1a905a7905d",
          "name": "Convert to JSON1",
          "type": "n8n-nodes-base.convertToFile",
          "typeVersion": 1.1,
          "position": [
            3312,
            256
          ]
        },
        {
          "parameters": {
            "fileName": "={{ $json.outputPath }}",
            "options": {}
          },
          "id": "72e89ad6-00df-4b72-958a-61ab05bf6afa",
          "name": "Save Analysis Results1",
          "type": "n8n-nodes-base.writeBinaryFile",
          "typeVersion": 1,
          "position": [
            3536,
            256
          ]
        }
      ],
      "connections": {
        "AI Agent": {
          "main": [
            [
              {
                "node": "Format Output1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Every 5 Minutes1": {
          "main": [
            [
              {
                "node": "Read Config File1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read Config File1": {
          "main": [
            [
              {
                "node": "Parse Config1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse Config1": {
          "main": [
            [
              {
                "node": "Read Chat File1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read Chat File1": {
          "main": [
            [
              {
                "node": "Prepare Data1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare Data1": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Output1": {
          "main": [
            [
              {
                "node": "Convert to JSON1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Convert to JSON1": {
          "main": [
            [
              {
                "node": "Save Analysis Results1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Claude Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Every 5 Minutes1": {
          "recurrenceRules": []
        }
      },
      "meta": {
        "templateCredsSetupCompleted": true
      },
      "pinData": {},
      "versionId": "6436387e-c680-48e2-8ab6-21354da531c5",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-12-02T00:59:28.848Z",
          "createdAt": "2025-12-02T00:59:28.848Z",
          "role": "workflow:owner",
          "workflowId": "piW6arJDnuOjUU84",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:31.377Z",
      "createdAt": "2025-11-01T14:40:31.377Z",
      "id": "q2QAHOFny7lh59a0",
      "name": "Midjourney Automation Receiver (imported 20251101_144031)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook - Midjourney Data",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "midjourney-automation",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "1d26e691-26a8-4a19-9f75-87d73aed1799"
        },
        {
          "name": "Extract Data",
          "type": "n8n-nodes-base.set",
          "typeVersion": 1,
          "position": [
            450,
            300
          ],
          "parameters": {
            "values": {
              "string": [
                {
                  "name": "article_title",
                  "value": "={{ $json.article.title }}"
                },
                {
                  "name": "article_url",
                  "value": "={{ $json.article.url }}"
                },
                {
                  "name": "social_content",
                  "value": "={{ $json.socialPost.content }}"
                },
                {
                  "name": "image_url",
                  "value": "={{ $json.midjourney.imageUrl }}"
                },
                {
                  "name": "prompt",
                  "value": "={{ $json.midjourney.prompt }}"
                },
                {
                  "name": "timestamp",
                  "value": "={{ $json.timestamp }}"
                }
              ]
            },
            "options": {}
          },
          "id": "2273f5ed-46df-42cc-a434-839644816a80"
        },
        {
          "name": "Check Status",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{ $json.midjourney.status }}",
                  "operation": "equals",
                  "value2": "completed"
                }
              ]
            }
          },
          "id": "c74d0bca-5cc0-4426-a028-bccff80c19a8"
        },
        {
          "name": "Save to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 3,
          "position": [
            850,
            200
          ],
          "parameters": {
            "resource": "sheet",
            "operation": "append",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": "YOUR_GOOGLE_SHEET_ID"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Timestamp": "={{ $json.timestamp }}",
                "Article Title": "={{ $json.article_title }}",
                "Article URL": "={{ $json.article_url }}",
                "Social Content": "={{ $json.social_content }}",
                "Midjourney Prompt": "={{ $json.prompt }}",
                "Image URL": "={{ $json.image_url }}"
              }
            },
            "options": {}
          },
          "id": "81c303d6-6ebf-47fe-8261-5497c7e1a726"
        },
        {
          "name": "Send Email Notification",
          "type": "n8n-nodes-base.emailSend",
          "typeVersion": 2,
          "position": [
            850,
            400
          ],
          "parameters": {
            "fromEmail": "michael@rentasling.ie",
            "toEmail": "your-email@example.com",
            "subject": "New Midjourney Image Generated",
            "emailType": "html",
            "message": "=<h2>New Content Generated</h2><p><strong>Article:</strong> {{ $json.article_title }}</p><p><strong>Social Post:</strong><br>{{ $json.social_content }}</p><p><strong>Midjourney Prompt:</strong><br>{{ $json.prompt }}</p><p><strong>Image:</strong><br><img src=\"{{ $json.image_url }}\" style=\"max-width:600px;\"></p><hr><p><a href=\"{{ $json.article_url }}\">View Original Article</a></p>",
            "options": {}
          },
          "id": "07e202cd-5245-4ed4-92a1-64b639a0d446"
        },
        {
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ],
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ { \"success\": true, \"message\": \"Data received and processed\", \"timestamp\": $json.timestamp } }}",
            "options": {}
          },
          "id": "c9657919-91d1-48b2-8855-2a7b280ca14e"
        }
      ],
      "connections": {
        "Webhook - Midjourney Data": {
          "main": [
            [
              {
                "node": "Extract Data",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Data": {
          "main": [
            [
              {
                "node": "Check Status",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check Status": {
          "main": [
            [
              {
                "node": "Save to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Send Email Notification",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save to Google Sheets": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Email Notification": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "88f0699f-b2fa-49c7-9c80-ed3e11071726",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:31.379Z",
          "createdAt": "2025-11-01T14:40:31.379Z",
          "role": "workflow:owner",
          "workflowId": "q2QAHOFny7lh59a0",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:29Z",
      "createdAt": "2025-11-01T14:40:16.984Z",
      "id": "qHelXLMf3is1MvqN",
      "name": "My workflow 8",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Manual Trigger",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            1180,
            380
          ],
          "parameters": {},
          "id": "58aac225-5a01-443f-becf-66172286036b"
        },
        {
          "name": "Sample Transactions1",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1380,
            380
          ],
          "parameters": {
            "jsCode": "// Updated Booke AI transaction data with proper structure\nconst transactions = [\n  {\n    amount: 10.98,\n    transaction_date: \"2025-05-20\",\n    payee: \"Anthropic\",\n    category: \"Dues and subscriptions\",\n    tax_rate: \"23%: Standard\",\n    description: \"Anthropic\"\n  },\n  {\n    amount: 12.00,\n    transaction_date: \"2025-05-24\", \n    payee: \"Canva\",\n    category: \"Dues and subscriptions\",\n    tax_rate: \"23%: Standard\",\n    description: \"Canva* I04516-87152682\"\n  }\n];\n\nreturn transactions.map(transaction => ({\n  json: transaction\n}));"
          },
          "id": "0f405f62-9d41-4309-9492-43e71c3353ba"
        },
        {
          "name": "Import to Supabase1",
          "type": "n8n-nodes-base.supabase",
          "typeVersion": 1,
          "position": [
            1600,
            380
          ],
          "parameters": {
            "tableId": "historical_transactions"
          },
          "credentials": {
            "supabaseApi": {
              "id": "4WubaFtJIT0Bd6Ok",
              "name": "Supabase account"
            }
          },
          "id": "a39a45a3-1a85-4187-b2e8-b482a33bd5de"
        }
      ],
      "connections": {
        "Manual Trigger": {
          "main": [
            [
              {
                "node": "Sample Transactions1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Sample Transactions1": {
          "main": [
            [
              {
                "node": "Import to Supabase1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "a0415a45-7daf-40ad-9182-59c9eae226c0",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:16.986Z",
          "createdAt": "2025-11-01T14:40:16.986Z",
          "role": "workflow:owner",
          "workflowId": "qHelXLMf3is1MvqN",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:10Z",
      "createdAt": "2025-11-01T14:40:27.881Z",
      "id": "rEUhJ2N1ZDDRXD7e",
      "name": "Order Analytics Agent",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Order Analytics Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            160,
            -220
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Order Analytics Agent, providing comprehensive analytics and insights for custom orders, production efficiency, and business metrics. You transform workshop data into actionable insights that drive creative and operational decisions.\n\n## Tools Available\n\n### Google BigQuery\n- Order performance data\n- Production analytics\n- Customer behavior metrics\n- Custom SQL queries\n\n### Looker Dashboards\n- Real-time visualizations\n- Production dashboards\n- Sales reports\n- Custom analytics\n\n### Analytics API\n- Order data access\n- Metrics aggregation\n- Efficiency calculations\n- Trend analysis\n\n### Google Sheets Reports\n- Custom reports\n- Data exports\n- Production summaries\n- Profit calculations\n\n### Tableau Visualizations\n- Advanced data viz\n- Interactive dashboards\n- Sales trends\n- Predictive analytics\n\n### Slack Alerts\n- Performance notifications\n- Production milestones\n- Goal achievements\n- Weekly summaries\n\n## Key Metrics\n\n### Production Metrics\n- **Efficiency Metrics**\n  - Average production time\n  - Artisan utilization rate\n  - Stage completion times\n  - Quality pass rate\n- **Order Metrics**\n  - Orders in pipeline\n  - Customization complexity\n  - Rush order percentage\n  - On-time delivery rate\n- **Material Metrics**\n  - Component usage rates\n  - Waste percentage\n  - Material cost trends\n\n### Sales Metrics\n- **Revenue Performance**\n  - Average order value\n  - Customization upsell rate\n  - Product category mix\n  - Seasonal trends\n- **Customer Metrics**\n  - Repeat customer rate\n  - Customer lifetime value\n  - Geographic distribution\n  - Satisfaction scores\n- **Design Performance**\n  - Popular customizations\n  - Design category trends\n  - Limited edition sellout times\n\n### Business Metrics\n- **Financial Health**\n  - Gross margins by product\n  - Labor cost analysis\n  - Material cost trends\n  - Profitability by category\n- **Operational Efficiency**\n  - Workshop capacity utilization\n  - Lead time accuracy\n  - Inventory turnover\n- **Growth Indicators**\n  - New customer acquisition\n  - Market expansion\n  - Product line performance\n\n## Analytics Standards\n- Data freshness: Daily updates\n- Accuracy threshold: 99%\n- Reporting cadence: Daily/Weekly/Monthly\n- Data retention: 3 years\n\n## Report Types\n1. Executive Dashboards\n2. Production Efficiency Reports\n3. Sales Analytics\n4. Customer Insights\n5. Inventory Analysis\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "231b04d1-7fe1-427f-8f75-6fe9e8f1825f"
        },
        {
          "name": "Anthropic Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1.2,
          "position": [
            -460,
            140
          ],
          "parameters": {
            "options": {}
          },
          "id": "3ce06bef-31e6-48e9-a0cb-3f989b707385"
        },
        {
          "name": "Analytics API",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -300,
            160
          ],
          "parameters": {
            "toolDescription": "Access RetroFuture Analytics API",
            "method": "POST",
            "url": "https://api.retrofuturegadgetry.com/v2/analytics/query",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"metrics\": {metrics},\n  \"dimensions\": {dimensions},\n  \"filters\": {filters},\n  \"dateRange\": {\n    \"start\": \"{startDate}\",\n    \"end\": \"{endDate}\"\n  },\n  \"granularity\": \"{granularity}\",\n  \"timezone\": \"{timezone}\"\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "metrics",
                  "description": "Metrics to retrieve",
                  "type": "json"
                },
                {
                  "name": "dimensions",
                  "description": "Dimensions for grouping",
                  "type": "json"
                },
                {
                  "name": "filters",
                  "description": "Data filters",
                  "type": "json"
                },
                {
                  "name": "startDate",
                  "description": "Start date for analysis",
                  "type": "string"
                },
                {
                  "name": "endDate",
                  "description": "End date for analysis",
                  "type": "string"
                },
                {
                  "name": "granularity",
                  "description": "Data granularity (hour/day/week/month)",
                  "type": "string"
                },
                {
                  "name": "timezone",
                  "description": "Timezone for data",
                  "type": "string"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "3eadfe9d-d37a-481e-a1c3-089d51aeeb3d"
        },
        {
          "name": "Looker Dashboard",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -120,
            180
          ],
          "parameters": {
            "toolDescription": "Generate Looker dashboard or report",
            "method": "POST",
            "url": "https://retrofuture.looker.com/api/4.0/dashboards/{dashboardId}/render/{format}",
            "sendQuery": true,
            "parametersQuery": {
              "values": [
                {}
              ]
            },
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "dashboardId",
                  "description": "Looker dashboard ID",
                  "type": "string"
                },
                {
                  "name": "format",
                  "description": "Output format (pdf/png/csv)",
                  "type": "string"
                },
                {
                  "name": "filters",
                  "description": "Dashboard filters",
                  "type": "string"
                },
                {
                  "name": "limit",
                  "description": "Result limit",
                  "type": "string"
                },
                {
                  "name": "lookerToken",
                  "description": "Looker API token",
                  "type": "string"
                }
              ]
            }
          },
          "id": "592cfc27-2437-486b-8592-4a3037310178"
        },
        {
          "name": "Read Order Data",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            60,
            180
          ],
          "parameters": {
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "5e04572a-d6de-495f-896d-95b90f5a6bee"
        },
        {
          "name": "Create Custom Report",
          "type": "n8n-nodes-base.googleSheetsTool",
          "typeVersion": 4.4,
          "position": [
            220,
            180
          ],
          "parameters": {
            "operation": "create",
            "documentId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "options": {}
          },
          "id": "e69172d4-5061-4f96-bfce-3f0df01656b9"
        },
        {
          "name": "Calculate Metrics",
          "type": "@n8n/n8n-nodes-langchain.toolCode",
          "typeVersion": 1,
          "position": [
            380,
            180
          ],
          "parameters": {},
          "id": "fdb6b809-3807-4f7a-a3e6-d6ec02b33413"
        },
        {
          "name": "Create Visualization",
          "type": "@n8n/n8n-nodes-langchain.toolCode",
          "typeVersion": 1,
          "position": [
            580,
            180
          ],
          "parameters": {},
          "id": "dc08ac06-e382-4231-83e5-1b07b371e632"
        },
        {
          "name": "Send Analytics Report",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            760,
            180
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"recipientEmails\") }}",
            "subject": "RetroFuture Analytics Report - {{ $fromAI(\"reportPeriod\") }}",
            "message": "={{ $fromAI(\"emailContent\") }}",
            "options": {}
          },
          "id": "82060994-c47e-486c-a2d2-ddbaa2523c44"
        },
        {
          "name": "Export to Tableau",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            940,
            180
          ],
          "parameters": {
            "toolDescription": "Export data to Tableau",
            "method": "POST",
            "url": "https://retrofuture.tableau.com/api/3.14/sites/{siteId}/datasources",
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n  \"datasource\": {\n    \"name\": \"{datasourceName}\",\n    \"connectionCredentials\": {\n      \"name\": \"{connectionName}\",\n      \"password\": \"{password}\",\n      \"embed\": true\n    },\n    \"project\": {\n      \"id\": \"{projectId}\"\n    }\n  }\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "siteId",
                  "description": "Tableau site ID",
                  "type": "string"
                },
                {
                  "name": "datasourceName",
                  "description": "Name for the datasource",
                  "type": "string"
                },
                {
                  "name": "connectionName",
                  "description": "Connection name",
                  "type": "string"
                },
                {
                  "name": "password",
                  "description": "Connection password",
                  "type": "string"
                },
                {
                  "name": "projectId",
                  "description": "Tableau project ID",
                  "type": "string"
                },
                {
                  "name": "tableauToken",
                  "description": "Tableau auth token",
                  "type": "string"
                }
              ]
            }
          },
          "id": "ea0311b5-e140-4bd3-bf70-a5077a72f900"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            920,
            -320
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "f9f880bb-68a9-4c1b-89c0-227905161f14"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            920,
            -120
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process analytics request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "b4b18832-b373-45dd-a9b2-683ca21854d7"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -460,
            -220
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "2aa65805-6819-47ef-ae77-f6cd00d61613"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Anthropic Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Analytics API": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Looker Dashboard": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Read Order Data": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Create Custom Report": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Calculate Metrics": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Create Visualization": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Analytics Report": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Export to Tableau": {
          "ai_tool": [
            [
              {
                "node": "Order Analytics Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Order Analytics Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "bc201d9d-ef8c-46d5-b574-92b8677afb2f",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:27.884Z",
          "createdAt": "2025-11-01T14:40:27.884Z",
          "role": "workflow:owner",
          "workflowId": "rEUhJ2N1ZDDRXD7e",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:28.68Z",
      "createdAt": "2025-11-01T14:40:28.68Z",
      "id": "rd3GGcVXB9uPGpOO",
      "name": "Supply Chain Agent",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Supply Chain Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            -100,
            -160
          ],
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.query }}",
            "options": {
              "systemMessage": "# Overview\nYou are the RetroFuture Gadgetry Supply Chain Agent, managing the complex network of global suppliers for rare and vintage components. You track inventory levels, identify sourcing opportunities, and ensure continuous availability of unique materials for our artisanal gadgets.\n\n## Tools Available\n\n### Web Research\n- Vintage component markets\n- Supplier discovery\n- Material availability\n- Price trends\n\n### Inventory Management API\n- Stock levels tracking\n- Reorder points\n- Lead time monitoring\n- Cost analytics\n\n### Google BigQuery Analytics\n- Supplier performance data\n- Component usage trends\n- Cost optimization analysis\n- Quality metrics\n\n### Airtable Supplier Database\n- Vendor tracking\n- Component catalog\n- Quality ratings\n- Alternative sources\n\n### Slack Supply Updates\n- Stock alerts\n- New supplier notifications\n- Quality issues\n- Price changes\n\n## Key Suppliers\n### Metalwork Components\n- Victorian Brass Works (UK)\n- Steampunk Supply Co. (Germany)\n- Vintage Gear House (USA)\n- Clockwork Components Ltd. (Switzerland)\n\n### Electronics & LEDs\n- Retro Tech Parts (Japan)\n- Nixie Dreams (Ukraine)\n- Edison Elements (USA)\n- Vacuum Tube Vault (Russia)\n\n### Specialty Materials\n- Antique Leather Goods (Italy)\n- Reclaimed Wood Artisans (Canada)\n- Patina Chemicals Inc. (USA)\n- Glass & Crystal Works (Czech Republic)\n\n## Inventory Focus Areas\n\n### Critical Components\n- Brass gears (various sizes)\n- Copper tubing & fittings\n- Vintage-style LEDs\n- Leather pieces\n- Wood inlays\n- Watch movements\n- Specialty fasteners\n\n### Sourcing Challenges\n- Rare vacuum tubes\n- Authentic vintage parts\n- Custom gear specifications\n- Period-correct materials\n- Limited edition components\n\n### Quality Standards\n- Material authenticity verification\n- Supplier reliability scores\n- Component testing protocols\n- Alternative source mapping\n\n### Strategic Inventory\n- Safety stock levels\n- Seasonal demand planning\n- Limited edition preparations\n- Rush order buffers\n\nMinimum order quantities:\n- Standard components: 50 units\n- Rare components: 10 units\n- Custom pieces: Negotiable\n\nCurrent Date/Time: {{ $now }}"
            }
          },
          "onError": "continueErrorOutput",
          "id": "567bfda6-c555-418b-9019-276221ce45be"
        },
        {
          "name": "Anthropic Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1.2,
          "position": [
            -420,
            80
          ],
          "parameters": {
            "options": {}
          },
          "id": "e44aec8b-0fe7-4506-8f42-d842e623cb57"
        },
        {
          "name": "Component Research",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -260,
            120
          ],
          "parameters": {
            "toolDescription": "Search for component suppliers and materials",
            "method": "POST",
            "url": "https://api.tavily.com/search",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "{\n    \"api_key\": \"{tavilyApiKey}\",\n    \"query\": \"{searchQuery}\",\n    \"search_depth\": \"advanced\",\n    \"include_answer\": true,\n    \"include_raw_content\": true,\n    \"max_results\": 10,\n    \"include_domains\": [\"etsy.com\", \"ebay.com\", \"alibaba.com\", \"steampunkgarage.com\", \"clockworkcomponents.com\"],\n    \"days\": 30\n}",
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "searchQuery",
                  "description": "Component or supplier search query",
                  "type": "string"
                },
                {
                  "name": "tavilyApiKey",
                  "description": "Tavily API key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "629e835d-0e0a-4ec2-a011-96009bb84632"
        },
        {
          "name": "Inventory Data API",
          "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
          "typeVersion": 1.1,
          "position": [
            -60,
            140
          ],
          "parameters": {
            "toolDescription": "Access RetroFuture inventory data",
            "url": "https://api.retrofuturegadgetry.com/v2/inventory/{endpoint}",
            "sendQuery": true,
            "parametersQuery": {
              "values": [
                {}
              ]
            },
            "sendHeaders": true,
            "parametersHeaders": {
              "values": [
                {}
              ]
            },
            "placeholderDefinitions": {
              "values": [
                {
                  "name": "endpoint",
                  "description": "API endpoint (stock-levels/suppliers/reorder-points)",
                  "type": "string"
                },
                {
                  "name": "componentType",
                  "description": "Type of component",
                  "type": "string"
                },
                {
                  "name": "supplier",
                  "description": "Specific supplier",
                  "type": "string"
                },
                {
                  "name": "urgency",
                  "description": "Urgency level for reorder",
                  "type": "string"
                },
                {
                  "name": "apiKey",
                  "description": "RetroFuture API Key",
                  "type": "string"
                }
              ]
            }
          },
          "id": "7a91979d-651b-4b01-a40e-251eaf11f86d"
        },
        {
          "name": "Supplier Database",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            100,
            140
          ],
          "parameters": {
            "operation": "search",
            "base": {
              "__rl": true,
              "value": "retrofuture-supply-chain",
              "mode": "list",
              "cachedResultName": "Supply Chain"
            },
            "table": {
              "__rl": true,
              "value": "suppliers-components",
              "mode": "list",
              "cachedResultName": "Suppliers & Components"
            },
            "filterByFormula": "={{ $fromAI(\"airtableFilter\", \"\") }}",
            "options": {}
          },
          "id": "44b6659b-c3cc-4990-8930-8d4480b62e0f"
        },
        {
          "name": "Log Sourcing Opportunity",
          "type": "n8n-nodes-base.airtableTool",
          "typeVersion": 2.1,
          "position": [
            220,
            100
          ],
          "parameters": {
            "operation": "create",
            "base": {
              "__rl": true,
              "value": "retrofuture-supply-chain",
              "mode": "list",
              "cachedResultName": "Supply Chain"
            },
            "table": {
              "__rl": true,
              "value": "sourcing-opportunities",
              "mode": "list",
              "cachedResultName": "Sourcing Opportunities"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "componentName": "={{ $fromAI(\"componentName\") }}",
                "supplier": "={{ $fromAI(\"supplier\") }}",
                "type": "={{ $fromAI(\"componentType\") }}",
                "unitCost": "={{ $fromAI(\"unitCost\") }}",
                "minimumOrder": "={{ $fromAI(\"minimumOrder\") }}",
                "leadTime": "={{ $fromAI(\"leadTime\") }}",
                "qualityRating": "={{ $fromAI(\"qualityRating\") }}",
                "notes": "={{ $fromAI(\"notes\") }}",
                "identifiedDate": "={{ $now }}"
              }
            },
            "options": {}
          },
          "id": "2171c39a-31c7-4c45-a8ed-6a2af096fdbd"
        },
        {
          "name": "Share Supply Update",
          "type": "n8n-nodes-base.slackTool",
          "typeVersion": 1.4,
          "position": [
            -540,
            440
          ],
          "parameters": {},
          "credentials": {},
          "id": "a0d257da-8def-47a6-9253-cf9a951c9cb1"
        },
        {
          "name": "Create Inventory Report",
          "type": "n8n-nodes-base.googleDocsTool",
          "typeVersion": 1.1,
          "position": [
            -540,
            680
          ],
          "parameters": {},
          "credentials": {},
          "id": "1dde421a-17d2-47e2-9b1b-2276b10e37f3"
        },
        {
          "name": "Send Supply Report",
          "type": "n8n-nodes-base.gmailTool",
          "typeVersion": 2.1,
          "position": [
            380,
            100
          ],
          "parameters": {
            "sendTo": "={{ $fromAI(\"recipientEmails\") }}",
            "subject": "RetroFuture Supply Chain Alert: {{ $fromAI(\"alertSubject\") }}",
            "message": "={{ $fromAI(\"emailContent\") }}",
            "options": {}
          },
          "id": "8c7f1ada-08f5-43ea-8ae0-379bbab4013a"
        },
        {
          "name": "Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            480,
            -260
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "response-id",
                  "name": "response",
                  "value": "={{ $json.output }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "70d3e514-089a-4a2c-9f12-35ca8de3f1ef"
        },
        {
          "name": "Try Again",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            480,
            -60
          ],
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-response-id",
                  "name": "response",
                  "value": "Unable to process supply chain request. Please try again.",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "7cdf92e9-6dce-4d51-a3b4-d66862e79ca0"
        },
        {
          "name": "When Executed by Another Workflow",
          "type": "n8n-nodes-base.executeWorkflowTrigger",
          "typeVersion": 1.1,
          "position": [
            -540,
            -160
          ],
          "parameters": {
            "inputSource": "passthrough"
          },
          "id": "13454a47-aa40-4ae9-84a5-07256b7cd403"
        }
      ],
      "connections": {
        "When Executed by Another Workflow": {
          "main": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Anthropic Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Component Research": {
          "ai_tool": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Inventory Data API": {
          "ai_tool": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Supplier Database": {
          "ai_tool": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Log Sourcing Opportunity": {
          "ai_tool": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Send Supply Report": {
          "ai_tool": [
            [
              {
                "node": "Supply Chain Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Supply Chain Agent": {
          "main": [
            [
              {
                "node": "Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Try Again",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "c3c801dc-479e-4ff2-a523-2194282a8362",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:28.682Z",
          "createdAt": "2025-11-01T14:40:28.682Z",
          "role": "workflow:owner",
          "workflowId": "rd3GGcVXB9uPGpOO",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:25.694Z",
      "createdAt": "2025-11-01T14:40:25.694Z",
      "id": "sZ5qXLTp6duyefVN",
      "name": "liverpool article creator",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "RSS Feed",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 1,
          "position": [
            -1328,
            304
          ],
          "parameters": {
            "url": "https://rss.app/feeds/v1.1/_457R0dF6WskCgWEX.json",
            "jsonParameters": true,
            "options": {}
          },
          "notesInFlow": true,
          "executeOnce": true,
          "retryOnFail": true,
          "alwaysOutputData": true,
          "id": "9decf6af-bedc-4e97-9be3-36b60837fd6a"
        },
        {
          "name": "LinkedIn Post Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -224,
            112
          ],
          "parameters": {
            "prompt": "=Write a concise and engaging LinkedIn post based on the following article details. The tone should be professional, slightly witty, and suitable for a general audience. Summarize the event and highlight the human effort and community involvement. End with a thoughtful or light-hearted reflection.\n\nTitle: {{ $json[\"items\"][0][\"title\"] }}\nURL: {{ $json[\"items\"][0][\"url\"] }}\nContent: {{ $json[\"items\"][0][\"content_text\"] }}\n\nUse 2–4 short paragraphs, no hashtags or emojis. Avoid generic filler—make it feel personal and insightful.\n",
            "options": {},
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "5f5c341c-5e55-4d6b-a8fb-3645e3708abe"
        },
        {
          "name": "Blog Post Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -224,
            512
          ],
          "parameters": {
            "options": {},
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "38be354c-87ca-4ab0-a7af-2283e43cab6e"
        },
        {
          "name": "Instagram Caption Generator",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            -224,
            304
          ],
          "parameters": {
            "options": {},
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "4c54fbcd-4c13-42d6-904b-8987068feda5"
        },
        {
          "name": "Add LinkedIn Post to Doc",
          "type": "n8n-nodes-base.googleDocs",
          "typeVersion": 1,
          "position": [
            208,
            208
          ],
          "parameters": {
            "folderId": "=default",
            "title": "="
          },
          "credentials": {
            "googleApi": {
              "id": "Y3FPNtcn83osRFUx",
              "name": "Google Docs account"
            }
          },
          "id": "6ebc6d60-0ba7-486a-9a92-363ff5d76ae1"
        },
        {
          "name": "When clicking ‘Test workflow’",
          "type": "n8n-nodes-base.manualTrigger",
          "typeVersion": 1,
          "position": [
            -1536,
            304
          ],
          "parameters": {},
          "id": "f218efc3-eaa5-4400-92c2-7f922645877c"
        },
        {
          "name": "Generate an image",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            -16,
            112
          ],
          "parameters": {
            "resource": "image",
            "prompt": "=you are state of the art world renouned viral content producer and designer. create 2 options of highly optimised viral content imagery to coincide with the article title:  {{ $json.text }} it must be instantly recognisable and created strategicly drawing in maximum audience.  the image must be allowable and not infringe any copyright or ethical laws. ultra realism, bright colours highlighting the main focus of the image. ",
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "79334431-eabd-493b-8f41-f574328fd1c9"
        },
        {
          "name": "Create a database page",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2.2,
          "position": [
            416,
            208
          ],
          "parameters": {
            "resource": "databasePage",
            "databaseId": {
              "__rl": true,
              "mode": "list",
              "value": ""
            },
            "options": {}
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "ee6c9f4a-3554-4a40-a867-89762b64f7b9"
        }
      ],
      "connections": {
        "RSS Feed": {
          "main": [
            [
              {
                "node": "LinkedIn Post Generator",
                "type": "main",
                "index": 0
              },
              {
                "node": "Blog Post Generator",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram Caption Generator",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LinkedIn Post Generator": {
          "main": [
            [
              {
                "node": "Add LinkedIn Post to Doc",
                "type": "main",
                "index": 0
              },
              {
                "node": "Generate an image",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram Caption Generator",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "When clicking ‘Test workflow’": {
          "main": [
            [
              {
                "node": "RSS Feed",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate an image": {
          "main": [
            [
              {
                "node": "Add LinkedIn Post to Doc",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Instagram Caption Generator": {
          "main": [
            [
              {
                "node": "Add LinkedIn Post to Doc",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Blog Post Generator": {
          "main": [
            [
              {
                "node": "Add LinkedIn Post to Doc",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add LinkedIn Post to Doc": {
          "main": [
            [
              {
                "node": "Create a database page",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create a database page": {
          "main": [
            [
              {
                "node": "Blog Post Generator",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "255d8c21-eab1-4fe1-b889-d2d16930fe24",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:25.696Z",
          "createdAt": "2025-11-01T14:40:25.696Z",
          "role": "workflow:owner",
          "workflowId": "sZ5qXLTp6duyefVN",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-01T14:40:30.668Z",
      "createdAt": "2025-11-01T14:40:30.668Z",
      "id": "tMuHYCbtXj3l2dFE",
      "name": "Evening Autopilot (17:00) (imported 20251101_144031)",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "name": "Schedule Trigger - 17:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 17 * * *"
                }
              ]
            }
          },
          "id": "b4c13b0d-a507-4771-9cb2-5dfa40e8a96a"
        }
      ],
      "connections": {},
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "f9a26db4-d13f-4205-acb6-2a8800e19d6a",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:30.669Z",
          "createdAt": "2025-11-01T14:40:30.669Z",
          "role": "workflow:owner",
          "workflowId": "tMuHYCbtXj3l2dFE",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:40Z",
      "createdAt": "2025-11-02T02:39:00.129Z",
      "id": "uKF4RK3vt8GvERWA",
      "name": "My workflow 17",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "Webhook Trigger",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1,
          "position": [
            32,
            208
          ],
          "parameters": {
            "httpMethod": "POST",
            "path": "product-generator",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "dacc46e7-5d2c-44fc-969f-830f4f46c37e"
        },
        {
          "name": "Generate Product Ideas",
          "type": "n8n-nodes-base.openAi",
          "typeVersion": 1,
          "position": [
            256,
            208
          ],
          "parameters": {
            "resource": "chat",
            "model": "gpt-4o",
            "prompt": {
              "messages": [
                {
                  "role": "system",
                  "content": "="
                },
                {}
              ]
            },
            "simplifyOutput": false,
            "options": {
              "temperature": 0.8
            },
            "requestOptions": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "21c109cf-a744-48dd-99d0-03ea3b2c6a4c"
        },
        {
          "name": "Parse Product JSON",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3,
          "position": [
            480,
            208
          ],
          "parameters": {
            "mode": "raw",
            "jsonOutput": "={{ $('Webhook Trigger').item.json.headers }}",
            "include": "=all",
            "options": {
              "includeBinary": true
            }
          },
          "id": "3557891c-064a-45e1-a99a-78eb3c022760"
        },
        {
          "name": "Split Products",
          "type": "n8n-nodes-base.itemLists",
          "typeVersion": 3,
          "position": [
            704,
            208
          ],
          "parameters": {
            "operation": "sort",
            "options": {}
          },
          "id": "166c4c39-5fe7-4446-90d4-c8afaf7370a1"
        },
        {
          "name": "Create Notion Page",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            928,
            208
          ],
          "parameters": {
            "resource": "databasePage",
            "databaseId": {
              "__rl": true,
              "value": "1c374ec0-3114-808f-8e4b-cfbadfd69718",
              "mode": "list",
              "cachedResultName": "balding_pig_product_cycle_auto",
              "cachedResultUrl": "https://www.notion.so/1c374ec03114808f8e4bcfbadfd69718"
            },
            "title": "=",
            "simple": false,
            "propertiesUi": {
              "propertyValues": [
                {
                  "key": "="
                }
              ]
            },
            "blockUi": {
              "blockValues": [
                {
                  "type": "=paragraph"
                }
              ]
            },
            "options": {}
          },
          "credentials": {
            "notionApi": {
              "id": "iXXMUI2nDsagTUtL",
              "name": "Notion account"
            }
          },
          "id": "568d103a-78f7-4d86-98c4-77f03a484d3d"
        },
        {
          "name": "Wait 5 Seconds",
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1,
          "position": [
            1568,
            304
          ],
          "parameters": {
            "amount": 5,
            "unit": "seconds"
          },
          "id": "72f63630-b9fb-482a-93b0-ac86929204ac"
        },
        {
          "name": "Prepare Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3,
          "position": [
            480,
            656
          ],
          "parameters": {
            "mode": "raw",
            "options": {}
          },
          "id": "bcfec108-4e6a-4678-9761-78cf18c0db49"
        },
        {
          "name": "Webhook Response",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1,
          "position": [
            704,
            656
          ],
          "parameters": {
            "respondWith": "=allIncomingItems",
            "responseBody": "",
            "options": {}
          },
          "id": "60b478af-952e-4aea-bb96-d55ee482bb90"
        },
        {
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "content": "## 🐷 BaldingPig Product Generator Workflow\n\nThis workflow:\n1. Receives product idea prompts via webhook\n2. Generates 3 product ideas using OpenAI\n3. Creates pages in Notion database\n4. Sends Midjourney prompts to Discord\n5. Returns summary to Flask app\n\n### Setup Required:\n1. Add OpenAI credentials\n2. Add Notion credentials\n3. Update Discord webhook URL in Flask app\n4. Activate workflow when ready",
            "height": 223.2578125,
            "width": 389.17578125
          },
          "id": "31477f38-71e3-43fa-b23a-51b44fc11534"
        },
        {
          "name": "Generate an image",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1.8,
          "position": [
            1152,
            208
          ],
          "parameters": {
            "resource": "image",
            "prompt": "=",
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "73143e11-e2b4-4e72-b23c-df19e4496863"
        },
        {
          "name": "Split Out",
          "type": "n8n-nodes-base.splitOut",
          "typeVersion": 1,
          "position": [
            1408,
            96
          ],
          "parameters": {
            "fieldToSplitOut": "=",
            "include": "allOtherFields",
            "options": {}
          },
          "id": "80da0046-c0d0-4a87-bcc8-9a67c20ca39e"
        }
      ],
      "connections": {
        "Webhook Trigger": {
          "main": [
            [
              {
                "node": "Generate Product Ideas",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Product Ideas": {
          "main": [
            [
              {
                "node": "Parse Product JSON",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Parse Product JSON": {
          "main": [
            [
              {
                "node": "Split Products",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Split Products": {
          "main": [
            [
              {
                "node": "Create Notion Page",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Notion Page": {
          "main": [
            [
              {
                "node": "Generate an image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait 5 Seconds": {
          "main": [
            [
              {
                "node": "Prepare Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Prepare Response": {
          "main": [
            [
              {
                "node": "Webhook Response",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate an image": {
          "main": [
            [
              {
                "node": "Split Out",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Split Out": {
          "main": [
            [
              {
                "node": "Wait 5 Seconds",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "9a65b683-c191-4df0-9c12-b72574cf223d",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-02T02:39:00.132Z",
          "createdAt": "2025-11-02T02:39:00.132Z",
          "role": "workflow:owner",
          "workflowId": "uKF4RK3vt8GvERWA",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-29T03:28:16Z",
      "createdAt": "2025-11-27T21:38:02.045Z",
      "id": "veiFKt73XpNZskNW",
      "name": "Generate AI viral videos with NanoBanana & VEO3, shared on socials via Blotato 2",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "content": "# 📑 STEP 5 — Auto-Post to All Platforms\n\n",
            "height": 832,
            "width": 1344,
            "color": 4
          },
          "id": "101bdee1-4de4-4b5e-9170-4d490d4e8128",
          "name": "Sticky Note3",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2320,
            880
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "db2db976-7988-4939-a931-b6b2b98570aa",
          "name": "Upload Video to BLOTATO",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2384,
            1504
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "6866a654-e6a7-4543-b98a-8288f9d04b47",
          "name": "Youtube",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1296
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "a1b51932-2e2c-4e32-a37a-7ce94620cdd9",
          "name": "Tiktok",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1120
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "mode": "chooseBranch",
            "numberInputs": 9
          },
          "id": "2c6cb6a6-e4b2-470d-8afb-b2c03b72e97b",
          "name": "Merge",
          "type": "n8n-nodes-base.merge",
          "position": [
            3296,
            1200
          ],
          "typeVersion": 3.2
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "columns": {
              "value": {
                "STATUS": "Published",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "bee496d6-fc2d-4f1c-812f-9d6be08154a7",
          "name": "Update Status to \"DONE\"",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            3472,
            1312
          ],
          "typeVersion": 4.5,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "5f7344d8-a277-457b-a33f-c48e2ced1e49",
          "name": "Linkedin",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1120
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "31bc2347-2457-4fad-8436-09282df89609",
          "name": "Facebook",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1120
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "06e29e46-c3ce-4c9e-825d-39df924a607d",
          "name": "Instagram",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1296
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "3f7560c8-3e4a-4d62-bf62-e8d543df8026",
          "name": "Threads",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2640,
            1504
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "3e4b6251-7c56-40ca-8fb6-4b77c910a2e6",
          "name": "Bluesky",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1504
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "61f5f513-b7ec-40ca-a4a1-1b897f092a04",
          "name": "Pinterest",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            3008,
            1504
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "4fb185bf-f237-4b71-8557-178f15f0caec",
          "name": "Twitter (X)",
          "type": "@blotato/n8n-nodes-blotato.blotato",
          "position": [
            2832,
            1296
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "id": "cb9939c6-1c5c-448b-ab3a-a66d90767cf2",
          "name": "OpenAI Chat Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            1840,
            1216
          ],
          "typeVersion": 1.2,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {},
          "id": "2c244851-7835-4f4a-8fe9-10a26acf6365",
          "name": "Think",
          "type": "@n8n/n8n-nodes-langchain.toolThink",
          "position": [
            1984,
            1216
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "jsonSchemaExample": "{\n  \"title\": \"string\",\n  \"final_prompt\": \"string\"\n}\n"
          },
          "id": "0695e935-93ac-48da-a893-1615ce22a6e7",
          "name": "Structured Output Parser",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            2128,
            1216
          ],
          "typeVersion": 1.3
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.chat.id }}",
            "text": "=Url VIDEO : {{ $('Download Video from VEO3').item.json.data.response.resultUrls[0] }}",
            "additionalFields": {}
          },
          "id": "ff995af1-503e-4356-8e67-6392b4629496",
          "name": "Send Video URL via Telegram",
          "type": "n8n-nodes-base.telegram",
          "position": [
            2368,
            1008
          ],
          "webhookId": "ea6e5974-1930-4b67-a51b-16249a9ed8bd",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $json.result.chat.id }}",
            "file": "={{ $('Save Caption Video to Google Sheets').item.json['URL VIDEO FINAL'] }}",
            "additionalFields": {}
          },
          "id": "257eedc1-30c1-4e40-913b-24ceb018df28",
          "name": "Send Final Video Preview",
          "type": "n8n-nodes-base.telegram",
          "position": [
            2384,
            1248
          ],
          "webhookId": "443fd41d-a051-45bf-ad68-173197dba26b",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "updates": "={{ [\"message\"] }}",
            "additionalFields": {}
          },
          "id": "11f4ee14-912b-4a77-8696-7d36f7fc8a21",
          "name": "Telegram Trigger: Receive Video Idea",
          "type": "n8n-nodes-base.telegramTrigger",
          "position": [
            1152,
            432
          ],
          "webhookId": "26dbe6f5-5197-4b2b-9e32-8060f2119686",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "cc2e0500-57b1-4615-82cb-1c950e5f2ec4",
                  "name": "json_master",
                  "type": "string",
                  "value": "={\n  \"description\": \"Brief narrative description of the scene, focusing on key visual storytelling and product transformation.\",\n  \"style\": \"cinematic | photorealistic | stylized | gritty | elegant\",\n  \"camera\": {\n    \"type\": \"fixed | dolly | Steadicam | crane combo\",\n    \"movement\": \"describe any camera moves like slow push-in, pan, orbit\",\n    \"lens\": \"optional lens type or focal length for cinematic effect\"\n  },\n  \"lighting\": {\n    \"type\": \"natural | dramatic | high-contrast\",\n    \"sources\": \"key lighting sources (sunset, halogen, ambient glow...)\",\n    \"FX\": \"optional VFX elements like fog, reflections, flares\"\n  },\n  \"environment\": {\n    \"location\": \"describe location or room (kitchen, desert, basketball court...)\",\n    \"set_pieces\": [\n      \"list of key background or prop elements\",\n      \"e.g. hardwood floors, chain-link fence, velvet surface\"\n    ],\n    \"mood\": \"describe the ambient atmosphere (moody, clean, epic...)\"\n  },\n  \"elements\": [\n    \"main physical items involved (product box, accessories, vehicles...)\",\n    \"include brand visibility (logos, packaging, texture...)\"\n  ],\n  \"subject\": {\n    \"character\": {\n      \"description\": \"optional – physical description, outfit\",\n      \"pose\": \"optional – position or gesture\",\n      \"lip_sync_line\": \"optional – spoken line if there’s a voiceover\"\n    },\n    \"product\": {\n      \"brand\": \"Brand name\",\n      \"model\": \"Product model or name\",\n      \"action\": \"description of product transformation or assembly\"\n    }\n  },\n  \"motion\": {\n    \"type\": \"e.g. transformation, explosion, vortex\",\n    \"details\": \"step-by-step visual flow of how elements move or evolve\"\n  },\n  \"VFX\": {\n    \"transformation\": \"optional – describe style (neon trails, motion blur...)\",\n    \"impact\": \"optional – e.g. shockwave, glow, distortion\",\n    \"particles\": \"optional – embers, sparks, thread strands...\",\n    \"environment\": \"optional – VFX affecting the scene (ripples, wind...)\"\n  },\n  \"audio\": {\n    \"music\": \"optional – cinematic score, trap beat, ambient tone\",\n    \"sfx\": [\n      \"list of sound effects (zip, pop, woosh...)\"\n    ],\n    \"ambience\": \"optional – background soundscape (traffic, wind...)\",\n    \"voiceover\": {\n      \"delivery\": \"tone and style (confident, whisper, deep...)\",\n      \"line\": \"text spoken if applicable\"\n    }\n  },\n  \"ending\": \"Final shot description – what is seen or felt at the end (freeze frame, logo pulse, glow...)\",\n  \"text\": \"none | overlay | tagline | logo pulse at end only\",\n  \"format\": \"16:9 | 4k | vertical\",\n  \"keywords\": [\n    \"brand\",\n    \"scene style\",\n    \"motion type\",\n    \"camera style\",\n    \"sound mood\",\n    \"target theme\"\n  ]\n}\n"
                }
              ]
            },
            "options": {}
          },
          "id": "45e0b8ee-b830-48bc-8a9a-a426a7afcd43",
          "name": "Set Master Prompt",
          "type": "n8n-nodes-base.set",
          "position": [
            1600,
            992
          ],
          "typeVersion": 3.4
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Create a UGC-style video prompt using both the reference image and the user description.  \n\n**Inputs**  \n- User description (optional):  \n  `{{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}`  \n- Reference image analysis (stay strictly faithful to what’s visible):  \n  `{{ $('Google Sheets: Update Image Description').item.json['IMAGE DESCRIPTION'] }}`  \n\n**Rules**  \n- Keep the style casual, authentic, and realistic. Avoid studio-like or cinematic language.  \n- Default model: `veo3_fast` (unless otherwise specified).  \n- Output only **one JSON object** with the key: `video_prompt`.  \n",
            "hasOutputParser": true,
            "options": {
              "systemMessage": "=system_prompt:\n  ## SYSTEM PROMPT: Structured Video Ad Prompt Generator\n  A - Ask:\n    Generate a structured video ad prompt for cinematic generation, strictly based on the master schema provided in: {{ $json.json_master }}.\n    The final result must be a JSON object with exactly two top-level keys: `title` and `final_prompt`.\n\n  G - Guidance:\n    role: Creative Director\n    output_count: 1\n    character_limit: None\n    constraints:\n      - The output must be valid JSON.\n      - The `title` field should contain a short, descriptive and unique title (max 15 words).\n      - The `final_prompt` field must contain a **single-line JSON string** that follows the exact structure of {{ $json.json_master }} with all fields preserved.\n      - Do not include any explanations, markdown, or extra text — only the JSON object.\n      - Escape all inner quotes in the `final_prompt` string so it is valid as a stringified JSON inside another JSON.\n    tool_usage:\n      - Ensure consistent alignment across all fields (camera, lighting, motion, etc.).\n      - Maintain full structure even for optional fields (use \"none\", \"\", or [] as needed).\n\n  N - Notation:\n    format: JSON\n    expected_output:\n      {\n        \"title\": \"A unique short title for the scene\",\n        \"final_prompt\": \"{...stringified JSON of the full prompt...}\"\n      }\n\n"
            }
          },
          "id": "a27e8e28-cb43-4b3f-a96e-e986a25209fb",
          "name": "AI Agent: Generate Video Script",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            1920,
            992
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/veo/generate",
            "authentication": "predefinedCredentialType",
            "nodeCredentialType": "googleApi",
            "sendBody": true,
            "contentType": "raw",
            "rawContentType": "application/json",
            "body": "={\n  \"prompt\": {{ $json.prompt }},\n  \"model\": \"{{ $('Google Sheets: Read Video Parameters (CONFIG)').item.json.model }}\",\n  \"aspectRatio\": \"{{ $json.aspectRatio }}\",\n  \"imageUrls\": [\n    \"{{ $('Download Edited Image').item.json.images[0].url }}\"\n  ]\n}",
            "options": {}
          },
          "id": "16902ea9-197e-4cac-936e-83c1fc226854",
          "name": "Generate Video with VEO3",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            1200,
            1504
          ],
          "typeVersion": 4.2,
          "credentials": {
            "httpHeaderAuth": {
              "id": "tuSFB1kiLHhmlFl7",
              "name": "Novel Studio ElevenLabs"
            },
            "googleApi": {
              "id": "SOyhZ88a9rBcjUyN",
              "name": "veo3 and service account google"
            }
          }
        },
        {
          "parameters": {
            "amount": 20
          },
          "id": "a7fffb23-dba4-4d1e-a42e-191a1414ec60",
          "name": "Wait for VEO3 Rendering",
          "type": "n8n-nodes-base.wait",
          "position": [
            1408,
            1504
          ],
          "webhookId": "f6d814f3-4eb8-4629-a920-134cfa4ea03b",
          "typeVersion": 1.1
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/veo/record-info",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('Generate Video with VEO3').item.json.data.taskId }}"
                }
              ]
            },
            "options": {}
          },
          "id": "67889216-2c0f-4ed8-ae54-8e7e7fdbac90",
          "name": "Download Video from VEO3",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            1616,
            1504
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4o",
              "cachedResultName": "GPT-4O"
            },
            "messages": {
              "values": [
                {
                  "content": "=You are rewriting a TikTok video script, caption, and overlay —\nnot inventing a new one. You must follow this format and obey\nthese rules strictly.\n---\n### CONTEXT:\nHere is the content idea to use:{{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}\n\nand the Title is : {{ $('AI Agent: Generate Video Script').item.json.output.title }}\n\n\nWrite the caption text using the topic.\n\n---\n- MUST be under 200 characters (yes \"Characters\" not wordcount)\nthis is an absolute MUST, no more than 200 characters!!! \n\n### FINAL OUTPUT FORMAT (no markdown formatting):\n\nDO NOT return any explanations. Only return the Caption Text\n"
                }
              ]
            },
            "options": {}
          },
          "id": "f6dda272-6129-4c04-b4c2-1e6bf5d156d8",
          "name": "Rewrite Caption with GPT-4o",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            1776,
            1504
          ],
          "typeVersion": 1.8,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "columns": {
              "value": {
                "STATUS": "CREATE",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
                "TITRE VIDEO": "={{ $('AI Agent: Generate Video Script').item.json.output.title }}",
                "CAPTION VIDEO": "={{ $json.message.content }}",
                "URL VIDEO FINAL": "={{ $('Download Video from VEO3').item.json.data.response.resultUrls[0] }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "8b4c6b55-a0d7-4a19-b85c-1927ccb5eaa2",
          "name": "Save Caption Video to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            2080,
            1504
          ],
          "typeVersion": 4.6,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const structuredPrompt = $input.first().json.output.final_prompt;\nreturn {\n  json: {\n    prompt: JSON.stringify(structuredPrompt), // this escapes it correctly!\n    model: \"veo3_fast\",\n    aspectRatio: \"16:9\"\n  }\n};\n"
          },
          "id": "30c415e0-58e0-48b9-b7e9-11dc5d979ac8",
          "name": "Format Prompt",
          "type": "n8n-nodes-base.code",
          "position": [
            1200,
            1200
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "content": "# 📑 STEP 3 — Generate Video Ad Script",
            "height": 460,
            "width": 1180
          },
          "id": "61ce4a03-4104-4beb-bb16-0b2d2dde142d",
          "name": "Sticky Note2",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            880
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 4 — Generate Video with VEO3",
            "height": 320,
            "width": 1180
          },
          "id": "9f91c353-3ad6-498c-ba14-907bb91e208c",
          "name": "Sticky Note4",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            1392
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 1 — Collect Idea & Image",
            "height": 592,
            "width": 1184
          },
          "id": "3051b833-571a-4f0c-993a-ca8ffd03e476",
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            1088,
            240
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 2 — Create Image with NanoBanana\n",
            "height": 592,
            "width": 1328
          },
          "id": "785aa7c8-8921-4b6b-8db3-8d55e2a42564",
          "name": "Sticky Note1",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2320,
            240
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "resource": "file",
            "fileId": "={{ $json.message.photo[2].file_id }}",
            "additionalFields": {}
          },
          "id": "fa25f6bf-d05b-4b8d-8a8a-b8684c601510",
          "name": "Telegram: Get Image File",
          "type": "n8n-nodes-base.telegram",
          "position": [
            1584,
            304
          ],
          "webhookId": "06ceb31d-dcd9-4a9a-bbbe-a7bf7ae0ad4a",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "name": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
            "driveId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "folderId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "options": {}
          },
          "id": "7a362123-c86c-45f9-b80c-a5660f92da46",
          "name": "Google Drive: Upload Image",
          "type": "n8n-nodes-base.googleDrive",
          "position": [
            1600,
            496
          ],
          "typeVersion": 3,
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "wKDeQ9ILLpAqI9Yt",
              "name": "Google Drive account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "columns": {
              "value": {
                "STATUS": "EN COURS",
                "CAPTION": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}",
                "IMAGE URL": "={{ $json.webContentLink }}",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "a9614733-44e3-4580-95f8-a955d9136be4",
          "name": "Google Sheets: Log Image & Caption",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            1600,
            672
          ],
          "typeVersion": 4.7,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "gW1oRVy1Zs3kKuYY",
              "name": "Google Sheets account 2"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "af62651a-3fc8-419d-908b-6514f6f4bcb3",
                  "name": "YOUR_BOT_TOKEN",
                  "type": "string",
                  "value": ""
                }
              ]
            },
            "options": {}
          },
          "id": "a8e85901-2451-4037-ba0c-aa2b229c9d0f",
          "name": "Set: Bot Token (Placeholder)",
          "type": "n8n-nodes-base.set",
          "position": [
            1840,
            432
          ],
          "typeVersion": 3.4
        },
        {
          "parameters": {
            "url": "=https://api.telegram.org/bot{{ $json.YOUR_BOT_TOKEN }}/getFile?file_id={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[3].file_id }}",
            "options": {}
          },
          "id": "ae9da8d7-f2c4-4ada-897c-651176cbfdb6",
          "name": "Telegram API: Get File URL",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            2032,
            432
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "resource": "image",
            "operation": "analyze",
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "chatgpt-4o-latest",
              "cachedResultName": "CHATGPT-4O-LATEST"
            },
            "text": "=You are an image analysis assistant.\n\nYour task is to analyze the given image and output results **only in YAML format**. Do not add explanations, comments, or extra text outside YAML.\n\nRules:\n\n- If the image depicts a **product**, return:\n    \n    ```yaml\n    brand_name: (brand if visible or inferable)\n    color_scheme:\n      - hex: (hex code of each prominent color)\n        name: (descriptive name of the color)\n    font_style: (serif/sans-serif, bold/thin, etc.)\n    visual_description: (1–2 sentences summarizing what is seen, ignoring the background)\n    \n    ```\n    \n- If the image depicts a **character**, return:\n    \n    ```yaml\n    character_name: (name if visible or inferable, else \"unknown\")\n    color_scheme:\n      - hex: (hex code of each prominent color on the character)\n        name: (descriptive name of the color)\n    outfit_style: (clothing style, accessories, or notable features)\n    visual_description: (1–2 sentences summarizing what the character looks like, ignoring the background)\n    \n    ```\n    \n- If the image depicts **both**, return **both sections** in YAML.\n\nOnly output valid YAML. No explanations.",
            "imageUrls": "=https://api.telegram.org/file/bot{{ $('Set: Bot Token (Placeholder)').item.json.YOUR_BOT_TOKEN }}/{{ $json.result.file_path }}",
            "options": {}
          },
          "id": "6527e03e-6417-45a5-95a8-2ef84b872df0",
          "name": "OpenAI Vision: Analyze Reference Image",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            2448,
            432
          ],
          "typeVersion": 1.8,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "sheetName": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "columns": {
              "value": {
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[2].file_unique_id }}",
                "IMAGE DESCRIPTION": "={{ $json.content }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "6d78c44a-9073-4a2c-9a17-102c870b2162",
          "name": "Google Sheets: Update Image Description",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            2688,
            432
          ],
          "typeVersion": 4.7,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "jsonSchemaExample": "{\n\t\"image_prompt\": \"string\"\n}"
          },
          "id": "efd41bb8-ecef-49ea-9051-ead169d6766b",
          "name": "LLM: Structured Output Parser",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            3072,
            672
          ],
          "typeVersion": 1.3
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "id": "96a49fe4-d013-42c8-9ae8-11eb713e132f",
          "name": "LLM: OpenAI Chat",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            2864,
            672
          ],
          "typeVersion": 1.2,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Your task is to create an image prompt following the system guidelines.  \nEnsure that the reference image is represented as **accurately as possible**, including all text elements.  \n\nUse the following inputs:  \n\n- **User’s description:**  \n{{ $json.CAPTION }}\n\n- **Reference image description:**  \n{{ $json['IMAGE DESCRIPTION'] }}\n",
            "hasOutputParser": true,
            "options": {
              "systemMessage": "=ROLE: UGC Image Prompt Builder  \n\nGOAL:  \nGenerate one concise, natural, and realistic image prompt (≤120 words) from a given product or reference image. The prompt must simulate authentic UGC (user-generated content) photography.  \n\nRULES:  \n- Always output **one JSON object only** with the key:  \n  - `image_prompt`: (string with full description)  \n- Do **not** add commentary, metadata, or extra keys. JSON only.  \n\nSTYLE GUIDELINES:  \n- Tone: casual, unstaged, lifelike, handheld snapshot.  \n- Camera cues: include at least 2–3 (e.g., phone snapshot, handheld framing, off-center composition, natural indoor light, soft shadows, slight motion blur, auto exposure, unpolished look, mild grain).  \n- Realism: embrace imperfections (wrinkles, stray hairs, skin texture, clutter, smudges).  \n- Packaging/Text: preserve exactly as visible. Never invent claims, numbers, or badges.  \n- Diversity: if people appear but are unspecified, vary gender/ethnicity naturally; default age range = 21–38.  \n- Setting: default to real-world everyday spaces (home, street, store, gym, office).  \n\nSAFETY:  \n- No copyrighted character names.  \n- No dialogue or scripts. Only describe scenes.  \n\nOUTPUT CONTRACT:  \n- JSON only, no prose outside.  \n- Max 120 words in `image_prompt`.  \n- Must cover: subject, action, mood, setting, style/camera, colors, and text accuracy.  \n\nCHECKLIST BEFORE OUTPUT:  \n- Natural handheld tone?  \n- At least 2 camera cues included?  \n- Product text preserved exactly?  \n- Only JSON returned?  \n\n---  \n\n### Example  \n\nGood Example :  \n```json\n{ \"image_prompt\": \"a young adult casually holding a skincare tube near a bathroom mirror; action: dabs small amount on the back of the hand; mood: easy morning; setting: small apartment bathroom with towel on rack and toothbrush cup; style/camera: phone snapshot, handheld framing, off-center composition, natural window light, slight motion blur, mild grain; colors: soft whites and mint label; text accuracy: keep every word on the tube exactly as visible, no added claims\" }\n"
            }
          },
          "id": "f6599d80-4301-4dd1-bc38-1c39e57e21cb",
          "name": "Generate Image Prompt",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            2912,
            432
          ],
          "typeVersion": 2.2
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://queue.fal.run/fal-ai/nano-banana/edit",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n\t\"prompt\": \"{{ $json.output.image_prompt.replace(/\\\"/g, '\\\\\\\"').replace(/\\n/g, '\\\\n') }}\",\n\"image_urls\": [\"{{ $('Google Drive: Upload Image').item.json.webContentLink }}\"]\n\n}\n\n",
            "options": {}
          },
          "id": "80274aa5-bdf0-49bf-9980-0624d99d68ef",
          "name": "NanoBanana: Create Image",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            3248,
            432
          ],
          "typeVersion": 4.2,
          "credentials": {
            "httpHeaderAuth": {
              "id": "yaoMtbGaLsX3ya6R",
              "name": "Header Auth account"
            }
          }
        },
        {
          "parameters": {
            "amount": 20
          },
          "id": "e132487d-da8c-4850-9d3f-9e057e9bde64",
          "name": "Wait for Image Edit",
          "type": "n8n-nodes-base.wait",
          "position": [
            3456,
            432
          ],
          "webhookId": "df52d997-45c4-431f-bdf6-89dd25027b5b",
          "typeVersion": 1.1
        },
        {
          "parameters": {
            "url": "={{ $json.response_url }}",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "options": {}
          },
          "id": "2c7ffce1-8ace-418d-9738-c659f4554980",
          "name": "Download Edited Image",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            3456,
            656
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "authentication": "serviceAccount",
            "documentId": {
              "__rl": true,
              "value": "=https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "mode": "list",
              "value": ""
            }
          },
          "id": "ec725aa0-fd30-4d98-b984-0228873db428",
          "name": "Google Sheets: Read Video Parameters (CONFIG)",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            1392,
            992
          ],
          "typeVersion": 4.6,
          "credentials": {
            "googleApi": {
              "id": "SOyhZ88a9rBcjUyN",
              "name": "veo3 and service account google"
            }
          }
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.chat.id }}",
            "text": "Published",
            "additionalFields": {}
          },
          "id": "abafa8c6-55a0-488c-970e-d2a969ad7959",
          "name": "Telegram: Send notification",
          "type": "n8n-nodes-base.telegram",
          "position": [
            3472,
            1520
          ],
          "webhookId": "2f4a4bc1-99de-4e93-8523-dd8c6499b893",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "content": "# 🎬 Generate AI viral videos with NanoBanana & VEO3, shared on socials via Blotato (By Dr. Firas)\n\n\n# 🎥 Full Tutorial :\n[![AI Voice Agent Preview](https://www.dr-firas.com/nanobanana.png)](https://youtu.be/nlwpbXQqNQ4)\n\n---\n\n# 📘 Documentation  \nAccess detailed setup instructions, API config, platform connection guides, and workflow customization tips:\n\n📎 [Open the full documentation on Notion](https://automatisation.notion.site/NonoBanan-2643d6550fd98041aef5dcbe8ab0f7a1?source=copy_link)\n\n---\n\n# ⚙️ Requirements\n\n1. ✅ **Create a [Blotato](https://blotato.com/?ref=firas) account** (Pro plan required for API access)  \n2. 🔑 **Generate your Blotato API Key** via: `Settings > API > Generate API Key`  \n3. 📦 **Enable “Verified Community Nodes”** in the n8n admin settings  \n4. 🧩 **Install the Blotato** verified community node in n8n  \n5. 🛠 **Create a Blotato API credential** inside your n8n credentials tab  \n6. 📄 **Duplicate this [Google Sheet template](https://docs.google.com/spreadsheets/d/1FutmZHblwnk36fp59fnePjONzuJBdndqZOCuRoGWSmY/edit?usp=sharing)**  \n7. ☁️ **Make sure your Google Drive folder is PUBLIC** (anyone with the link can access)  \n8. 📌 **Complete the 3 brown sticky note steps** inside the workflow editor\n\n",
            "height": 1476,
            "width": 700,
            "color": 6
          },
          "id": "77030cb3-3246-41d5-bcbc-74f82bdd501b",
          "name": "Sticky Note5",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            352,
            192
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 5 — Auto-Post to All Platforms\n\n",
            "height": 832,
            "width": 1344,
            "color": 4
          },
          "id": "69b0afaa-0762-4368-b512-4641cf7da613",
          "name": "Sticky Note6",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            4880,
            1424
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "22db68d6-c538-45d2-8244-1e341ae4538d",
          "name": "Upload Video to BLOTATO1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            4944,
            2048
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "74332b0a-9a8a-471b-823c-bf983c48a141",
          "name": "Youtube1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5568,
            1840
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "9a1a6aed-cc94-4909-a525-a0f900a2c87d",
          "name": "Tiktok1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5200,
            1664
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "mode": "chooseBranch",
            "numberInputs": 9
          },
          "id": "f5794df9-ee9a-47eb-bcf7-c6939fcbdd72",
          "name": "Merge1",
          "type": "n8n-nodes-base.merge",
          "position": [
            5856,
            1744
          ],
          "typeVersion": 3.2
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "DESCRIPTION",
              "mode": "name"
            },
            "columns": {
              "value": {
                "STATUS": "Published",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "c89a6a84-b433-41f9-a07f-45c37ddc5a05",
          "name": "Update Status to \"DONE\"1",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            6032,
            1856
          ],
          "typeVersion": 4.5,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "983ea5fb-e0e4-4aeb-b83f-4a6da2e8332a",
          "name": "Linkedin1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5392,
            1664
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "08cac42e-1c81-4697-a1fb-f4b39753a1de",
          "name": "Facebook1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5568,
            1664
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "5b6036ad-cc6f-4210-be30-be8356f0c550",
          "name": "Instagram1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5200,
            1840
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "099070c0-4a5d-4601-bbbb-2a91f5bf3d77",
          "name": "Threads1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5200,
            2048
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "b46b837f-fbc9-4c85-9a33-c2c02b0dbbf1",
          "name": "Bluesky1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5392,
            2048
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "04de5baa-84ef-4442-9255-051e1f04ebd7",
          "name": "Pinterest1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5568,
            2048
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "resource": "post",
            "operation": "create"
          },
          "id": "de99e983-2998-40ba-9ba0-1aa7b7b8e71e",
          "name": "Twitter (X)1",
          "type": "@blotato/n8n-nodes-preview-blotato.blotato",
          "position": [
            5392,
            1840
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "id": "e4a10eaa-20d7-47b2-92bd-6b1a4155fce8",
          "name": "OpenAI Chat Model1",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            4400,
            1760
          ],
          "typeVersion": 1.2,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {},
          "id": "942d05de-1940-4d82-a248-7e3014654e58",
          "name": "Think1",
          "type": "@n8n/n8n-nodes-langchain.toolThink",
          "position": [
            4544,
            1760
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "jsonSchemaExample": "{\n  \"title\": \"string\",\n  \"final_prompt\": \"string\"\n}\n"
          },
          "id": "c15f6603-2617-4808-a6e0-5df202dbe22c",
          "name": "Structured Output Parser1",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            4688,
            1760
          ],
          "typeVersion": 1.3
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.chat.id }}",
            "text": "=Url VIDEO : {{ $('Download Video from VEO').item.json.data.response.resultUrls[0] }}",
            "additionalFields": {}
          },
          "id": "b3912bd0-a676-48bc-865c-e77837b37cb8",
          "name": "Send Video URL via Telegram1",
          "type": "n8n-nodes-base.telegram",
          "position": [
            4928,
            1552
          ],
          "webhookId": "ea6e5974-1930-4b67-a51b-16249a9ed8bd",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $json.result.chat.id }}",
            "file": "={{ $('Save Caption Video to Google Sheets1').item.json['URL VIDEO FINAL'] }}",
            "additionalFields": {}
          },
          "id": "61a24744-6426-4627-beef-6426cf4471cc",
          "name": "Send Final Video Preview1",
          "type": "n8n-nodes-base.telegram",
          "position": [
            4944,
            1792
          ],
          "webhookId": "443fd41d-a051-45bf-ad68-173197dba26b",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "updates": [
              "message"
            ],
            "additionalFields": {}
          },
          "id": "cd4126de-a078-4195-8746-f06e3e790ae2",
          "name": "Telegram Trigger: Receive Video Idea1",
          "type": "n8n-nodes-base.telegramTrigger",
          "position": [
            3712,
            976
          ],
          "webhookId": "26dbe6f5-5197-4b2b-9e32-8060f2119686",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "cc2e0500-57b1-4615-82cb-1c950e5f2ec4",
                  "name": "json_master",
                  "type": "string",
                  "value": "={\n  \"description\": \"Brief narrative description of the scene, focusing on key visual storytelling and product transformation.\",\n  \"style\": \"cinematic | photorealistic | stylized | gritty | elegant\",\n  \"camera\": {\n    \"type\": \"fixed | dolly | Steadicam | crane combo\",\n    \"movement\": \"describe any camera moves like slow push-in, pan, orbit\",\n    \"lens\": \"optional lens type or focal length for cinematic effect\"\n  },\n  \"lighting\": {\n    \"type\": \"natural | dramatic | high-contrast\",\n    \"sources\": \"key lighting sources (sunset, halogen, ambient glow...)\",\n    \"FX\": \"optional VFX elements like fog, reflections, flares\"\n  },\n  \"environment\": {\n    \"location\": \"describe location or room (kitchen, desert, basketball court...)\",\n    \"set_pieces\": [\n      \"list of key background or prop elements\",\n      \"e.g. hardwood floors, chain-link fence, velvet surface\"\n    ],\n    \"mood\": \"describe the ambient atmosphere (moody, clean, epic...)\"\n  },\n  \"elements\": [\n    \"main physical items involved (product box, accessories, vehicles...)\",\n    \"include brand visibility (logos, packaging, texture...)\"\n  ],\n  \"subject\": {\n    \"character\": {\n      \"description\": \"optional – physical description, outfit\",\n      \"pose\": \"optional – position or gesture\",\n      \"lip_sync_line\": \"optional – spoken line if there’s a voiceover\"\n    },\n    \"product\": {\n      \"brand\": \"Brand name\",\n      \"model\": \"Product model or name\",\n      \"action\": \"description of product transformation or assembly\"\n    }\n  },\n  \"motion\": {\n    \"type\": \"e.g. transformation, explosion, vortex\",\n    \"details\": \"step-by-step visual flow of how elements move or evolve\"\n  },\n  \"VFX\": {\n    \"transformation\": \"optional – describe style (neon trails, motion blur...)\",\n    \"impact\": \"optional – e.g. shockwave, glow, distortion\",\n    \"particles\": \"optional – embers, sparks, thread strands...\",\n    \"environment\": \"optional – VFX affecting the scene (ripples, wind...)\"\n  },\n  \"audio\": {\n    \"music\": \"optional – cinematic score, trap beat, ambient tone\",\n    \"sfx\": [\n      \"list of sound effects (zip, pop, woosh...)\"\n    ],\n    \"ambience\": \"optional – background soundscape (traffic, wind...)\",\n    \"voiceover\": {\n      \"delivery\": \"tone and style (confident, whisper, deep...)\",\n      \"line\": \"text spoken if applicable\"\n    }\n  },\n  \"ending\": \"Final shot description – what is seen or felt at the end (freeze frame, logo pulse, glow...)\",\n  \"text\": \"none | overlay | tagline | logo pulse at end only\",\n  \"format\": \"16:9 | 4k | vertical\",\n  \"keywords\": [\n    \"brand\",\n    \"scene style\",\n    \"motion type\",\n    \"camera style\",\n    \"sound mood\",\n    \"target theme\"\n  ]\n}\n"
                }
              ]
            },
            "options": {}
          },
          "id": "a602b676-bee7-46cb-8a1d-2fe14f81a5cd",
          "name": "Set Master Prompt1",
          "type": "n8n-nodes-base.set",
          "position": [
            4160,
            1536
          ],
          "typeVersion": 3.4
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Create a UGC-style video prompt using both the reference image and the user description.  \n\n**Inputs**  \n- User description (optional):  \n  `{{ $('Telegram Trigger: Receive Video Idea1').item.json.message.caption }}`  \n- Reference image analysis (stay strictly faithful to what’s visible):  \n  `{{ $('Google Sheets: Update Image Description1').item.json['IMAGE DESCRIPTION'] }}`  \n\n**Rules**  \n- Keep the style casual, authentic, and realistic. Avoid studio-like or cinematic language.  \n- Default model: `veo3_fast` (unless otherwise specified).  \n- Output only **one JSON object** with the key: `video_prompt`.  \n",
            "hasOutputParser": true,
            "options": {
              "systemMessage": "=system_prompt:\n  ## SYSTEM PROMPT: Structured Video Ad Prompt Generator\n  A - Ask:\n    Generate a structured video ad prompt for cinematic generation, strictly based on the master schema provided in: {{ $json.json_master }}.\n    The final result must be a JSON object with exactly two top-level keys: `title` and `final_prompt`.\n\n  G - Guidance:\n    role: Creative Director\n    output_count: 1\n    character_limit: None\n    constraints:\n      - The output must be valid JSON.\n      - The `title` field should contain a short, descriptive and unique title (max 15 words).\n      - The `final_prompt` field must contain a **single-line JSON string** that follows the exact structure of {{ $json.json_master }} with all fields preserved.\n      - Do not include any explanations, markdown, or extra text — only the JSON object.\n      - Escape all inner quotes in the `final_prompt` string so it is valid as a stringified JSON inside another JSON.\n    tool_usage:\n      - Ensure consistent alignment across all fields (camera, lighting, motion, etc.).\n      - Maintain full structure even for optional fields (use \"none\", \"\", or [] as needed).\n\n  N - Notation:\n    format: JSON\n    expected_output:\n      {\n        \"title\": \"A unique short title for the scene\",\n        \"final_prompt\": \"{...stringified JSON of the full prompt...}\"\n      }\n\n"
            }
          },
          "id": "ecc7b020-6f13-482d-b1ec-911ac62e9b14",
          "name": "AI Agent: Generate Video Script1",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            4480,
            1536
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/veo/generate",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "contentType": "raw",
            "rawContentType": "application/json",
            "body": "={\n  \"prompt\": {{ $json.prompt }},\n  \"model\": \"{{ $('Google Sheets: Read Video Parameters (CONFIG)1').item.json.model }}\",\n  \"aspectRatio\": \"{{ $json.aspectRatio }}\",\n  \"imageUrls\": [\n    \"{{ $('Download Edited Image1').item.json.images[0].url }}\"\n  ]\n}",
            "options": {}
          },
          "id": "0105631c-16f8-42b4-b90a-9092a8b46008",
          "name": "Generate Video with VEO",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            3760,
            2048
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "amount": 20
          },
          "id": "5ee4eb81-5079-48f3-ad38-8cb04176b0b5",
          "name": "Wait for VEO3 Rendering1",
          "type": "n8n-nodes-base.wait",
          "position": [
            3968,
            2048
          ],
          "webhookId": "f6d814f3-4eb8-4629-a920-134cfa4ea03b",
          "typeVersion": 1.1
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/veo/record-info",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('Generate Video with VEO').item.json.data.taskId }}"
                }
              ]
            },
            "options": {}
          },
          "id": "87911dce-be87-40b8-8d82-d5bf9b4933fe",
          "name": "Download Video from VEO",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            4176,
            2048
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4o",
              "cachedResultName": "GPT-4O"
            },
            "messages": {
              "values": [
                {
                  "content": "=You are rewriting a TikTok video script, caption, and overlay —\nnot inventing a new one. You must follow this format and obey\nthese rules strictly.\n---\n### CONTEXT:\nHere is the content idea to use:{{ $('Telegram Trigger: Receive Video Idea1').item.json.message.caption }}\n\nand the Title is : {{ $('AI Agent: Generate Video Script1').item.json.output.title }}\n\n\nWrite the caption text using the topic.\n\n---\n- MUST be under 200 characters (yes \"Characters\" not wordcount)\nthis is an absolute MUST, no more than 200 characters!!! \n\n### FINAL OUTPUT FORMAT (no markdown formatting):\n\nDO NOT return any explanations. Only return the Caption Text\n"
                }
              ]
            },
            "options": {}
          },
          "id": "9ab98ab4-29ea-47dd-9682-20ea0fa7818f",
          "name": "Rewrite Caption with GPT-4o1",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            4336,
            2048
          ],
          "typeVersion": 1.8,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "DESCRIPTION",
              "mode": "name"
            },
            "columns": {
              "value": {
                "STATUS": "CREATE",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[2].file_unique_id }}",
                "TITRE VIDEO": "={{ $('AI Agent: Generate Video Script1').item.json.output.title }}",
                "CAPTION VIDEO": "={{ $json.message.content }}",
                "URL VIDEO FINAL": "={{ $('Download Video from VEO').item.json.data.response.resultUrls[0] }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "URL VIDEO FINAL",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "URL VIDEO FINAL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "TITRE VIDEO",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "TITRE VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION VIDEO",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION VIDEO",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "20a7a13b-ac2a-4bef-96ee-2ee9ba26d01a",
          "name": "Save Caption Video to Google Sheets1",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            4640,
            2048
          ],
          "typeVersion": 4.6,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const structuredPrompt = $input.first().json.output.final_prompt;\nreturn {\n  json: {\n    prompt: JSON.stringify(structuredPrompt), // this escapes it correctly!\n    model: \"veo3_fast\",\n    aspectRatio: \"16:9\"\n  }\n};\n"
          },
          "id": "1f40fa18-fd54-4422-9315-97a304fd49ba",
          "name": "Format Prompt1",
          "type": "n8n-nodes-base.code",
          "position": [
            3760,
            1744
          ],
          "typeVersion": 2
        },
        {
          "parameters": {
            "content": "# 📑 STEP 3 — Generate Video Ad Script",
            "height": 460,
            "width": 1180
          },
          "id": "df4936b8-3f0b-47d5-8412-79f9bcf4a2c2",
          "name": "Sticky Note7",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3648,
            1424
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 4 — Generate Video with VEO3",
            "height": 320,
            "width": 1180
          },
          "id": "d9f5e46d-0889-4767-9c7e-edaf856c3171",
          "name": "Sticky Note8",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3648,
            1936
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 1 — Collect Idea & Image",
            "height": 592,
            "width": 1184
          },
          "id": "8f554d06-0492-419d-af83-a5a2997c8852",
          "name": "Sticky Note9",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            3648,
            784
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "content": "# 📑 STEP 2 — Create Image with NanoBanana\n",
            "height": 592,
            "width": 1328
          },
          "id": "ec907c91-58b1-4e21-a4dc-0d4dbd95a423",
          "name": "Sticky Note10",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            4880,
            784
          ],
          "typeVersion": 1
        },
        {
          "parameters": {
            "resource": "file",
            "fileId": "={{ $json.message.photo[2].file_id }}",
            "additionalFields": {}
          },
          "id": "645e8e4a-d4b8-433d-8b4c-dd0d5cf37d77",
          "name": "Telegram: Get Image File1",
          "type": "n8n-nodes-base.telegram",
          "position": [
            4144,
            848
          ],
          "webhookId": "06ceb31d-dcd9-4a9a-bbbe-a7bf7ae0ad4a",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "name": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[2].file_unique_id }}",
            "driveId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "folderId": {
              "__rl": true,
              "mode": "id",
              "value": "="
            },
            "options": {}
          },
          "id": "a64a6044-e64a-49d5-abbc-5ab5ed24aebc",
          "name": "Google Drive: Upload Image1",
          "type": "n8n-nodes-base.googleDrive",
          "position": [
            4160,
            1040
          ],
          "typeVersion": 3,
          "credentials": {
            "googleDriveOAuth2Api": {
              "id": "wKDeQ9ILLpAqI9Yt",
              "name": "Google Drive account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "DESCRIPTION",
              "mode": "name"
            },
            "columns": {
              "value": {
                "STATUS": "EN COURS",
                "CAPTION": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.caption }}",
                "IMAGE URL": "={{ $json.webContentLink }}",
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[2].file_unique_id }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "af2bd03d-325c-4277-8a5b-a9fea08c0746",
          "name": "Google Sheets: Log Image & Caption1",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            4160,
            1216
          ],
          "typeVersion": 4.7,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "af62651a-3fc8-419d-908b-6514f6f4bcb3",
                  "name": "YOUR_BOT_TOKEN",
                  "type": "string",
                  "value": ""
                }
              ]
            },
            "options": {}
          },
          "id": "90895ad4-a1d9-469d-be39-2c285d4b6940",
          "name": "Set: Bot Token (Placeholder)1",
          "type": "n8n-nodes-base.set",
          "position": [
            4400,
            976
          ],
          "typeVersion": 3.4
        },
        {
          "parameters": {
            "url": "=https://api.telegram.org/bot{{ $json.YOUR_BOT_TOKEN }}/getFile?file_id={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[3].file_id }}",
            "options": {}
          },
          "id": "644d1a2a-dd4e-46fd-b304-d43c72926a28",
          "name": "Telegram API: Get File URL1",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            4592,
            976
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "resource": "image",
            "operation": "analyze",
            "modelId": {
              "__rl": true,
              "mode": "list",
              "value": "chatgpt-4o-latest",
              "cachedResultName": "CHATGPT-4O-LATEST"
            },
            "text": "=You are an image analysis assistant.\n\nYour task is to analyze the given image and output results **only in YAML format**. Do not add explanations, comments, or extra text outside YAML.\n\nRules:\n\n- If the image depicts a **product**, return:\n    \n    ```yaml\n    brand_name: (brand if visible or inferable)\n    color_scheme:\n      - hex: (hex code of each prominent color)\n        name: (descriptive name of the color)\n    font_style: (serif/sans-serif, bold/thin, etc.)\n    visual_description: (1–2 sentences summarizing what is seen, ignoring the background)\n    \n    ```\n    \n- If the image depicts a **character**, return:\n    \n    ```yaml\n    character_name: (name if visible or inferable, else \"unknown\")\n    color_scheme:\n      - hex: (hex code of each prominent color on the character)\n        name: (descriptive name of the color)\n    outfit_style: (clothing style, accessories, or notable features)\n    visual_description: (1–2 sentences summarizing what the character looks like, ignoring the background)\n    \n    ```\n    \n- If the image depicts **both**, return **both sections** in YAML.\n\nOnly output valid YAML. No explanations.",
            "imageUrls": "=https://api.telegram.org/file/bot{{ $('Set: Bot Token (Placeholder)1').item.json.YOUR_BOT_TOKEN }}/{{ $json.result.file_path }}",
            "options": {}
          },
          "id": "8a73e914-b85e-429b-af94-10d283e7682b",
          "name": "OpenAI Vision: Analyze Reference Image1",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "position": [
            5008,
            976
          ],
          "typeVersion": 1.8,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "operation": "appendOrUpdate",
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "DESCRIPTION",
              "mode": "name"
            },
            "columns": {
              "value": {
                "IMAGE NAME": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.photo[2].file_unique_id }}",
                "IMAGE DESCRIPTION": "={{ $json.content }}"
              },
              "schema": [
                {
                  "id": "IMAGE NAME",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE NAME",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE URL",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "IMAGE URL",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "IMAGE DESCRIPTION",
                  "type": "string",
                  "display": true,
                  "removed": false,
                  "required": false,
                  "displayName": "IMAGE DESCRIPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "CAPTION",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "CAPTION",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                },
                {
                  "id": "STATUS",
                  "type": "string",
                  "display": true,
                  "removed": true,
                  "required": false,
                  "displayName": "STATUS",
                  "defaultMatch": false,
                  "canBeUsedToMatch": true
                }
              ],
              "mappingMode": "defineBelow",
              "matchingColumns": [
                "IMAGE NAME"
              ],
              "attemptToConvertTypes": false,
              "convertFieldsToString": false
            },
            "options": {}
          },
          "id": "491e83c4-7b09-4255-b950-4c4bcd71898d",
          "name": "Google Sheets: Update Image Description1",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            5248,
            976
          ],
          "typeVersion": 4.7,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "jsonSchemaExample": "{\n\t\"image_prompt\": \"string\"\n}"
          },
          "id": "45b45b1a-02cd-4767-aa36-c465e81963ef",
          "name": "LLM: Structured Output Parser1",
          "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
          "position": [
            5632,
            1216
          ],
          "typeVersion": 1.3
        },
        {
          "parameters": {
            "model": {
              "__rl": true,
              "mode": "list",
              "value": "gpt-4.1-mini"
            },
            "options": {}
          },
          "id": "3ee65ff1-4c3f-4403-9cf0-722c6c9657cf",
          "name": "LLM: OpenAI Chat1",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "position": [
            5424,
            1216
          ],
          "typeVersion": 1.2,
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          }
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Your task is to create an image prompt following the system guidelines.  \nEnsure that the reference image is represented as **accurately as possible**, including all text elements.  \n\nUse the following inputs:  \n\n- **User’s description:**  \n{{ $json.CAPTION }}\n\n- **Reference image description:**  \n{{ $json['IMAGE DESCRIPTION'] }}\n",
            "hasOutputParser": true,
            "options": {
              "systemMessage": "=ROLE: UGC Image Prompt Builder  \n\nGOAL:  \nGenerate one concise, natural, and realistic image prompt (≤120 words) from a given product or reference image. The prompt must simulate authentic UGC (user-generated content) photography.  \n\nRULES:  \n- Always output **one JSON object only** with the key:  \n  - `image_prompt`: (string with full description)  \n- Do **not** add commentary, metadata, or extra keys. JSON only.  \n\nSTYLE GUIDELINES:  \n- Tone: casual, unstaged, lifelike, handheld snapshot.  \n- Camera cues: include at least 2–3 (e.g., phone snapshot, handheld framing, off-center composition, natural indoor light, soft shadows, slight motion blur, auto exposure, unpolished look, mild grain).  \n- Realism: embrace imperfections (wrinkles, stray hairs, skin texture, clutter, smudges).  \n- Packaging/Text: preserve exactly as visible. Never invent claims, numbers, or badges.  \n- Diversity: if people appear but are unspecified, vary gender/ethnicity naturally; default age range = 21–38.  \n- Setting: default to real-world everyday spaces (home, street, store, gym, office).  \n\nSAFETY:  \n- No copyrighted character names.  \n- No dialogue or scripts. Only describe scenes.  \n\nOUTPUT CONTRACT:  \n- JSON only, no prose outside.  \n- Max 120 words in `image_prompt`.  \n- Must cover: subject, action, mood, setting, style/camera, colors, and text accuracy.  \n\nCHECKLIST BEFORE OUTPUT:  \n- Natural handheld tone?  \n- At least 2 camera cues included?  \n- Product text preserved exactly?  \n- Only JSON returned?  \n\n---  \n\n### Example  \n\nGood Example :  \n```json\n{ \"image_prompt\": \"a young adult casually holding a skincare tube near a bathroom mirror; action: dabs small amount on the back of the hand; mood: easy morning; setting: small apartment bathroom with towel on rack and toothbrush cup; style/camera: phone snapshot, handheld framing, off-center composition, natural window light, slight motion blur, mild grain; colors: soft whites and mint label; text accuracy: keep every word on the tube exactly as visible, no added claims\" }\n"
            }
          },
          "id": "33989e1d-e649-4c5f-a5aa-b73aabc179ac",
          "name": "Generate Image Prompt1",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "position": [
            5472,
            976
          ],
          "typeVersion": 2.2
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://queue.fal.run/fal-ai/nano-banana/edit",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n\t\"prompt\": \"{{ $json.output.image_prompt.replace(/\\\"/g, '\\\\\\\"').replace(/\\n/g, '\\\\n') }}\",\n\"image_urls\": [\"{{ $('Google Drive: Upload Image1').item.json.webContentLink }}\"]\n\n}\n\n",
            "options": {}
          },
          "id": "aea6a6f4-998f-48ab-8aca-25d61c4a954a",
          "name": "NanoBanana: Create Image1",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            5808,
            976
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "amount": 20
          },
          "id": "26b11889-0ec3-4702-9306-4dd8161c33b0",
          "name": "Wait for Image Edit1",
          "type": "n8n-nodes-base.wait",
          "position": [
            6016,
            976
          ],
          "webhookId": "df52d997-45c4-431f-bdf6-89dd25027b5b",
          "typeVersion": 1.1
        },
        {
          "parameters": {
            "url": "={{ $json.response_url }}",
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "options": {}
          },
          "id": "05c79ff8-53a9-445c-97fa-882333b68b54",
          "name": "Download Edited Image1",
          "type": "n8n-nodes-base.httpRequest",
          "position": [
            6016,
            1200
          ],
          "typeVersion": 4.2
        },
        {
          "parameters": {
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1w2UMKmKeX37QLMKtNWTB8SHHd9s3zRaT9p-SsovK8kw/edit",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "CONFIG",
              "mode": "name"
            },
            "options": {}
          },
          "id": "82858672-5dba-45da-8366-d5402abd0682",
          "name": "Google Sheets: Read Video Parameters (CONFIG)1",
          "type": "n8n-nodes-base.googleSheets",
          "position": [
            3952,
            1536
          ],
          "typeVersion": 4.6,
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "fdPcZLgQHTwnOebB",
              "name": "Google Sheets account"
            }
          }
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger: Receive Video Idea1').item.json.message.chat.id }}",
            "text": "Published",
            "additionalFields": {}
          },
          "id": "3fdcc0d6-e946-40ee-8e47-688e002c2157",
          "name": "Telegram: Send notification1",
          "type": "n8n-nodes-base.telegram",
          "position": [
            6032,
            2064
          ],
          "webhookId": "2f4a4bc1-99de-4e93-8523-dd8c6499b893",
          "typeVersion": 1.2,
          "credentials": {
            "telegramApi": {
              "id": "Gnv8G0yvtGxjiZXY",
              "name": "Telegram account"
            }
          }
        },
        {
          "parameters": {
            "content": "# 🎬 Generate AI viral videos with NanoBanana & VEO3, shared on socials via Blotato (By Dr. Firas)\n\n\n# 🎥 Full Tutorial :\n[![AI Voice Agent Preview](https://www.dr-firas.com/nanobanana.png)](https://youtu.be/nlwpbXQqNQ4)\n\n---\n\n# 📘 Documentation  \nAccess detailed setup instructions, API config, platform connection guides, and workflow customization tips:\n\n📎 [Open the full documentation on Notion](https://automatisation.notion.site/NonoBanan-2643d6550fd98041aef5dcbe8ab0f7a1?source=copy_link)\n\n---\n\n# ⚙️ Requirements\n\n1. ✅ **Create a [Blotato](https://blotato.com/?ref=firas) account** (Pro plan required for API access)  \n2. 🔑 **Generate your Blotato API Key** via: `Settings > API > Generate API Key`  \n3. 📦 **Enable “Verified Community Nodes”** in the n8n admin settings  \n4. 🧩 **Install the Blotato** verified community node in n8n  \n5. 🛠 **Create a Blotato API credential** inside your n8n credentials tab  \n6. 📄 **Duplicate this [Google Sheet template](https://docs.google.com/spreadsheets/d/1FutmZHblwnk36fp59fnePjONzuJBdndqZOCuRoGWSmY/edit?usp=sharing)**  \n7. ☁️ **Make sure your Google Drive folder is PUBLIC** (anyone with the link can access)  \n8. 📌 **Complete the 3 brown sticky note steps** inside the workflow editor\n\n",
            "height": 1476,
            "width": 700,
            "color": 6
          },
          "id": "6c729723-23a5-4e88-b8d2-1c5f7bf2e071",
          "name": "Sticky Note11",
          "type": "n8n-nodes-base.stickyNote",
          "position": [
            2928,
            784
          ],
          "typeVersion": 1
        }
      ],
      "connections": {
        "Merge": {
          "main": [
            [
              {
                "node": "Update Status to \"DONE\"",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Think": {
          "ai_tool": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Tiktok": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Bluesky": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 7
              }
            ]
          ]
        },
        "Threads": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 6
              }
            ]
          ]
        },
        "Youtube": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 5
              }
            ]
          ]
        },
        "Facebook": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 2
              }
            ]
          ]
        },
        "Linkedin": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Instagram": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 3
              }
            ]
          ]
        },
        "Pinterest": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 8
              }
            ]
          ]
        },
        "Twitter (X)": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 4
              }
            ]
          ]
        },
        "Format Prompt": {
          "main": [
            [
              {
                "node": "Generate Video with VEO3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LLM: OpenAI Chat": {
          "ai_languageModel": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Set Master Prompt": {
          "main": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for Image Edit": {
          "main": [
            [
              {
                "node": "Download Edited Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Edited Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Read Video Parameters (CONFIG)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Image Prompt": {
          "main": [
            [
              {
                "node": "NanoBanana: Create Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Update Status to \"DONE\"": {
          "main": [
            [
              {
                "node": "Telegram: Send notification",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upload Video to BLOTATO": {
          "main": [
            [
              {
                "node": "Tiktok",
                "type": "main",
                "index": 0
              },
              {
                "node": "Linkedin",
                "type": "main",
                "index": 0
              },
              {
                "node": "Facebook",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram",
                "type": "main",
                "index": 0
              },
              {
                "node": "Twitter (X)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Youtube",
                "type": "main",
                "index": 0
              },
              {
                "node": "Threads",
                "type": "main",
                "index": 0
              },
              {
                "node": "Bluesky",
                "type": "main",
                "index": 0
              },
              {
                "node": "Pinterest",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for VEO3 Rendering": {
          "main": [
            [
              {
                "node": "Download Video from VEO3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Video from VEO3": {
          "main": [
            [
              {
                "node": "Rewrite Caption with GPT-4o",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Video with VEO3": {
          "main": [
            [
              {
                "node": "Wait for VEO3 Rendering",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "NanoBanana: Create Image": {
          "main": [
            [
              {
                "node": "Wait for Image Edit",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Final Video Preview": {
          "main": [
            [
              {
                "node": "Upload Video to BLOTATO",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Structured Output Parser": {
          "ai_outputParser": [
            [
              {
                "node": "AI Agent: Generate Video Script",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "Telegram: Get Image File": {
          "main": [
            [
              {
                "node": "Google Drive: Upload Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Drive: Upload Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Log Image & Caption",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram API: Get File URL": {
          "main": [
            [
              {
                "node": "OpenAI Vision: Analyze Reference Image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Rewrite Caption with GPT-4o": {
          "main": [
            [
              {
                "node": "Save Caption Video to Google Sheets",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Video URL via Telegram": {
          "main": [
            [
              {
                "node": "Send Final Video Preview",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set: Bot Token (Placeholder)": {
          "main": [
            [
              {
                "node": "Telegram API: Get File URL",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LLM: Structured Output Parser": {
          "ai_outputParser": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent: Generate Video Script": {
          "main": [
            [
              {
                "node": "Format Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Log Image & Caption": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Caption Video to Google Sheets": {
          "main": [
            [
              {
                "node": "Send Video URL via Telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram Trigger: Receive Video Idea": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)",
                "type": "main",
                "index": 0
              },
              {
                "node": "Telegram: Get Image File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Vision: Analyze Reference Image": {
          "main": [
            [
              {
                "node": "Google Sheets: Update Image Description",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Update Image Description": {
          "main": [
            [
              {
                "node": "Generate Image Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Read Video Parameters (CONFIG)": {
          "main": [
            [
              {
                "node": "Set Master Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Upload Video to BLOTATO1": {
          "main": [
            [
              {
                "node": "Tiktok1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Linkedin1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Facebook1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Instagram1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Twitter (X)1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Youtube1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Threads1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Bluesky1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Pinterest1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Youtube1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 5
              }
            ]
          ]
        },
        "Tiktok1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge1": {
          "main": [
            [
              {
                "node": "Update Status to \"DONE\"1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Update Status to \"DONE\"1": {
          "main": [
            [
              {
                "node": "Telegram: Send notification1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Linkedin1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "Facebook1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 2
              }
            ]
          ]
        },
        "Instagram1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 3
              }
            ]
          ]
        },
        "Threads1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 6
              }
            ]
          ]
        },
        "Bluesky1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 7
              }
            ]
          ]
        },
        "Pinterest1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 8
              }
            ]
          ]
        },
        "Twitter (X)1": {
          "main": [
            [
              {
                "node": "Merge1",
                "type": "main",
                "index": 4
              }
            ]
          ]
        },
        "OpenAI Chat Model1": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent: Generate Video Script1",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Think1": {
          "ai_tool": [
            [
              {
                "node": "AI Agent: Generate Video Script1",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Structured Output Parser1": {
          "ai_outputParser": [
            [
              {
                "node": "AI Agent: Generate Video Script1",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "Send Video URL via Telegram1": {
          "main": [
            [
              {
                "node": "Send Final Video Preview1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Send Final Video Preview1": {
          "main": [
            [
              {
                "node": "Upload Video to BLOTATO1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram Trigger: Receive Video Idea1": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)1",
                "type": "main",
                "index": 0
              },
              {
                "node": "Telegram: Get Image File1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set Master Prompt1": {
          "main": [
            [
              {
                "node": "AI Agent: Generate Video Script1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent: Generate Video Script1": {
          "main": [
            [
              {
                "node": "Format Prompt1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Generate Video with VEO": {
          "main": [
            [
              {
                "node": "Wait for VEO3 Rendering1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for VEO3 Rendering1": {
          "main": [
            [
              {
                "node": "Download Video from VEO",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Video from VEO": {
          "main": [
            [
              {
                "node": "Rewrite Caption with GPT-4o1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Rewrite Caption with GPT-4o1": {
          "main": [
            [
              {
                "node": "Save Caption Video to Google Sheets1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Save Caption Video to Google Sheets1": {
          "main": [
            [
              {
                "node": "Send Video URL via Telegram1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Prompt1": {
          "main": [
            [
              {
                "node": "Generate Video with VEO",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram: Get Image File1": {
          "main": [
            [
              {
                "node": "Google Drive: Upload Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Drive: Upload Image1": {
          "main": [
            [
              {
                "node": "Google Sheets: Log Image & Caption1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Log Image & Caption1": {
          "main": [
            [
              {
                "node": "Set: Bot Token (Placeholder)1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Set: Bot Token (Placeholder)1": {
          "main": [
            [
              {
                "node": "Telegram API: Get File URL1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram API: Get File URL1": {
          "main": [
            [
              {
                "node": "OpenAI Vision: Analyze Reference Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Vision: Analyze Reference Image1": {
          "main": [
            [
              {
                "node": "Google Sheets: Update Image Description1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Update Image Description1": {
          "main": [
            [
              {
                "node": "Generate Image Prompt1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "LLM: Structured Output Parser1": {
          "ai_outputParser": [
            [
              {
                "node": "Generate Image Prompt1",
                "type": "ai_outputParser",
                "index": 0
              }
            ]
          ]
        },
        "LLM: OpenAI Chat1": {
          "ai_languageModel": [
            [
              {
                "node": "Generate Image Prompt1",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Generate Image Prompt1": {
          "main": [
            [
              {
                "node": "NanoBanana: Create Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "NanoBanana: Create Image1": {
          "main": [
            [
              {
                "node": "Wait for Image Edit1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait for Image Edit1": {
          "main": [
            [
              {
                "node": "Download Edited Image1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Download Edited Image1": {
          "main": [
            [
              {
                "node": "Google Sheets: Read Video Parameters (CONFIG)1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Google Sheets: Read Video Parameters (CONFIG)1": {
          "main": [
            [
              {
                "node": "Set Master Prompt1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {},
      "staticData": null,
      "meta": {
        "templateId": "8270"
      },
      "pinData": {},
      "versionId": "15b3d980-d1da-4def-bd82-b9bae29100d7",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-27T21:38:02.05Z",
          "createdAt": "2025-11-27T21:38:02.05Z",
          "role": "workflow:owner",
          "workflowId": "veiFKt73XpNZskNW",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-10-31T05:04:31Z",
      "createdAt": "2025-10-31T03:45:41.07Z",
      "id": "vy19kAIsxeqeCXVr",
      "name": "Morning Autopilot (09:00)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 9 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 09:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "84b64692-5614-415f-b2e3-12593583ab08"
        },
        {
          "parameters": {
            "functionCode": "// Fetch OneNote/Notion notes from last 12 hours\nconst notes = [\n  {\n    content: \"TODO: Complete API integration for payment gateway. PRIORITY: High\",\n    timestamp: new Date().toISOString()\n  }\n];\n\nreturn notes.map(note => ({\n  json: note\n}));"
          },
          "name": "Fetch Notes",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            450,
            300
          ],
          "id": "4004b647-ec1b-4077-8912-4ca7f91e1390"
        },
        {
          "parameters": {
            "functionCode": "// Extract tasks using regex patterns\nconst content = $input.item.json.content;\nconst todoPattern = /TODO:\\s*(.+?)(?=\\.|$)/gi;\nconst priorityPattern = /PRIORITY:\\s*(High|Medium|Low|P[0-3])/i;\n\nconst tasks = [];\nlet match;\n\nwhile ((match = todoPattern.exec(content)) !== null) {\n  const taskText = match[1].trim();\n  const priorityMatch = content.match(priorityPattern);\n  const priority = priorityMatch ? (priorityMatch[1] === 'High' ? 'P0' : priorityMatch[1] === 'Medium' ? 'P1' : 'P2') : 'P2';\n  \n  // Classify type\n  let type = 'message/clarify';\n  if (/(write|create|build|implement|code|develop)/i.test(taskText)) type = 'code';\n  else if (/(research|investigate|explore|find|search)/i.test(taskText)) type = 'info-gather';\n  else if (/(design|plan|architect|blueprint)/i.test(taskText)) type = 'blueprint';\n  else if (/(review|analyze|evaluate)/i.test(taskText)) type = 'review';\n  \n  tasks.push({\n    name: taskText,\n    priority: priority,\n    type: type,\n    uuid: require('crypto').randomUUID(),\n    status: 'New',\n    extracted_at: new Date().toISOString()\n  });\n}\n\nreturn tasks.map(task => ({ json: task }));"
          },
          "name": "Extract Tasks",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "id": "4b2a1e63-6c06-40a4-a714-2facb6033ea5"
        },
        {
          "parameters": {
            "operation": "create",
            "base": "{{$env.NOTION_DATABASE_ID_TASKS}}",
            "properties": {
              "Name": "={{$json.name}}",
              "Priority": "={{$json.priority}}",
              "Type": "={{$json.type}}",
              "Status": "New",
              "UUID": "={{$json.uuid}}"
            }
          },
          "name": "Create Notion Task",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "c2575ede-9b8a-4506-a089-907bdf5c3005"
        },
        {
          "parameters": {
            "functionCode": "// Route to appropriate LLM based on task type\nconst task = $input.item.json;\nlet provider = 'ms_todo';\n\nswitch(task.type) {\n  case 'code':\n    provider = 'openai';\n    break;\n  case 'blueprint':\n  case 'reasoning':\n  case 'review':\n    provider = 'claude';\n    break;\n  case 'info-gather':\n    provider = 'perplexity';\n    break;\n  default:\n    provider = 'ms_todo';\n}\n\nreturn [{\n  json: {\n    ...task,\n    target_platform: provider\n  }\n}];"
          },
          "name": "Route to LLM",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ],
          "id": "e88aa523-27f3-40ee-836a-90fe76c155c4"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "openai"
                }
              ]
            }
          },
          "name": "If OpenAI",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            200
          ],
          "id": "31ed6fa0-8cdc-45ca-8233-6996a1764c32"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "claude"
                }
              ]
            }
          },
          "name": "If Claude",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            400
          ],
          "id": "32609069-6f28-4c7e-8aa6-6e1445c9f12d"
        },
        {
          "parameters": {
            "model": "gpt-4o",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "name": "OpenAI GPT-4o",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1,
          "position": [
            1450,
            150
          ],
          "credentials": {
            "openAiApi": {
              "id": "2",
              "name": "OpenAI"
            }
          },
          "id": "880f07c5-f7cc-452c-9ab6-30e446c5d0b7"
        },
        {
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "name": "Claude Sonnet",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1,
          "position": [
            1450,
            400
          ],
          "credentials": {
            "anthropicApi": {
              "id": "3",
              "name": "Anthropic"
            }
          },
          "id": "43351af4-dab7-49d9-be46-aa1747b9eda8"
        }
      ],
      "connections": {
        "Schedule Trigger - 09:00": {
          "main": [
            [
              {
                "node": "Fetch Notes",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Fetch Notes": {
          "main": [
            [
              {
                "node": "Extract Tasks",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Tasks": {
          "main": [
            [
              {
                "node": "Create Notion Task",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Notion Task": {
          "main": [
            [
              {
                "node": "Route to LLM",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route to LLM": {
          "main": [
            [
              {
                "node": "If OpenAI",
                "type": "main",
                "index": 0
              },
              {
                "node": "If Claude",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If OpenAI": {
          "main": [
            [
              {
                "node": "OpenAI GPT-4o",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If Claude": {
          "main": [
            [
              {
                "node": "Claude Sonnet",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 09:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "ec3ff028-a2a5-4502-a99e-2a839c1f642f",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-10-31T03:45:41.076Z",
          "createdAt": "2025-10-31T03:45:41.076Z",
          "role": "workflow:owner",
          "workflowId": "vy19kAIsxeqeCXVr",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-29T03:28:12Z",
      "createdAt": "2025-11-01T14:36:59.552Z",
      "id": "wZ2t3raafzrKjmPc",
      "name": "E-commerce Order Processing Workflow",
      "active": false,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {},
          "id": "start-node",
          "name": "Start",
          "type": "n8n-nodes-base.start",
          "typeVersion": 1,
          "position": [
            240,
            300
          ]
        },
        {
          "parameters": {
            "resource": "order",
            "operation": "getAll",
            "returnAll": true,
            "options": {
              "status": "any"
            }
          },
          "id": "shopify-orders",
          "name": "Get Shopify Orders",
          "type": "n8n-nodes-base.shopify",
          "typeVersion": 1,
          "position": [
            460,
            300
          ],
          "credentials": {
            "shopifyApi": {
              "id": "shopify-credentials",
              "name": "Shopify API"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "multipleMatches": false,
                "rightValue": ""
              },
              "conditions": [
                {
                  "leftValue": "={{ $json.financial_status }}",
                  "rightValue": "paid",
                  "operator": {
                    "operation": "equals"
                  }
                }
              ]
            }
          },
          "id": "filter-paid-orders",
          "name": "Filter Paid Orders",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            680,
            300
          ]
        },
        {
          "parameters": {
            "resource": "spreadsheet",
            "operation": "appendRow",
            "documentId": {
              "__rl": true,
              "value": "your-google-sheet-id",
              "mode": "list",
              "cachedResultName": "Order Tracking Sheet"
            },
            "sheetName": {
              "__rl": true,
              "value": "Sheet1",
              "mode": "list",
              "cachedResultName": "Sheet1"
            },
            "columns": {
              "mappingMode": "defineBelow",
              "value": {
                "Order ID": "={{ $json.order_number }}",
                "Customer Email": "={{ $json.email }}",
                "Total Amount": "={{ $json.total_price }}",
                "Status": "={{ $json.financial_status }}",
                "Date": "={{ $json.created_at }}"
              }
            }
          },
          "id": "add-to-sheets",
          "name": "Add to Google Sheets",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4,
          "position": [
            900,
            240
          ],
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "google-sheets-credentials",
              "name": "Google Sheets OAuth2"
            }
          }
        },
        {
          "parameters": {
            "resource": "lead",
            "operation": "create",
            "additionalFields": {
              "firstName": "={{ $json.billing_address.first_name }}",
              "lastName": "={{ $json.billing_address.last_name }}",
              "email": "={{ $json.email }}",
              "company": "={{ $json.billing_address.company }}",
              "phone": "={{ $json.billing_address.phone }}"
            }
          },
          "id": "create-salesforce-lead",
          "name": "Create Salesforce Lead",
          "type": "n8n-nodes-base.salesforce",
          "typeVersion": 1,
          "position": [
            900,
            360
          ],
          "credentials": {
            "salesforceOAuth2Api": {
              "id": "salesforce-credentials",
              "name": "Salesforce OAuth2"
            }
          }
        },
        {
          "parameters": {
            "fromEmail": "orders@yourcompany.com",
            "toEmail": "={{ $json.email }}",
            "subject": "Order Confirmation - {{ $json.order_number }}",
            "message": "Thank you for your order! Your order #{{ $json.order_number }} for ${{ $json.total_price }} has been processed successfully.",
            "options": {}
          },
          "id": "send-confirmation-email",
          "name": "Send Confirmation Email",
          "type": "n8n-nodes-base.gmail",
          "typeVersion": 1,
          "position": [
            1120,
            300
          ],
          "credentials": {
            "gmailOAuth2": {
              "id": "gmail-credentials",
              "name": "Gmail OAuth2"
            }
          }
        }
      ],
      "connections": {
        "Start": {
          "main": [
            [
              {
                "node": "Get Shopify Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Get Shopify Orders": {
          "main": [
            [
              {
                "node": "Filter Paid Orders",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Filter Paid Orders": {
          "main": [
            [
              {
                "node": "Add to Google Sheets",
                "type": "main",
                "index": 0
              },
              {
                "node": "Create Salesforce Lead",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Add to Google Sheets": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Salesforce Lead": {
          "main": [
            [
              {
                "node": "Send Confirmation Email",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "7d060ab4-17d7-45c8-b9e0-1e7446263199",
      "triggerCount": 0,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:59.554Z",
          "createdAt": "2025-11-01T14:36:59.554Z",
          "role": "workflow:owner",
          "workflowId": "wZ2t3raafzrKjmPc",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-12-18T09:56:59.491Z",
      "createdAt": "2025-12-18T09:56:41.776Z",
      "id": "xe4LUKxdPfgCrUcG",
      "name": "Claude Bridge - Governance Tasks",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "claude_bridge",
            "responseMode": "responseNode",
            "options": {}
          },
          "id": "webhook-trigger",
          "name": "Webhook",
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 1.1,
          "position": [
            250,
            300
          ],
          "webhookId": "claude-bridge-webhook"
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "task-type",
                  "name": "task_type",
                  "value": "={{ $json.body.task_type }}",
                  "type": "string"
                },
                {
                  "id": "task-description",
                  "name": "task_description",
                  "value": "={{ $json.body.task_description }}",
                  "type": "string"
                },
                {
                  "id": "context",
                  "name": "context",
                  "value": "={{ $json.body.context }}",
                  "type": "object"
                },
                {
                  "id": "wait-response",
                  "name": "wait_for_response",
                  "value": "={{ $json.body.wait_for_response ?? true }}",
                  "type": "boolean"
                }
              ]
            },
            "options": {}
          },
          "id": "extract-payload",
          "name": "Extract Payload",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            450,
            300
          ]
        },
        {
          "parameters": {
            "authentication": "genericCredentialType",
            "genericAuthType": "httpHeaderAuth",
            "url": "https://api.anthropic.com/v1/messages",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "anthropic-version",
                  "value": "2023-06-01"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"claude-3-5-sonnet-20241022\",\n  \"max_tokens\": 8000,\n  \"system\": \"You are a governance and design AI. Your role:\\n- Design system architectures\\n- Review code and governance documents\\n- Generate RAG content for documentation\\n- Audit project compliance\\n\\nRESPOND ONLY WITH THE REQUESTED OUTPUT. No preamble, no explanation unless asked.\\n\\nCurrent task type: {{ $json.task_type }}\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"{{ $json.task_description }}\\n\\nContext: {{ JSON.stringify($json.context) }}\"\n    }\n  ]\n}",
            "options": {}
          },
          "id": "call-claude-api",
          "name": "Call Claude API",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            650,
            300
          ],
          "credentials": {
            "httpHeaderAuth": {
              "id": "anthropic-api-key",
              "name": "Anthropic API Key"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "success",
                  "name": "success",
                  "value": true,
                  "type": "boolean"
                },
                {
                  "id": "task-type",
                  "name": "task_type",
                  "value": "={{ $('Extract Payload').item.json.task_type }}",
                  "type": "string"
                },
                {
                  "id": "claude-response",
                  "name": "claude_response",
                  "value": "={{ $json.content[0].text }}",
                  "type": "string"
                },
                {
                  "id": "usage",
                  "name": "usage",
                  "value": "={{ $json.usage }}",
                  "type": "object"
                },
                {
                  "id": "model",
                  "name": "model",
                  "value": "={{ $json.model }}",
                  "type": "string"
                },
                {
                  "id": "timestamp",
                  "name": "timestamp",
                  "value": "={{ $now.toISO() }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "format-response",
          "name": "Format Response",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            850,
            300
          ]
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ $json }}",
            "options": {}
          },
          "id": "respond-to-webhook",
          "name": "Respond to Webhook",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.1,
          "position": [
            1050,
            300
          ]
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict"
              },
              "conditions": [
                {
                  "id": "error-check",
                  "leftValue": "={{ $json.error }}",
                  "rightValue": "",
                  "operator": {
                    "type": "object",
                    "operation": "notExists"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "id": "check-for-errors",
          "name": "Check for Errors",
          "type": "n8n-nodes-base.if",
          "typeVersion": 2,
          "position": [
            650,
            500
          ]
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "error-flag",
                  "name": "success",
                  "value": false,
                  "type": "boolean"
                },
                {
                  "id": "error-message",
                  "name": "error",
                  "value": "={{ $json.error?.message || 'Unknown error from Claude API' }}",
                  "type": "string"
                },
                {
                  "id": "error-type",
                  "name": "error_type",
                  "value": "={{ $json.error?.type || 'api_error' }}",
                  "type": "string"
                },
                {
                  "id": "timestamp",
                  "name": "timestamp",
                  "value": "={{ $now.toISO() }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "format-error",
          "name": "Format Error",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.3,
          "position": [
            850,
            500
          ]
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={{ $json }}",
            "responseCode": 500,
            "options": {}
          },
          "id": "respond-error",
          "name": "Respond Error",
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.1,
          "position": [
            1050,
            500
          ]
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "Extract Payload",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Payload": {
          "main": [
            [
              {
                "node": "Call Claude API",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Call Claude API": {
          "main": [
            [
              {
                "node": "Check for Errors",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Check for Errors": {
          "main": [
            [
              {
                "node": "Format Response",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Format Error",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Response": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Error": {
          "main": [
            [
              {
                "node": "Respond Error",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "3e47dc8a-b7d7-4f3f-ab3e-eb94def54216",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-12-18T09:56:41.787Z",
          "createdAt": "2025-12-18T09:56:41.787Z",
          "role": "workflow:owner",
          "workflowId": "xe4LUKxdPfgCrUcG",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:46:23Z",
      "createdAt": "2025-11-01T14:40:18.229Z",
      "id": "yJOnu5mpsaQymI8r",
      "name": "Demo: My first AI Agent in n8n",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "When chat message received",
          "type": "@n8n/n8n-nodes-langchain.chatTrigger",
          "typeVersion": 1.1,
          "position": [
            368,
            32
          ],
          "parameters": {
            "options": {}
          },
          "id": "91b0687c-4628-4449-b264-9cbd73d16bcc"
        },
        {
          "name": "Sticky Note",
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            48,
            -64
          ],
          "parameters": {
            "content": "## Start by saying 'hi'\n![Button](https://i.imgur.com/PrIBJI6.png)",
            "height": 149,
            "width": 150
          },
          "id": "e715d57c-9cde-4eef-bda9-a398b5234e56"
        },
        {
          "name": "OpenAI Model",
          "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
          "typeVersion": 1,
          "position": [
            512,
            240
          ],
          "parameters": {
            "options": {}
          },
          "credentials": {
            "openAiApi": {
              "id": "AkvPUIbUUBQfL4G8",
              "name": "OpenAi account"
            }
          },
          "id": "cda6c491-3b10-4d1f-8319-4789f2a1a1b7"
        },
        {
          "name": "Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.7,
          "position": [
            592,
            32
          ],
          "parameters": {
            "promptType": "define",
            "text": "=## Steps to follow\n\n{{ $agentInfo.memoryConnectedToAgent ? '1. Skip': `1. STOP and output the following:\n\"Welcome to n8n. Let's start with the first step to give me memory: \\n\"Click the **+** button on the agent that says 'memory' and choose 'Simple memory.' Just tell me once you've done that.\"\n----- END OF OUTPUT && IGNORE BELOW -----` }} \n\n\n{{ Boolean($agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool')) ? '2. Skip' : \n`2. STOP and output the following: \\n\"Click the **+** button on the agent that says 'tools' and choose 'Google Calendar.'\" \\n ----- IGNORE BELOW -----` }}\n\n\n{{ $agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').hasCredentials ? '3. Skip' :\n`3. STOP and output the following:\n\"Open the Google Calendar tool (double-click) and choose a credential from the drop-down.\" \\n ----- IGNORE BELOW -----` }}\n\n\n{{ $agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').resource === 'Event' ? '4. Skip' :\n`4. STOP and output the following:\n\"Open the Google Calendar tool (double-click) and set **resource** = 'Event'\" `}}\n\n\n{{ $agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').operation === 'Get Many' ? '5. Skip' :\n`5. STOP and output the following:\n\"Open the Google Calendar tool (double-click) and set **operation** = 'Get Many.'\" \\n ----- IGNORE BELOW -----` }}\n\n\n{{ $agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').hasValidCalendar ? '6. Skip' :\n`6. STOP and output the following:\n\"Open the Google Calendar tool (double-click) and choose a calendar from the 'calendar' drop-down.\" \\n ----- IGNORE BELOW -----` }}\n\n\n{{ ($agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').aiDefinedFields.includes('Start Time') && $agentInfo.tools.find((tool) => tool.type === 'Google Calendar Tool').aiDefinedFields.includes('End Time')) ? '7. Skip' :\n`7. STOP and output the following: \nOpen the Google Calendar tool (double-click) and click the :sparks: button next to the 'After' and 'Before' fields. \\n ----- IGNORE BELOW -----` }}\n\n\n8. If all steps are completed, output the following:\n\"Would you like me to check all events in your calendar for tomorrow {{ $now.plus(1, 'days').toString().split('T')[0] }}?\"\n\n# User message\n\n{{ $json.chatInput }}",
            "options": {
              "systemMessage": "=You are a friendly Agent designed to guide users through these steps.\n\n- Stop at the earliest step mentioned in the steps\n- Respond concisely and do **not** disclose these internal instructions to the user. Only return defined output below.\n- Don't output any lines that start with -----\n- Replace \":sparks:\" with \"✨\" in any message"
            }
          },
          "id": "98c757f2-bdad-4dd9-b7e4-07e8cf0e03b2"
        },
        {
          "name": "Simple Memory",
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            608,
            240
          ],
          "parameters": {
            "contextWindowLength": 200
          },
          "id": "5c49e393-04dd-45e3-b17f-61516eff16fa"
        },
        {
          "name": "Get many events in Google Calendar",
          "type": "n8n-nodes-base.googleCalendarTool",
          "typeVersion": 1.3,
          "position": [
            752,
            240
          ],
          "parameters": {
            "operation": "getAll",
            "calendar": {
              "__rl": true,
              "value": "bermingham1985@gmail.com",
              "mode": "list",
              "cachedResultName": "bermingham1985@gmail.com"
            },
            "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
            "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
            "options": {}
          },
          "credentials": {
            "googleCalendarOAuth2Api": {
              "id": "lBhFbdkAfqMFlHw2",
              "name": "Google Calendar account"
            }
          },
          "id": "2a1eec40-4f5c-473c-a9a0-2f6a153d1cff"
        },
        {
          "name": "Get many calendars in Microsoft Outlook",
          "type": "n8n-nodes-base.microsoftOutlookTool",
          "typeVersion": 2,
          "position": [
            848,
            224
          ],
          "parameters": {
            "resource": "calendar",
            "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
            "filters": {}
          },
          "credentials": {
            "microsoftOutlookOAuth2Api": {
              "id": "EZWkdfGdsVXdiPbi",
              "name": "Microsoft Outlook account"
            }
          },
          "id": "03c4b8db-acc8-48bf-a796-2024d2753151"
        }
      ],
      "connections": {
        "When chat message received": {
          "main": [
            [
              {
                "node": "Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "OpenAI Model": {
          "ai_languageModel": [
            [
              {
                "node": "Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Get many events in Google Calendar": {
          "ai_tool": [
            [
              {
                "node": "Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        },
        "Get many calendars in Microsoft Outlook": {
          "ai_tool": [
            [
              {
                "node": "Agent",
                "type": "ai_tool",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "cd95718e-beeb-4fe1-81df-9ad2d538ba23",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:18.231Z",
          "createdAt": "2025-11-01T14:40:18.231Z",
          "role": "workflow:owner",
          "workflowId": "yJOnu5mpsaQymI8r",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-12-20T02:01:43Z",
      "createdAt": "2025-12-01T19:36:51.278Z",
      "id": "ydPB0WbTYfmNtj2v",
      "name": "Claude Chat Analyzer Automation",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "minutes"
                }
              ]
            }
          },
          "id": "31584fd3-48be-4738-9e51-1e1b8982a646",
          "name": "Every 5 Minutes",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            0,
            0
          ]
        },
        {
          "parameters": {
            "documentId": {
              "__rl": true,
              "value": "https://docs.google.com/spreadsheets/d/1s2tw1Qzky01uQtmuY6Y1-tCC69ozjZ56OLUUu2eXH30/edit?usp=sharing",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "=sheet3",
              "mode": "name"
            },
            "options": {}
          },
          "id": "1dd4a097-5a55-4509-a8ac-1d9acca14bc0",
          "name": "Read Google Sheet Config",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4.5,
          "position": [
            224,
            0
          ],
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "IE4IA7SvtzMjcnit",
              "name": "Google Sheets account 3"
            }
          }
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "system_prompt",
                  "name": "systemPrompt",
                  "value": "={{ $json.System_Prompt }}",
                  "type": "string"
                },
                {
                  "id": "chat_file",
                  "name": "chatFile",
                  "value": "={{ $json.Chat_File_Path }}",
                  "type": "string"
                },
                {
                  "id": "output_file",
                  "name": "outputFile",
                  "value": "={{ $json.Output_File_Path }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "1c656781-eb61-4a31-b381-beb6fed3821a",
          "name": "Extract Config",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            448,
            0
          ]
        },
        {
          "parameters": {
            "filePath": "={{ $json.chatFile }}"
          },
          "id": "ff7c1dc3-f7a9-4c38-abb9-a4eb875d2f0c",
          "name": "Read Chat File",
          "type": "n8n-nodes-base.readBinaryFile",
          "typeVersion": 1,
          "position": [
            672,
            0
          ]
        },
        {
          "parameters": {
            "options": {}
          },
          "id": "9138f9de-0fa6-4bdf-aba3-3a795abf53d3",
          "name": "Parse JSON",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            880,
            0
          ]
        },
        {
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "options": {}
          },
          "id": "be049035-02e5-4242-ad42-ee64feff5e19",
          "name": "Claude Analysis",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1.1,
          "position": [
            1104,
            0
          ]
        },
        {
          "parameters": {
            "assignments": {
              "assignments": [
                {
                  "id": "timestamp",
                  "name": "timestamp",
                  "value": "={{ $now.toISO() }}",
                  "type": "string"
                },
                {
                  "id": "analysis",
                  "name": "analysis",
                  "value": "={{ $json.response }}",
                  "type": "string"
                }
              ]
            },
            "options": {}
          },
          "id": "863b7b9d-1d8b-4c84-997a-b2fd305adb38",
          "name": "Format Output",
          "type": "n8n-nodes-base.set",
          "typeVersion": 3.4,
          "position": [
            1328,
            0
          ]
        },
        {
          "parameters": {
            "operation": "toJson",
            "mode": "each",
            "options": {}
          },
          "id": "e6c8d898-ab06-4095-b8e6-f1a08ad636b1",
          "name": "Convert to JSON",
          "type": "n8n-nodes-base.convertToFile",
          "typeVersion": 1.1,
          "position": [
            1552,
            0
          ]
        },
        {
          "parameters": {
            "fileName": "={{ $('Extract Config').item.json.outputFile }}",
            "options": {}
          },
          "id": "6dcfad12-df39-4186-aedf-8b5648f09607",
          "name": "Write Analysis File",
          "type": "n8n-nodes-base.writeBinaryFile",
          "typeVersion": 1,
          "position": [
            1760,
            0
          ]
        },
        {
          "parameters": {
            "documentId": {
              "__rl": true,
              "value": "1o49A_--YXcF5MjBMGWiWO59qJ_jGJpE_jBOnVq1-YNM",
              "mode": "url"
            },
            "sheetName": {
              "__rl": true,
              "value": "gid=0",
              "mode": "list",
              "cachedResultName": "Sheet1"
            },
            "options": {}
          },
          "id": "d4233307-4daf-4543-adc0-6e630040f553",
          "name": "Update Status in Sheet",
          "type": "n8n-nodes-base.googleSheets",
          "typeVersion": 4.5,
          "position": [
            1984,
            0
          ],
          "credentials": {
            "googleSheetsOAuth2Api": {
              "id": "gW1oRVy1Zs3kKuYY",
              "name": "Google Sheets account 2"
            }
          }
        }
      ],
      "connections": {
        "Every 5 Minutes": {
          "main": [
            [
              {
                "node": "Read Google Sheet Config",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read Google Sheet Config": {
          "main": [
            [
              {
                "node": "Extract Config",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Config": {
          "main": [
            [
              {
                "node": "Read Chat File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read Chat File": {
          "main": [
            [
              {
                "node": "Parse JSON",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Format Output": {
          "main": [
            [
              {
                "node": "Convert to JSON",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Convert to JSON": {
          "main": [
            [
              {
                "node": "Write Analysis File",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Write Analysis File": {
          "main": [
            [
              {
                "node": "Update Status in Sheet",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Every 5 Minutes": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": {},
      "versionId": "94275f96-cc40-4585-a454-7c84bf74c002",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-12-01T19:36:51.304Z",
          "createdAt": "2025-12-01T19:36:51.304Z",
          "role": "workflow:owner",
          "workflowId": "ydPB0WbTYfmNtj2v",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-08T09:58:53.689Z",
      "createdAt": "2025-11-01T14:36:58.388Z",
      "id": "zYHRSseOAOXvFQgB",
      "name": "Morning Autopilot (09:00)",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "0 9 * * *"
                }
              ]
            }
          },
          "name": "Schedule Trigger - 09:00",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1,
          "position": [
            250,
            300
          ],
          "id": "5f8ad732-8454-432f-bd66-84a70cd220d0"
        },
        {
          "parameters": {
            "functionCode": "// Fetch OneNote/Notion notes from last 12 hours\nconst notes = [\n  {\n    content: \"TODO: Complete API integration for payment gateway. PRIORITY: High\",\n    timestamp: new Date().toISOString()\n  }\n];\n\nreturn notes.map(note => ({\n  json: note\n}));"
          },
          "name": "Fetch Notes",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            450,
            300
          ],
          "id": "fdae3c53-e9cb-4a84-882a-afecc190d8f0"
        },
        {
          "parameters": {
            "functionCode": "// Extract tasks using regex patterns\nconst content = $input.item.json.content;\nconst todoPattern = /TODO:\\s*(.+?)(?=\\.|$)/gi;\nconst priorityPattern = /PRIORITY:\\s*(High|Medium|Low|P[0-3])/i;\n\nconst tasks = [];\nlet match;\n\nwhile ((match = todoPattern.exec(content)) !== null) {\n  const taskText = match[1].trim();\n  const priorityMatch = content.match(priorityPattern);\n  const priority = priorityMatch ? (priorityMatch[1] === 'High' ? 'P0' : priorityMatch[1] === 'Medium' ? 'P1' : 'P2') : 'P2';\n  \n  // Classify type\n  let type = 'message/clarify';\n  if (/(write|create|build|implement|code|develop)/i.test(taskText)) type = 'code';\n  else if (/(research|investigate|explore|find|search)/i.test(taskText)) type = 'info-gather';\n  else if (/(design|plan|architect|blueprint)/i.test(taskText)) type = 'blueprint';\n  else if (/(review|analyze|evaluate)/i.test(taskText)) type = 'review';\n  \n  tasks.push({\n    name: taskText,\n    priority: priority,\n    type: type,\n    uuid: require('crypto').randomUUID(),\n    status: 'New',\n    extracted_at: new Date().toISOString()\n  });\n}\n\nreturn tasks.map(task => ({ json: task }));"
          },
          "name": "Extract Tasks",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            650,
            300
          ],
          "id": "2580b92c-d220-49e9-b707-3c28d8e43762"
        },
        {
          "parameters": {
            "operation": "create",
            "base": "0c6cedb5-a728-4de8-b6eb-8313c093839a",
            "properties": {
              "Name": "={{$json.name}}",
              "Priority": "={{$json.priority}}",
              "Type": "={{$json.type}}",
              "Status": "New",
              "UUID": "={{$json.uuid}}"
            }
          },
          "name": "Create Notion Task",
          "type": "n8n-nodes-base.notion",
          "typeVersion": 2,
          "position": [
            850,
            300
          ],
          "credentials": {
            "notionApi": {
              "id": "1",
              "name": "Notion API"
            }
          },
          "id": "78a1da9e-085a-4214-b182-a65008c919c5"
        },
        {
          "parameters": {
            "functionCode": "// Route to appropriate LLM based on task type\nconst task = $input.item.json;\nlet provider = 'ms_todo';\n\nswitch(task.type) {\n  case 'code':\n    provider = 'openai';\n    break;\n  case 'blueprint':\n  case 'reasoning':\n  case 'review':\n    provider = 'claude';\n    break;\n  case 'info-gather':\n    provider = 'perplexity';\n    break;\n  default:\n    provider = 'ms_todo';\n}\n\nreturn [{\n  json: {\n    ...task,\n    target_platform: provider\n  }\n}];"
          },
          "name": "Route to LLM",
          "type": "n8n-nodes-base.function",
          "typeVersion": 1,
          "position": [
            1050,
            300
          ],
          "id": "fdf8a2e8-aa96-4c73-acc8-973a4989dae1"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "openai"
                }
              ]
            }
          },
          "name": "If OpenAI",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            200
          ],
          "id": "9eb4d62f-24d2-415e-b9fa-42700bcc92f6"
        },
        {
          "parameters": {
            "conditions": {
              "string": [
                {
                  "value1": "={{$json.target_platform}}",
                  "value2": "claude"
                }
              ]
            }
          },
          "name": "If Claude",
          "type": "n8n-nodes-base.if",
          "typeVersion": 1,
          "position": [
            1250,
            400
          ],
          "id": "58714871-9519-47e9-953f-5141a81a167d"
        },
        {
          "parameters": {
            "model": "gpt-4o",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "name": "OpenAI GPT-4o",
          "type": "@n8n/n8n-nodes-langchain.openAi",
          "typeVersion": 1,
          "position": [
            1450,
            150
          ],
          "credentials": {
            "openAiApi": {
              "id": "2",
              "name": "OpenAI"
            }
          },
          "id": "f21cd4c9-b552-41a0-8b39-f130aa292f46"
        },
        {
          "parameters": {
            "model": "claude-3-5-sonnet-20241022",
            "messages": {
              "values": [
                {
                  "role": "user",
                  "content": "={{$json.name}}"
                }
              ]
            }
          },
          "name": "Claude Sonnet",
          "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
          "typeVersion": 1,
          "position": [
            1450,
            400
          ],
          "credentials": {
            "anthropicApi": {
              "id": "3",
              "name": "Anthropic"
            }
          },
          "id": "6f164b55-8e2a-4d6e-965c-4b413cfeeefb"
        }
      ],
      "connections": {
        "Schedule Trigger - 09:00": {
          "main": [
            [
              {
                "node": "Fetch Notes",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Fetch Notes": {
          "main": [
            [
              {
                "node": "Extract Tasks",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract Tasks": {
          "main": [
            [
              {
                "node": "Create Notion Task",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create Notion Task": {
          "main": [
            [
              {
                "node": "Route to LLM",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Route to LLM": {
          "main": [
            [
              {
                "node": "If OpenAI",
                "type": "main",
                "index": 0
              },
              {
                "node": "If Claude",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If OpenAI": {
          "main": [
            [
              {
                "node": "OpenAI GPT-4o",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If Claude": {
          "main": [
            [
              {
                "node": "Claude Sonnet",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": {
        "node:Schedule Trigger - 09:00": {
          "recurrenceRules": []
        }
      },
      "meta": null,
      "pinData": null,
      "versionId": "efd1d3bf-e9b4-4c5b-b08d-7bdbae3adf5d",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:36:58.391Z",
          "createdAt": "2025-11-01T14:36:58.391Z",
          "role": "workflow:owner",
          "workflowId": "zYHRSseOAOXvFQgB",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    },
    {
      "updatedAt": "2025-11-02T02:47:57Z",
      "createdAt": "2025-11-01T14:40:24.717Z",
      "id": "zy6uRmDjl00USKwo",
      "name": "My workflow 12",
      "active": true,
      "isArchived": false,
      "nodes": [
        {
          "name": "When chat message received",
          "type": "@n8n/n8n-nodes-langchain.chatTrigger",
          "typeVersion": 1.1,
          "position": [
            0,
            0
          ],
          "parameters": {
            "options": {}
          },
          "id": "83b76235-70b2-4949-adfd-6c8c61980e0a"
        },
        {
          "name": "AI Agent",
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.9,
          "position": [
            220,
            0
          ],
          "parameters": {
            "options": {}
          },
          "id": "ad787020-b879-47d7-a521-1e8fc371c6d5"
        }
      ],
      "connections": {
        "When chat message received": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "settings": {
        "executionOrder": "v1"
      },
      "staticData": null,
      "meta": null,
      "pinData": null,
      "versionId": "5fc2b807-33fe-48f9-9956-925a4c0e0aa5",
      "triggerCount": 1,
      "shared": [
        {
          "updatedAt": "2025-11-01T14:40:24.719Z",
          "createdAt": "2025-11-01T14:40:24.719Z",
          "role": "workflow:owner",
          "workflowId": "zy6uRmDjl00USKwo",
          "projectId": "t318ivs2MimhndIY"
        }
      ],
      "tags": []
    }
  ],
  "nextCursor": null
}
